"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1217],{22605:(e,s,t)=>{t.d(s,{A:()=>A});var i=t(16927),n=t(4902),r=t(37876),a=t(14232),l=t(8047),d=t(1081),c=t(97685),o=t(6960),x=t(48230),m=t.n(x),h=t(89099),u=t(17660),v=t(44769),j=t(64115),f=t(4113),b=t(42038),N=t(83416),y=t(20442),g=t(12293),p=t(99574),w=t(43885);let A=e=>{var s=e.actionId,t=e.onRoundChange,x=e.actionInfo,A=e.onStakedAmountChange,C=e.showJoinButton,k=(0,l.F)().address,E=(0,d.i)(),I=((0,a.useContext)(N.N)||{}).token,R=(0,h.useRouter)(),B=(0,u.vC)(),F=B.currentRound,P=B.error;(0,a.useEffect)(()=>{t&&"function"==typeof t&&t(F)},[F,t]);var S=(0,j.F6)((null==I?void 0:I.address)||"",F,s),_=S.isSubmitted,H=S.error,L=S.isPending,$=(0,u.vx)((null==I?void 0:I.address)||"",s,k||""),J=$.joinedAmountByActionIdByAccount,K=$.isPending,Y=$.error,z=(0,u.p9)((null==I?void 0:I.address)||"",s),D=z.joinedAmountByActionId,G=z.isPending,M=z.error,V=J&&J>0&&D&&D>0,W=V?Number(J)/Number(D)*100:0,q=(0,y.Ee)(W),O=V?(0,y.Ee)(Math.min(W*Number(null==x?void 0:x.body.maxRandomAccounts),100)):"0%",Q=(0,v.IJ)((null==I?void 0:I.address)||"",s,k||""),T=Q.verificationKeys,U=Q.verificationInfos,X=Q.isPending,Z=Q.error,ee=(0,u.S1)(),es=ee.withdraw,et=ee.isPending,ei=ee.isConfirming,en=ee.isConfirmed,er=ee.writeError;(0,a.useEffect)(()=>{en&&(c.oR.success("取回成功"),R.push("/my"))},[en,R]),(0,a.useEffect)(()=>{K||null==A||A(J||BigInt(0))},[J,K]);var ea=(0,f.g)().handleContractError;return((0,a.useEffect)(()=>{Y&&ea(Y,"join"),M&&ea(M,"join"),Z&&ea(Z,"join"),P&&ea(P,"join"),er&&ea(er,"join"),H&&ea(H,"submit")},[Y,M,Z,P,er,H]),K||G||L)?"":(0,r.jsxs)("div",{className:"flex flex-col items-center px-4 pt-1",children:[V&&(0,r.jsxs)("div",{className:"stats w-full grid grid-cols-2 divide-x-0",children:[(0,r.jsxs)("div",{className:"stat place-items-center",children:[(0,r.jsx)("div",{className:"stat-title",children:"我的参与"}),(0,r.jsx)("div",{className:"stat-value text-2xl text-secondary",children:G?(0,r.jsx)(g.A,{}):(0,y.NJ)(J||BigInt(0),0)}),(0,r.jsx)("div",{className:"stat-desc text-sm mt-2",children:"参与本行动的代币"})]}),(0,r.jsxs)("div",{className:"stat place-items-center",children:[(0,r.jsx)("div",{className:"stat-title",children:"我的占比"}),(0,r.jsx)("div",{className:"stat-value text-2xl text-secondary",children:q}),(0,r.jsxs)("div",{className:"stat-desc text-sm mt-2",children:["被抽中验证概率 ",O]})]})]}),(void 0===C||C)&&(0,r.jsx)(r.Fragment,{children:V?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"flex justify-center space-x-4 mt-2 w-full",children:[void 0!=J&&J<=2n?(0,r.jsx)(o.$,{variant:"outline",className:"w-1/3 text-secondary border-secondary",disabled:!0,children:"取回"}):(0,r.jsx)(o.$,{variant:"outline",className:"w-1/3 text-secondary border-secondary",onClick:()=>(0,i._)(function(){return(0,n.YH)(this,function(e){switch(e.label){case 0:if(!(0,b.z)(E))return[2];if(void 0!=J&&J<=2n)return c.oR.error("你还没有参与，无需取回"),[2];return[4,es((null==I?void 0:I.address)||"",s)];case 1:return e.sent(),[2]}})})(),disabled:et||ei||en,children:et?"提交中":ei?"确认中":en?"已取回":"取回代币"}),(0,r.jsx)(o.$,{variant:"outline",className:"w-1/3 text-secondary border-secondary",asChild:!0,children:(0,r.jsx)(m(),{href:"/acting/join?id=".concat(s,"&symbol=").concat(null==I?void 0:I.symbol),children:"增加参与代币"})})]}),(0,r.jsx)("div",{className:"flex flex-col items-center mt-2 mb-4",children:(0,r.jsxs)("div",{className:"text-sm text-greyscale-600",children:[X&&"加载中...",void 0!=J&&J>2n&&T&&T.length>0&&(0,r.jsx)("div",{children:T.map((e,s)=>(0,r.jsxs)("div",{children:[e,": ",(0,r.jsx)(w.H,{text:U[s]})]},s))})]})})]}):_&&(0,r.jsx)(o.$,{variant:"outline",className:"w-1/2 text-secondary border-secondary",asChild:!0,children:(0,r.jsx)(m(),{href:"/acting/join?id=".concat(s,"&symbol=").concat(null==I?void 0:I.symbol),children:"参与行动"})})}),(0,r.jsx)(p.A,{isLoading:et||ei,text:et?"提交交易...":"确认交易..."})]})}},43885:(e,s,t)=>{t.d(s,{H:()=>r});var i=t(37876);t(14232);var n=t(54680),r=e=>{var s=e.text;return(0,i.jsx)(i.Fragment,{children:(e=>{if(!e)return e;var s=/(https?:\/\/[^\s]+)/g;if(!s.test(e))return e;var t=e.split(s),r=e.match(s)||[];return(0,i.jsx)(i.Fragment,{children:t.map((e,s)=>{if(s%2==0)return e;var t=r[(s-1)/2];return(0,i.jsx)("a",{href:t,onClick:e=>{e.preventDefault(),n.a.handleExternalLink(t)},className:"text-blue-500 underline hover:text-blue-700",target:"_blank",children:t},s)})})})(s)})}},92101:(e,s,t)=>{t.d(s,{A:()=>j});var i=t(37876),n=t(14232),r=t(6960),a=t(48230),l=t.n(a),d=t(64115),c=t(4113),o=t(83416),x=t(20442),m=t(43885),h=t(87577),u=t(12293),v=t(1709);let j=e=>{var s=e.actionId,t=e.round,a=e.showSubmitter,j=e.showVerifyHistory,f=e.onActionInfo,b=((0,n.useContext)(o.N)||{}).token,N=(0,d.Y4)(null==b?void 0:b.address,s),y=N.actionInfo,g=N.isPending,p=N.error;(0,n.useEffect)(()=>{f&&y&&f(y)},[y]);var w=(0,d.WC)(null==b?void 0:b.address,a?t:0n,s),A=w.submitInfo,C=w.isPending,k=w.error,E=(null==A?void 0:A.submitter)||"N/A",I=(0,c.g)().handleContractError;return((0,n.useEffect)(()=>{p&&I(p,"submit"),k&&I(k,"submit")},[p,k]),g)?(0,i.jsx)(u.A,{}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"mx-auto p-4 pb-2 border-t border-greyscale-100",children:(0,i.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,i.jsx)(v.A,{title:"行动详情"}),(void 0===j||j)&&(0,i.jsx)(r.$,{variant:"link",className:"text-secondary border-secondary",asChild:!0,children:(0,i.jsx)(l(),{href:"/my/actrewards/?id=".concat(s,"&symbol=").concat(null==b?void 0:b.symbol),children:"查看铸造激励 >>"})})]})}),(0,i.jsxs)("div",{className:"mx-auto p-4 pb-2 ",children:[(0,i.jsxs)("div",{className:"flex flex-col",children:[(0,i.jsxs)("span",{className:"text-sm text-greyscale-500",children:["No.",null==y?void 0:y.head.id.toString()]}),(0,i.jsx)("span",{className:"text-xl font-bold text-black",children:null==y?void 0:y.body.title})]}),(0,i.jsxs)("div",{className:"mt-0 text-xs text-greyscale-500 flex justify-between",children:[(0,i.jsxs)("div",{className:"flex items-center",children:["创建人 ",(0,i.jsx)(h.A,{address:null==y?void 0:y.head.author})]}),a&&(0,i.jsxs)("div",{className:"flex items-center",children:["推举人"," ",C?(0,i.jsx)(u.A,{}):(0,i.jsx)(h.A,{address:E})]})]})]}),(0,i.jsx)("div",{className:"mx-auto p-4 pb-2",children:(0,i.jsxs)("div",{className:"mb-6",children:[(0,i.jsxs)("div",{className:"mb-4",children:[(0,i.jsx)("h3",{className:"text-sm font-bold",children:"最小参与代币数"}),(0,i.jsx)("p",{className:"text-greyscale-500",children:(0,x.NJ)((null==y?void 0:y.body.minStake)||BigInt(0))})]}),(0,i.jsxs)("div",{className:"mb-4",children:[(0,i.jsx)("h3",{className:"text-sm font-bold",children:"最大抽取验证地址数"}),(0,i.jsx)("p",{className:"text-greyscale-500",children:(null==y?void 0:y.body.maxRandomAccounts.toString())||"-"})]}),(0,i.jsxs)("div",{className:"mb-4",children:[(0,i.jsx)("h3",{className:"text-sm font-bold",children:"验证规则"}),(0,i.jsx)("p",{className:"text-greyscale-500 whitespace-pre-wrap",children:(0,i.jsx)(m.H,{text:null==y?void 0:y.body.verificationRule})})]}),(0,i.jsxs)("div",{className:"mb-4",children:[(0,i.jsx)("h3",{className:"text-sm font-bold",children:"报名参加行动时，行动者要提供的信息"}),(null==y?void 0:y.body.verificationKeys)&&(null==y?void 0:y.body.verificationKeys.length)>0?(0,i.jsx)("ul",{className:"list-disc pl-5",children:y.body.verificationKeys.map((e,s)=>(0,i.jsxs)("li",{className:"text-greyscale-500",children:[e," : ",y.body.verificationInfoGuides[s]]},s))}):(0,i.jsx)("span",{className:"text-greyscale-500",children:"无"})]}),(0,i.jsxs)("div",{className:"mb-4",children:[(0,i.jsx)("h3",{className:"text-sm font-bold",children:"白名单"}),(0,i.jsx)("p",{className:"text-greyscale-500 flex flex-wrap items-center",children:(null==y?void 0:y.body.whiteListAddress)&&"0x0000000000000000000000000000000000000000"!==y.body.whiteListAddress?(0,i.jsx)("span",{className:"flex items-center mr-2",children:(0,i.jsx)(h.A,{address:y.body.whiteListAddress})}):"无限制"})]})]})})]})}}}]);