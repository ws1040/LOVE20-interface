"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[154],{60154:(e,s,a)=>{a.d(s,{A:()=>Y});var r=a(40854),t=a(37876),n=a(77328),o=a.n(n),l=a(14232),d=a(89099),i=a(16927),c=a(4902),m=a(1081),u=a(8047),f=a(57238),x=a(96409),p=a(11267),h=a(12305),v=a(6960),N=a(3576),g=a(62701),j=a(65699),w=a(97154),y=a(96108),b=a(33276),_=a(11988),A=a(30684),k=w.bL,R=w.l9;w.YJ,w.ZL,w.Pb,w.z6,l.forwardRef((e,s)=>{var a=e.className,r=e.inset,n=e.children,o=(0,j._)(e,["className","inset","children"]);return(0,t.jsxs)(w.ZP,(0,g._)((0,N._)({ref:s,className:(0,A.cn)("flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",r&&"pl-8",a)},o),{children:[n,(0,t.jsx)(y.A,{className:"ml-auto"})]}))}).displayName=w.ZP.displayName,l.forwardRef((e,s)=>{var a=e.className,r=(0,j._)(e,["className"]);return(0,t.jsx)(w.G5,(0,N._)({ref:s,className:(0,A.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]",a)},r))}).displayName=w.G5.displayName;var E=l.forwardRef((e,s)=>{var a=e.className,r=e.sideOffset,n=(0,j._)(e,["className","sideOffset"]);return(0,t.jsx)(w.ZL,{children:(0,t.jsx)(w.UC,(0,N._)({ref:s,sideOffset:void 0===r?4:r,className:(0,A.cn)("z-50 max-h-[var(--radix-dropdown-menu-content-available-height)] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]",a)},n))})});E.displayName=w.UC.displayName;var C=l.forwardRef((e,s)=>{var a=e.className,r=e.inset,n=(0,j._)(e,["className","inset"]);return(0,t.jsx)(w.q7,(0,N._)({ref:s,className:(0,A.cn)("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",r&&"pl-8",a)},n))});C.displayName=w.q7.displayName,l.forwardRef((e,s)=>{var a=e.className,r=e.children,n=e.checked,o=(0,j._)(e,["className","children","checked"]);return(0,t.jsxs)(w.H_,(0,g._)((0,N._)({ref:s,className:(0,A.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),checked:n},o),{children:[(0,t.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,t.jsx)(w.VF,{children:(0,t.jsx)(b.A,{className:"h-4 w-4"})})}),r]}))}).displayName=w.H_.displayName,l.forwardRef((e,s)=>{var a=e.className,r=e.children,n=(0,j._)(e,["className","children"]);return(0,t.jsxs)(w.hN,(0,g._)((0,N._)({ref:s,className:(0,A.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a)},n),{children:[(0,t.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,t.jsx)(w.VF,{children:(0,t.jsx)(_.A,{className:"h-2 w-2 fill-current"})})}),r]}))}).displayName=w.hN.displayName,l.forwardRef((e,s)=>{var a=e.className,r=e.inset,n=(0,j._)(e,["className","inset"]);return(0,t.jsx)(w.JU,(0,N._)({ref:s,className:(0,A.cn)("px-2 py-1.5 text-sm font-semibold",r&&"pl-8",a)},n))}).displayName=w.JU.displayName,l.forwardRef((e,s)=>{var a=e.className,r=(0,j._)(e,["className"]);return(0,t.jsx)(w.wv,(0,N._)({ref:s,className:(0,A.cn)("-mx-1 my-1 h-px bg-muted",a)},r))}).displayName=w.wv.displayName;var F=a(24624),L=l.forwardRef((e,s)=>{var a=e.className,r=(0,j._)(e,["className"]);return(0,t.jsx)(F.bL,(0,N._)({ref:s,className:(0,A.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",a)},r))});L.displayName=F.bL.displayName,l.forwardRef((e,s)=>{var a=e.className,r=(0,j._)(e,["className"]);return(0,t.jsx)(F._V,(0,N._)({ref:s,className:(0,A.cn)("aspect-square h-full w-full",a)},r))}).displayName=F._V.displayName;var z=l.forwardRef((e,s)=>{var a=e.className,r=(0,j._)(e,["className"]);return(0,t.jsx)(F.H4,(0,N._)({ref:s,className:(0,A.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted",a)},r))});z.displayName=F.H4.displayName;var U=a(7446),T=a(6973),H=a(30822),I=a(70801),S=a(80395),V=a(97685),q=a(48447);function P(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).className,s=(0,m.i)(),a=(0,u.F)(),n=a.address,o=a.isConnected,d=a.isConnecting,N=a.isReconnecting,g=(0,f.A)({address:n,chainId:s}).data,j=(0,x.e)(),w=j.connect,y=j.connectors,_=j.error,F=j.isPending,P=(0,p.u)().disconnect,O=(0,r._)((0,l.useState)(!1),2),B=O[0],D=O[1],Z=y.find(e=>"injected"===e.id),$=e=>"".concat(e.slice(0,6),"...").concat(e.slice(-4));l.useEffect(()=>{_&&(_.message.includes("User rejected")?V.Ay.error("用户取消了连接请求"):_.message.includes("already pending")?V.Ay.error("已有连接请求在处理中"):V.Ay.error("连接失败: "+_.message))},[_]);var J=(0,l.useRef)(o);(0,l.useEffect)(()=>{!J.current&&o&&n&&V.Ay.success("已连接: ".concat($(n))),J.current=o},[o,n]),(0,l.useEffect)(()=>{var e=setTimeout(()=>{window.ethereum||console.warn("未检测到注入式钱包")},1e3);return()=>clearTimeout(e)},[]);var M=d||N||F;return o?(0,t.jsxs)(k,{children:[(0,t.jsx)(R,{asChild:!0,children:(0,t.jsx)(v.$,{variant:"outline",className:(0,A.cn)("h-auto px-3 py-1.5 rounded-xl border hover:border-blue-300 transition-all duration-200 bg-white/50 backdrop-blur-sm",e),children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)(L,{className:"w-8 h-8",children:(0,t.jsx)(z,{className:"bg-gradient-to-br from-blue-500 to-purple-600 text-white text-xs font-bold",children:n?n.slice(2,4).toUpperCase():"W"})}),(0,t.jsxs)("div",{className:"flex flex-col items-start min-w-0",children:[(0,t.jsx)("div",{className:"flex items-center gap-2",children:(0,t.jsx)("span",{className:"font-mono text-sm font-medium text-gray-900",children:n?$(n):""})}),(0,t.jsx)("div",{className:"flex items-center gap-2 text-xs text-gray-600",children:(0,t.jsxs)("span",{className:"font-semibold",children:[g?(e=>{if(!e)return"0";var s=parseFloat((0,h.c)(e));return 0===s?"0":s<1e-4?"<0.0001":s<1?s.toFixed(4):s<100?s.toFixed(2):s.toFixed(0)})(g.value):"0"," ",(null==g?void 0:g.symbol)||"ETH"]})})]}),(0,t.jsx)(H.A,{className:"w-4 h-4 text-gray-500 ml-2"})]})})}),(0,t.jsxs)(E,{align:"end",className:"w-64 p-2 rounded-xl shadow-xl border",children:[(0,t.jsxs)("div",{className:"px-3 py-2 mb-2 bg-gray-50 rounded-lg",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"钱包地址"}),n&&(0,t.jsx)(q.CopyToClipboard,{text:n,onCopy:(e,s)=>{s?(D(!0),V.Ay.success("地址已复制到剪贴板"),setTimeout(()=>D(!1),2e3)):V.Ay.error("复制失败")},children:(0,t.jsx)(v.$,{variant:"ghost",size:"sm",className:"h-6 px-2 text-xs",children:B?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(b.A,{className:"w-3 h-3 mr-1"}),"已复制"]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(I.A,{className:"w-3 h-3 mr-1"}),"复制"]})})})]}),(0,t.jsx)("p",{className:"font-mono text-xs text-gray-600 mt-1 break-all",children:n})]}),(0,t.jsxs)(C,{onClick:()=>{try{P(),V.Ay.success("已断开钱包连接")}catch(e){console.error("断开连接失败:",e),V.Ay.error("断开连接失败")}},className:"rounded-lg text-red-600 focus:text-red-600 focus:bg-red-50",children:[(0,t.jsx)(S.A,{className:"w-4 h-4 mr-3"}),"断开连接"]})]})]}):(0,t.jsx)(v.$,{onClick:()=>(0,i._)(function(){var e;return(0,c.YH)(this,function(s){try{if(!window.ethereum)return V.Ay.error("请安装 MetaMask 或使用支持的钱包浏览器"),[2];if(!Z)return V.Ay.error("未找到可用的钱包连接器"),[2];if(F||d)return V.Ay.error("连接请求正在处理中，请稍候"),[2];w({connector:Z})}catch(s){console.error("连接钱包失败:",s),(null==s?void 0:s.name)==="UserRejectedRequestError"?V.Ay.error("用户取消了连接请求"):(null==s||null==(e=s.message)?void 0:e.includes("Connector not found"))?V.Ay.error("未找到钱包，请确保已安装并解锁钱包"):V.Ay.error("连接钱包失败，请重试")}return[2]})})(),disabled:M,className:(0,A.cn)("bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white font-medium px-6 py-2.5 rounded-xl shadow-lg hover:shadow-xl transition-all duration-200",e),children:M?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(U.A,{className:"w-4 h-4 mr-2 animate-spin"}),"连接中..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(T.A,{className:"w-4 h-4 mr-2"}),"连接钱包"]})})}var O=a(86739),B=(0,a(47137).F)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),D=l.forwardRef((e,s)=>{var a=e.className,r=e.variant,n=(0,j._)(e,["className","variant"]);return(0,t.jsx)("div",(0,N._)({ref:s,role:"alert",className:(0,A.cn)(B({variant:r}),a)},n))});D.displayName="Alert";var Z=l.forwardRef((e,s)=>{var a=e.className,r=(0,j._)(e,["className"]);return(0,t.jsx)("h5",(0,N._)({ref:s,className:(0,A.cn)("mb-1 font-medium leading-none tracking-tight",a)},r))});Z.displayName="AlertTitle";var $=l.forwardRef((e,s)=>{var a=e.className,r=(0,j._)(e,["className"]);return(0,t.jsx)("div",(0,N._)({ref:s,className:(0,A.cn)("text-sm [&_p]:leading-relaxed",a)},r))});$.displayName="AlertDescription";var J=a(25239),M=()=>{var e=(0,J.q)(),s=e.error,a=e.setError,n=(0,r._)((0,l.useState)(!1),2),o=n[0],d=n[1];return((0,l.useEffect)(()=>{s&&d(!0)},[s,a]),o&&s)?(0,t.jsxs)(D,{variant:"destructive",children:[(0,t.jsx)(O.A,{className:"h-4 w-4"}),(0,t.jsx)(Z,{children:s.name}),(0,t.jsx)($,{children:s.message})]}):null},G=a(1984),W=a(83416),X=a(99742);let Y=e=>{var s,a,n=e.title,i=e.showBackButton,c=e.backUrl,f=void 0===c?"":c,x=(0,u.F)(),p=x.address,h=x.status,N=(0,m.i)(),g=null!=(s=X.env.NEXT_PUBLIC_CHAIN_NAME)?s:X.env.NEXT_PUBLIC_CHAIN,j=(0,J.q)().setError,w=((0,l.useContext)(W.N)||{}).token,y=(0,d.useRouter)(),b=(0,r._)((0,l.useState)(0),2),_=b[0],A=b[1],k=(0,r._)((0,l.useState)(!1),2),R=k[0],E=k[1];return(0,l.useEffect)(()=>{localStorage.getItem("networkAutoRefreshed")&&localStorage.removeItem("networkAutoRefreshed");var e=e=>{if(console.error("handleError:",e),e&&e.message&&(e.message.includes("f is not a function")||e.message.includes("User rejected")&&e.message.includes("Details:"))){var s=Date.now();s-_>3e4&&!R&&(A(s),E(!0),setTimeout(()=>{localStorage.setItem("networkAutoRefreshed","true"),window.location.reload()},2e3))}};window.addEventListener("error",s=>{s.error&&"object"==typeof s.error&&e(s.error)});var s=window.onerror;return window.onerror=function(a,r,t,n,o){return e(o),!!s&&s(a,r,t,n,o)},window.addEventListener("unhandledrejection",s=>{console.log("unhandledrejection:",s),e(s.reason)}),()=>{window.onerror=s,window.removeEventListener("unhandledrejection",s=>{e(s.reason)})}},[_,R]),(0,l.useEffect)(()=>{"connected"===h&&(p&&!N?j({name:"钱包网络错误",message:"请切换到 ".concat(g," 网络")}):j(null))},[p,N,h,g,j]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(o(),{children:[(0,t.jsx)("title",{children:"".concat(null!=(a=null==w?void 0:w.symbol)?a:"LOVE20")}),(0,t.jsx)("meta",{name:"".concat(n," - ").concat(null==w?void 0:w.symbol),content:"A Web3 DApp for LOVE20 token management"})]}),(0,t.jsxs)("header",{className:"flex justify-between items-center py-2 px-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)(G.x2,{className:"-ml-1"}),(void 0!==i&&i||""!==f)&&(0,t.jsx)(v.$,{variant:"outline",size:"sm",onClick:()=>{f?y.push(f):y.back()},className:"flex items-center gap-2 px-3 py-2 text-gray-700 border-gray-300 hover:bg-gray-50 hover:text-gray-900",title:"返回上一页",children:(0,t.jsx)("span",{className:"text-sm font-medium",children:"<\xa0返回"})})]}),(0,t.jsx)(P,{})]}),(0,t.jsx)("div",{className:"px-4",children:(0,t.jsx)(M,{})})]})}}}]);