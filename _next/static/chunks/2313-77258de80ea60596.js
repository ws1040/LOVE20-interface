try{!function(){var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},s=(new e.Error).stack;s&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[s]="70ea51c3-bee3-4368-8bb0-f52396dea134",e._sentryDebugIdIdentifier="sentry-dbid-70ea51c3-bee3-4368-8bb0-f52396dea134")}()}catch(e){}"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2313],{82313:function(e,s,t){var n=t(11010),r=t(91309),i=t(97582),a=t(85893),c=t(1504),l=t(86501),d=t(20975),o=t(67294),u=t(41664),x=t.n(u),m=t(99019),h=t(56566),f=t(99522),b=t(30449),v=t(46273),y=t(94283),g=t(97613),j=t(907),p=t(43447),k=t(25223),N=t(761),w=t(26749);s.Z=function(e){var s,t,u,C,B=e.token,I=e.enableWithdraw,A=void 0!==I&&I,T=(0,d.m)().address,E=(0,v.Bk)(),_=E.currentRound,F=E.isPending,Z=E.error,D=(0,b.L)(null==B?void 0:B.address,T),z=D.slAmount,P=D.stAmount,S=D.promisedWaitingPhases,L=D.requestedUnstakeRound,J=D.govVotes,W=D.isPending,G=D.error,H=function(){return!(!z||z<=BigInt(0))||(l.Am.error("流动性质押数量为0，不用取消质押"),!1)},K=(0,j.yG)(null==B?void 0:B.slTokenAddress,T,"0xb0d291C3B036860c8D5E2C681bFa391F787b26Cb",A),R=K.allowance,V=K.isPending,q=K.error,Q=(0,j.yG)(null==B?void 0:B.stTokenAddress,T,"0xb0d291C3B036860c8D5E2C681bFa391F787b26Cb",A),U=Q.allowance,M=Q.isPending,O=Q.error,X=(0,b.Ty)((null==B?void 0:B.address)||"",T||""),Y=X.validGovVotes;X.isPending,X.error;var $=(0,r._)((0,o.useState)(!1),2),ee=$[0],es=$[1],et=(0,r._)((0,o.useState)(!1),2),en=et[0],er=et[1],ei=(0,y.yA)(null==B?void 0:B.stTokenAddress),ea=ei.isPending,ec=ei.isConfirming,el=ei.isConfirmed,ed=ei.writeError,eo=ei.approve,eu=(0,g.yA)(null==B?void 0:B.slTokenAddress),ex=eu.isPending,em=eu.isConfirming,eh=eu.isConfirmed,ef=eu.writeError,eb=eu.approve,ev=(s=(0,n._)(function(){return(0,i.Jh)(this,function(e){switch(e.label){case 0:if(!H())return[2];e.label=1;case 1:if(e.trys.push([1,4,,5]),!(z&&z>BigInt(0)&&!ee))return[3,3];return[4,eb("0xb0d291C3B036860c8D5E2C681bFa391F787b26Cb",z)];case 2:e.sent(),e.label=3;case 3:return[3,5];case 4:return e.sent(),[3,5];case 5:return[2]}})}),function(){return s.apply(this,arguments)}),ey=(t=(0,n._)(function(){return(0,i.Jh)(this,function(e){switch(e.label){case 0:if(!H())return[2];e.label=1;case 1:if(e.trys.push([1,4,,5]),!(P&&P>BigInt(0)&&!en))return[3,3];return[4,eo("0xb0d291C3B036860c8D5E2C681bFa391F787b26Cb",P)];case 2:e.sent(),e.label=3;case 3:return[3,5];case 4:return e.sent(),[3,5];case 5:return[2]}})}),function(){return t.apply(this,arguments)});(0,o.useEffect)(function(){eh?es(!0):z&&z>BigInt(0)&&R&&R>=z?es(!0):es(!1)},[z,R,V,eh]),(0,o.useEffect)(function(){el?er(!0):!P||P<=BigInt(0)?er(!0):U&&U>=P?er(!0):er(!1)},[P,U,M,el]);var eg=(0,b.vc)(),ej=eg.isWriting,ep=eg.isConfirming,ek=eg.isConfirmed,eN=eg.writeError,ew=eg.unstake,eC=(u=(0,n._)(function(){return(0,i.Jh)(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,ew(null==B?void 0:B.address)];case 1:case 2:return e.sent(),[3,3];case 3:return[2]}})}),function(){return u.apply(this,arguments)});(0,o.useEffect)(function(){ek&&(l.Am.success("取消质押成功"),setTimeout(function(){window.location.href="".concat("/interface","/my?symbol=").concat(null==B?void 0:B.symbol)},2e3))},[ek]);var eB=(0,b.Qc)(),eI=eB.isWriting,eA=eB.isConfirming,eT=eB.isConfirmed,eE=eB.writeError,e_=eB.withdraw,eF=(C=(0,n._)(function(){return(0,i.Jh)(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,e_(null==B?void 0:B.address)];case 1:case 2:return e.sent(),[3,3];case 3:return[2]}})}),function(){return C.apply(this,arguments)});(0,o.useEffect)(function(){eT&&(l.Am.success("取回代币成功"),setTimeout(function(){window.location.href="".concat("/interface","/my?symbol=").concat(null==B?void 0:B.symbol)},2e3))},[eT]);var eZ=(0,f.S)().handleContractError;if((0,o.useEffect)(function(){G&&eZ(G,"stake"),ed&&eZ(ed,"stToken"),ef&&eZ(ef,"slToken"),eN&&eZ(eN,"stake"),eE&&eZ(eE,"stake"),Z&&eZ(Z,"stake"),q&&eZ(q,"slToken"),O&&eZ(O,"stToken")},[G,ed,ef,eN,eE,Z,q,O]),!T)return(0,a.jsx)("div",{className:"text-sm mt-4 text-greyscale-500 text-center",children:"请先连接钱包"});if(!B||A&&F||W)return(0,a.jsx)(N.Z,{});if(!W&&!z)return(0,a.jsx)("div",{className:"text-sm mt-4 text-greyscale-500 text-center",children:"您没有质押"});var eD=ex||em,ez=ea||ec,eP=ee&&en,eS=L&&_>L+(S||BigInt(0));return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"stats w-full grid grid-cols-2 divide-x-0 ",children:[(0,a.jsxs)("div",{className:"stat place-items-center pt-0 pb-1 pl-1",children:[(0,a.jsx)("div",{className:"stat-title text-sm",children:"我的治理票数"}),(0,a.jsx)("div",{className:"stat-value text-xl text-secondary",children:W?(0,a.jsx)(N.Z,{}):(0,m.LH)(J||BigInt(0))}),(0,a.jsx)("div",{className:"stat-desc text-xs mb-2 mt-1",children:L&&L>BigInt(0)&&"注意：解锁期内治理票数为0"})]}),(0,a.jsxs)("div",{className:"stat place-items-center pt-0 pb-1 pl-1",children:[(0,a.jsx)("div",{className:"stat-title text-sm",children:"我承诺的解锁期"}),(0,a.jsxs)("div",{className:"stat-value text-lg",children:[(0,a.jsx)("span",{className:"text-secondary",children:W?(0,a.jsx)(N.Z,{}):"".concat(S||BigInt(0)," ")}),(0,a.jsx)("span",{className:"text-sm text-gray-600",children:" 阶段"})]}),(0,a.jsx)("div",{className:"stat-desc text-xs mb-2 mt-1",children:"".concat((0,h.Cn)(Number(S||BigInt(0)),!0))})]})]}),(0,a.jsxs)("div",{className:"stats w-full grid grid-cols-2 divide-x-0",children:[(0,a.jsxs)("div",{className:"stat place-items-center pt-0 pb-1 pl-1",children:[(0,a.jsxs)("div",{className:"stat-title text-sm flex items-center",children:["流动性质押凭证SL代币",(0,a.jsx)(k.Z,{address:B.slTokenAddress,showAddress:!1}),(0,a.jsx)(p.Z,{tokenAddress:B.slTokenAddress,tokenSymbol:"sl"+B.symbol,tokenDecimals:B.decimals})]}),(0,a.jsx)("div",{className:"stat-value text-xl text-gray-600",children:W?(0,a.jsx)(N.Z,{}):(0,m.LH)(z||BigInt(0))}),(0,a.jsx)("div",{className:"stat-desc text-xs",children:(0,a.jsx)(c.z,{variant:"link",className:"text-secondary font-normal border-secondary",asChild:!0,children:(0,a.jsx)(x(),{href:"/gov/stakelp/?symbol=".concat(B.symbol),children:"质押 获取治理票\xa0>>"})})})]}),(0,a.jsxs)("div",{className:"stat place-items-center pt-0 pb-1 pl-3",children:[(0,a.jsxs)("div",{className:"stat-title text-sm flex items-center",children:["代币质押凭证ST代币",(0,a.jsx)(k.Z,{address:B.stTokenAddress,showAddress:!1}),(0,a.jsx)(p.Z,{tokenAddress:B.stTokenAddress,tokenSymbol:"st"+B.symbol,tokenDecimals:B.decimals})]}),(0,a.jsx)("div",{className:"stat-value text-xl text-gray-600",children:W?(0,a.jsx)(N.Z,{}):(0,m.LH)(P||BigInt(0))}),(0,a.jsx)("div",{className:"stat-desc text-xs",children:(0,a.jsx)(c.z,{variant:"link",className:"text-secondary font-normal border-secondary",asChild:!0,children:(0,a.jsx)(x(),{href:"/gov/staketoken?symbol=".concat(B.symbol),children:"质押 增加治理收益\xa0>>"})})})]})]}),Y<=BigInt(0)&&J&&J>BigInt(0)&&(0,a.jsx)("div",{className:"text-sm mb-4 text-greyscale-500 text-center",children:(0,a.jsx)("div",{className:"text-red-500",children:"当前 sl 或 st 代币余额不足，导致有效治理票为0，请及时补足"})}),A&&(0,a.jsxs)(a.Fragment,{children:[!L&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex justify-center space-x-2 mt-2",children:[(0,a.jsx)(c.z,{className:"w-1/3",onClick:ev,disabled:eD||ee,children:eD?"1.提交中...":em?"1.确认中...":ee?"1.sl".concat(null==B?void 0:B.symbol," 已授权"):"1.授权 sl".concat(null==B?void 0:B.symbol)}),(0,a.jsx)(c.z,{className:"w-1/3",onClick:ey,disabled:!ee||ez||en,children:ez?"2.提交中...":ec?"2.确认中...":en?"2.st".concat(null==B?void 0:B.symbol," 已授权"):"2.授权 st".concat(null==B?void 0:B.symbol)}),(0,a.jsx)(c.z,{className:"w-1/3",onClick:eC,disabled:!eP||ej||ep||ek,children:ej?"3.提交中":ep?"3.确认中":ek?"3.已取消质押":"3.取消质押"})]}),(0,a.jsxs)("div",{className:"text-center mt-4 text-sm text-greyscale-600",children:["解锁期，是从取消质押的阶段结束时开始计算",(0,a.jsx)("br",{}),"（现在取消质押后，投票轮第",(0,a.jsx)("span",{className:"text-secondary mx-1",children:"".concat((0,m.cK)(_,B)+(S||BigInt(0))+BigInt(1)," ")}),"轮才能取回代币）"]})]}),L&&(0,a.jsx)(a.Fragment,{children:(0,a.jsx)("div",{className:"flex w-full justify-center mt-2",children:(0,a.jsx)(c.z,{className:"w-1/2",onClick:eF,disabled:!eS||eI||eA||eT,children:eS?eI?"提交中":eA?"确认中":eT?"已取回":"取回质押代币":"已取消,第"+((0,m.cK)(L,B)+(S||BigInt(0))+BigInt(1))+"轮才可取回"})})})]}),!A&&(0,a.jsxs)("div",{className:"flex justify-center space-x-4",children:[(0,a.jsx)(c.z,{variant:"outline",className:"w-1/2 text-secondary border-secondary",asChild:!0,children:(0,a.jsx)(x(),{href:"/my/govrewards?symbol=".concat(B.symbol),children:"铸造 治理激励 >>"})}),L&&(0,a.jsx)(c.z,{variant:"outline",className:"w-1/2 ".concat(eS?"text-secondary border-secondary":"text-greyscale-400 border-greyscale-400"," "),disabled:!eS,asChild:!0,children:(0,a.jsx)(x(),{href:"/gov/unstake/?symbol=".concat(B.symbol),children:eS?"取回质押代币":"已取消, 第"+((0,m.cK)(L,B)+(S||BigInt(0))+BigInt(1))+"轮可取回"})})]}),(0,a.jsx)(w.Z,{isLoading:eD||ez||eI||ej||eA||ep,text:ex||ea||eI||ej?"提交交易...":"确认交易..."})]})}}}]);