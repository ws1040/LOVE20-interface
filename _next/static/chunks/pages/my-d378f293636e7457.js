(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6862],{18651:(e,s,a)=>{"use strict";a.d(s,{A:()=>x});var t=a(40854),n=a(37876),r=a(14232),l=a(63934),c=a(83416);let d=e=>{var s=e.initialTimeLeft,a=e.onTick,l=(0,t._)((0,r.useState)(Date.now()+1e3*s),2),c=l[0],d=l[1],i=(0,t._)((0,r.useState)(s),2),o=i[0],x=i[1];(0,r.useEffect)(()=>{d(Date.now()+1e3*s)},[s]),(0,r.useEffect)(()=>{var e=setInterval(()=>{var s=Math.max(0,Math.floor((c-Date.now())/1e3));x(s),a&&a(s),s<=0&&(clearInterval(e),window.location.reload())},1e3);return()=>clearInterval(e)},[c,a]);var m=Math.floor(o/86400),h=Math.floor(o%86400/3600),j=Math.floor(o%3600/60);return(0,n.jsxs)("div",{className:"inline-flex gap-1 text-greyscale-400",children:[m>0&&(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{className:"countdown font-mono",children:(0,n.jsx)("span",{style:{"--value":m}})}),"天"]}),(h>0||m>0)&&(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{className:"countdown font-mono",children:(0,n.jsx)("span",{style:{"--value":h}})}),"时"]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{className:"countdown font-mono",children:(0,n.jsx)("span",{style:{"--value":j}})}),"分"]}),m<=0&&(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{className:"countdown font-mono",children:(0,n.jsx)("span",{style:{"--value":o%60}})}),"秒"]})]})};var i=a(12293),o=a(99742);let x=e=>{var s=e.currentRound,a=e.roundType,x=e.showCountdown,m=(0,l.y)().data,h=(0,r.useContext)(c.N),j=h?h.token:void 0,N=!m||!j||void 0===j.voteOriginBlocks,v=(0,t._)((0,r.useState)(0n),2),u=v[0],f=v[1],p=Number(o.env.NEXT_PUBLIC_PHASE_BLOCKS)||0,y=Number(o.env.NEXT_PUBLIC_BLOCK_TIME)||0,g=j?Number(j.voteOriginBlocks):0,b=p-(Number(m)-g)%p,w=b>0?Math.ceil(b*y/100):0,A=(0,t._)((0,r.useState)(w),2),k=A[0],_=A[1];(0,r.useEffect)(()=>{if(m){var e=p-(Number(m)-g)%p;_(e>0?Math.ceil(e*y/100):0)}},[m,p,y,g]),(0,r.useEffect)(()=>{s>0n&&f(s)},[s]);var C=null!=u?u.toString():"0";return u<=0n?(0,n.jsx)(n.Fragment,{}):N||null==u||u<0n?((null==u||u<0n)&&(console.log("currentTokenRound",u),console.log("currentRound",s)),(0,n.jsx)(i.A,{})):(0,n.jsx)("div",{className:"flex items-center mb-3",children:(0,n.jsxs)("span",{className:"text-sm text-greyscale-400",children:["( 第",(0,n.jsx)("span",{className:"text-greyscale-400",children:C}),"轮","vote"===a?"投票":"verify"===a?"验证":"行动","阶段，",(0,n.jsx)("span",{className:"text-greyscale-400",children:"剩余"}),(0,n.jsx)("span",{className:"text-greyscale-400",children:Math.ceil(100*k/y)}),(0,n.jsx)("span",{className:"text-greyscale-400 mr-1",children:"块, 约"}),void 0===x||x?(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(d,{initialTimeLeft:w,onTick:_})}):(0,n.jsx)("span",{className:"text-greyscale-400",children:k<60?"".concat(k,"秒"):k<=300?"".concat(Math.floor(k/60),"分钟").concat(k%60,"秒"):k<3600?"".concat(Math.floor(k/60),"分钟"):"".concat(Math.floor(k/3600),"小时").concat(Math.floor(k%3600/60),"分钟")}),(0,n.jsx)("span",{className:"text-greyscale-400",children:" )"})]})})}},28638:(e,s,a)=>{"use strict";a.d(s,{BT:()=>x,Wu:()=>m,ZB:()=>o,Zp:()=>d,aR:()=>i,wL:()=>h});var t=a(3576),n=a(65699),r=a(37876),l=a(14232),c=a(30684),d=l.forwardRef((e,s)=>{var a=e.className,l=(0,n._)(e,["className"]);return(0,r.jsx)("div",(0,t._)({ref:s,className:(0,c.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",a)},l))});d.displayName="Card";var i=l.forwardRef((e,s)=>{var a=e.className,l=(0,n._)(e,["className"]);return(0,r.jsx)("div",(0,t._)({ref:s,className:(0,c.cn)("flex flex-col space-y-1.5 p-6",a)},l))});i.displayName="CardHeader";var o=l.forwardRef((e,s)=>{var a=e.className,l=(0,n._)(e,["className"]);return(0,r.jsx)("div",(0,t._)({ref:s,className:(0,c.cn)("text-2xl font-semibold leading-none tracking-tight",a)},l))});o.displayName="CardTitle";var x=l.forwardRef((e,s)=>{var a=e.className,l=(0,n._)(e,["className"]);return(0,r.jsx)("div",(0,t._)({ref:s,className:(0,c.cn)("text-sm text-muted-foreground",a)},l))});x.displayName="CardDescription";var m=l.forwardRef((e,s)=>{var a=e.className,l=(0,n._)(e,["className"]);return(0,r.jsx)("div",(0,t._)({ref:s,className:(0,c.cn)("p-6 pt-0",a)},l))});m.displayName="CardContent";var h=l.forwardRef((e,s)=>{var a=e.className,l=(0,n._)(e,["className"]);return(0,r.jsx)("div",(0,t._)({ref:s,className:(0,c.cn)("flex items-center p-6 pt-0",a)},l))});h.displayName="CardFooter"},43579:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>T});var t=a(37876),n=a(14232),r=a(8047),l=a(48230),c=a.n(l),d=a(6960),i=a(83416),o=a(60154),x=a(1709),m=a(20442),h=a(9215),j=a(4113),N=a(12293),v=a(87577),u=a(75695);let f=e=>{var s=e.token,a=(0,r.F)().address,l=(0,h.lW)(null==s?void 0:s.address,a),i=l.balance,o=l.isPending,f=l.error,p=(0,h.lW)(null==s?void 0:s.parentTokenAddress,a),y=p.balance,g=p.isPending,b=p.error,w=(0,j.g)().handleContractError;return((0,n.useEffect)(()=>{f&&w(f,"token"),b&&w(b,"token")},[f,b]),s)?a?(0,t.jsxs)("div",{className:"flex-col items-center px-4 py-2",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)(x.A,{title:"我的代币"}),(0,t.jsx)(d.$,{variant:"link",className:"text-secondary border-secondary",asChild:!0,children:(0,t.jsx)(c(),{href:"/dex/swap?symbol=".concat(s.symbol),children:"兑换代币"})})]}),(0,t.jsxs)("div",{className:"stats bg-gray-100 w-full grid grid-cols-2 divide-x-0",children:[(0,t.jsxs)("div",{className:"stat place-items-center pb-3",children:[(0,t.jsxs)("div",{className:"stat-title text-sm flex items-center font-mono",children:["持有 ",null==s?void 0:s.symbol,(0,t.jsx)(v.A,{address:s.address,showAddress:!1}),(0,t.jsx)(u.A,{tokenAddress:s.address,tokenSymbol:s.symbol,tokenDecimals:s.decimals})]}),(0,t.jsx)("div",{className:"stat-value text-xl",children:o?(0,t.jsx)(N.A,{}):(0,m.NJ)(i||BigInt(0))}),(0,t.jsx)("div",{className:"stat-desc mt-0 text-xs text-greyscale-400 font-light",children:"不含质押、锁定"})]}),(0,t.jsxs)("div",{className:"stat place-items-center pb-3",children:[(0,t.jsxs)("div",{className:"stat-title text-sm flex items-center font-mono",children:["持有 ",null==s?void 0:s.parentTokenSymbol,(0,t.jsx)(v.A,{address:s.parentTokenAddress,showAddress:!1}),(0,t.jsx)(u.A,{tokenAddress:s.parentTokenAddress,tokenSymbol:s.parentTokenSymbol,tokenDecimals:s.decimals})]}),(0,t.jsx)("div",{className:"stat-value text-xl",children:g?(0,t.jsx)(N.A,{}):(0,m.NJ)(y||BigInt(0))}),(0,t.jsx)("div",{className:"stat-desc mt-0 text-xs text-greyscale-400 font-light"})]})]})]}):(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)("div",{className:"flex-col items-center px-4 py-2",children:[(0,t.jsx)(x.A,{title:"我的代币"}),(0,t.jsx)("div",{className:"text-sm mt-4 text-greyscale-500 text-center",children:"请先连接钱包"})]})}):(0,t.jsx)(N.A,{})};var p=a(92474),y=a(28638),g=a(91754),b=a(96108),w=a(44769),A=a(17660),k=a(18651);let _=e=>{var s=e.token,a=(0,r.F)().address,n=(0,A.vC)().currentRound,l=(0,w.wz)((null==s?void 0:s.address)||"",a),d=l.joinedActions,i=l.isPending,o=l.error,h=(0,j.g)().handleContractError;return(o&&h(o,"dataViewer"),i)?(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)("div",{className:"pt-4 px-4",children:[(0,t.jsx)(x.A,{title:"我参与的行动"}),(0,t.jsx)("div",{className:"text-sm mt-4 text-greyscale-500 text-center",children:(0,t.jsx)(N.A,{})})]})}):(0,t.jsxs)("div",{className:"pt-4 px-4",children:[(0,t.jsx)(x.A,{title:"我参与的行动"}),(0,t.jsx)(k.A,{currentRound:n,roundType:"act"}),(null==d?void 0:d.length)?(0,t.jsx)("div",{className:"mt-4 space-y-4",children:[...d].sort((e,s)=>Number(s.joinedAmountOfAccount)-Number(e.joinedAmountOfAccount)).map((e,a)=>(0,t.jsx)(y.Zp,{className:"shadow-none",children:(0,t.jsxs)(c(),{href:"/my/actrewards?id=".concat(e.action.head.id,"&symbol=").concat(null==s?void 0:s.symbol),className:"relative block",children:[(0,t.jsxs)(y.aR,{className:"px-3 pt-2 pb-1 flex-row justify-between items-baseline",children:[(0,t.jsxs)("div",{className:"flex items-baseline",children:[(0,t.jsx)("span",{className:"text-greyscale-400 text-sm",children:"No."}),(0,t.jsx)("span",{className:"text-secondary text-xl font-bold mr-2",children:String(e.action.head.id)}),(0,t.jsx)("span",{className:"font-bold text-greyscale-800",children:"".concat(e.action.body.title)})]}),e.votesNum>0?e.hasReward?(0,t.jsx)("span",{className:"text-secondary text-xs",children:"进行中"}):(0,t.jsx)("span",{className:"text-error text-xs",children:"无铸币奖励"}):(0,t.jsx)("span",{className:"text-error text-xs",children:"未投票"})]}),(0,t.jsx)(y.Wu,{className:"px-3 pt-1 pb-2",children:(0,t.jsxs)("div",{className:"flex justify-between mt-1 text-sm",children:[(0,t.jsxs)("span",{className:"flex items-center",children:[(0,t.jsx)(g.A,{className:"text-greyscale-400 mr-1 h-3 w-3 -translate-y-0.5"}),(0,t.jsx)("span",{className:"text-greyscale-400",children:(0,t.jsx)(v.A,{address:e.action.head.author,showCopyButton:!1,colorClassName2:"text-secondary"})})]}),e.votesNum>0&&(0,t.jsxs)("span",{children:[(0,t.jsx)("span",{className:"text-greyscale-400 mr-1",children:"投票"}),(0,t.jsx)("span",{className:"text-secondary",children:(0,m.Ee)(Number(e.votePercentPerTenThousand)/100)})]}),(0,t.jsxs)("span",{children:[(0,t.jsx)("span",{className:"text-greyscale-400 mr-1",children:"我参与代币"}),(0,t.jsx)("span",{className:"text-secondary",children:(0,m.NJ)(e.joinedAmountOfAccount)})]})]})}),(0,t.jsx)(b.A,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-greyscale-400 pointer-events-none"})]},e.action.head.id)},e.action.head.id))}):(0,t.jsx)("div",{className:"text-sm text-greyscale-500 text-center my-6",children:"没有参与行动，请先参与"})]})};var C=a(62537);let T=()=>{var e=((0,n.useContext)(i.N)||{}).token,s=(0,r.F)().isConnected;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(o.A,{title:"我的"}),(0,t.jsx)("main",{className:"flex-grow",children:s?e?e&&!e.hasEnded?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(C.A,{}),(0,t.jsxs)("div",{className:"flex flex-col items-center p-4 mt-4",children:[(0,t.jsx)("div",{className:"text-center mb-4 text-greyscale-500",children:"公平发射未结束，还不能查看个人资产"}),(0,t.jsx)(d.$,{className:"w-1/2",asChild:!0,children:(0,t.jsx)(c(),{href:"/launch?symbol=".concat(e.symbol),children:"查看公平发射"})})]})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(f,{token:e}),(0,t.jsxs)("div",{className:"flex-col items-center p-4",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,t.jsx)(x.A,{title:"我的治理资产"}),(0,t.jsx)(d.$,{variant:"link",className:"text-secondary border-secondary",asChild:!0,children:(0,t.jsx)(c(),{href:"/gov/unstake?symbol=".concat(null==e?void 0:e.symbol),children:"取消质押"})})]}),(0,t.jsx)(p.A,{token:e})]}),(0,t.jsx)(_,{token:e})]}):(0,t.jsx)(N.A,{}):(0,t.jsx)("div",{className:"flex flex-col items-center p-4 mt-4",children:(0,t.jsx)("div",{className:"text-center mb-4 text-greyscale-500",children:"没有链接钱包，请先连接钱包"})})})]})}},57863:(e,s,a)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/my",function(){return a(43579)}])},91754:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});var t=(0,a(11713).A)("UserPen",[["path",{d:"M11.5 15H7a4 4 0 0 0-4 4v2",key:"15lzij"}],["path",{d:"M21.378 16.626a1 1 0 0 0-3.004-3.004l-4.01 4.012a2 2 0 0 0-.506.854l-.837 2.87a.5.5 0 0 0 .62.62l2.87-.837a2 2 0 0 0 .854-.506z",key:"1817ys"}],["circle",{cx:"10",cy:"7",r:"4",key:"e45bow"}]])}},e=>{e.O(0,[3308,4243,4571,5701,5060,154,5498,4769,5139,6952,7432,7121,125,2537,2474,636,6593,8792],()=>e(e.s=57863)),_N_E=e.O()}]);