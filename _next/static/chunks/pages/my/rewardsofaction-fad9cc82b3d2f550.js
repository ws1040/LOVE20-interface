try{!function(){var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="03c9df86-da78-423a-9117-62ac28897ff1",e._sentryDebugIdIdentifier="sentry-dbid-03c9df86-da78-423a-9117-62ac28897ff1")}()}catch(e){}(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2479],{34541:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/my/rewardsofaction",function(){return t(82018)}])},41944:function(e,n,t){"use strict";var r=t(85893);n.Z=function(e){var n=e.title;return(0,r.jsx)("div",{className:"flex justify-between items-center",children:(0,r.jsx)("h1",{className:"text-lg font-bold",children:n})})}},761:function(e,n,t){"use strict";var r=t(85893),s=t(45197);n.Z=function(){return(0,r.jsx)(s.Z,{className:"mx-auto h-4 w-4 animate-spin text-greyscale-500"})}},38202:function(e,n,t){"use strict";t.d(n,{$A:function(){return x},Bk:function(){return h},Xo:function(){return b},dI:function(){return f},qd:function(){return m},sK:function(){return g}});var r=t(11010),s=t(97582),i=t(67294),a=t(63600),c=t(44628),d=t(30460),o=t(42380),u=t(53260),l="0xbD8FfA5bC413DC4c13A41Bc9822b9b198ed63b36",f=function(e,n){var t=(0,a.u)({address:l,abi:c.d,functionName:"actionInfo",args:[e,n||BigInt(0)],query:{enabled:!!e&&void 0!==n}});return{actionInfo:t.data,isPending:t.isPending,error:t.error}},h=function(){var e=(0,a.u)({address:l,abi:c.d,functionName:"currentRound",args:[]}),n=e.data,t=e.isPending,r=e.error;return{currentRound:(0,d.Zu)(n),isPending:t,error:r}},x=function(e,n,t){var r=(0,a.u)({address:l,abi:c.d,functionName:"isSubmitted",args:[e,n,t]});return{isSubmitted:r.data,isPending:r.isPending,error:r.error}},g=function(e,n,t){var r=(0,a.u)({address:l,abi:c.d,functionName:"submitInfo",args:[e,n,t],query:{enabled:!!e&&!!n}});return{submitInfo:r.data,isPending:r.isPending,error:r.error}};function m(){var e,n=(0,u.e9)(c.d,l,"submit"),t=n.execute,a=n.isPending,d=n.isConfirming,f=n.isConfirmed,h=n.error,x=n.hash,g=n.isTukeMode,m=(e=(0,r._)(function(e,n){return(0,s.Jh)(this,function(r){switch(r.label){case 0:return[4,t([e,n])];case 1:return[2,r.sent()]}})}),function(n,t){return e.apply(this,arguments)});return(0,i.useEffect)(function(){h&&((0,o.Vh)(h),(0,o.H)(h))},[x,h,f]),{submit:m,isPending:a,isConfirming:d,writeError:h,isConfirmed:f,hash:x,isTukeMode:g}}function b(){var e,n=(0,u.e9)(c.d,l,"submitNewAction"),t=n.execute,a=n.isPending,d=n.isConfirming,f=n.isConfirmed,h=n.error,x=n.hash,g=n.isTukeMode,m=(e=(0,r._)(function(e,n){return(0,s.Jh)(this,function(r){switch(r.label){case 0:return[4,t([e,n])];case 1:return[2,r.sent()]}})}),function(n,t){return e.apply(this,arguments)});return(0,i.useEffect)(function(){h&&((0,o.Vh)(h),(0,o.H)(h))},[x,h,f]),{submitNewAction:m,isPending:a,isConfirming:d,writeError:h,isConfirmed:f,hash:x,isTukeMode:g}}},82018:function(e,n,t){"use strict";t.r(n);var r=t(11010),s=t(72253),i=t(14932),a=t(91309),c=t(4586),d=t(97582),o=t(85893),u=t(67294),l=t(20975),f=t(47070),h=t(11163),x=t(86501),g=t(41192),m=t(81337),b=t(38202),j=t(81975),N=t(54653),v=t(99522),y=t(81231),I=t(41944),p=t(761),w=t(26749),B=t(1504),_=t(99019),E=t(18089),P=BigInt(20);n.default=function(){var e,n=(0,h.useRouter)().query.id,t=n&&"string"==typeof n?BigInt(n):void 0,C=((0,u.useContext)(g.M)||{}).token,k=(0,l.m)().address;(0,f.x)();var $=(0,j.Bk)(),S=$.currentRound,M=$.isPending,Z=$.error,R=(0,a._)((0,u.useState)(BigInt(0)),2),T=R[0],D=R[1],A=(0,a._)((0,u.useState)(BigInt(0)),2),q=A[0],F=A[1],H=(0,a._)((0,u.useState)(!0),2),J=H[0],O=H[1],V=(0,u.useRef)(null),X=(0,b.dI)(null==C?void 0:C.address,t),z=X.actionInfo,K=X.isPending,L=X.error,W=(0,m.B$)(null==C?void 0:C.address,k,t||BigInt(0),T,q),G=W.rewards,Q=W.isPending,U=W.error,Y=(0,N.Rb)(),ee=Y.mintActionReward,en=Y.isPending,et=Y.isConfirming,er=Y.isConfirmed,es=Y.writeError,ei=(0,a._)((0,u.useState)(null),2),ea=ei[0],ec=ei[1],ed=(0,a._)((0,u.useState)([]),2),eo=ed[0],eu=ed[1];(0,u.useEffect)(function(){if(z&&C&&void 0!==S){var e=S>2?S-BigInt(2):BigInt(0);D(e>BigInt(20)?e-BigInt(20):BigInt(0)),F(e)}},[z,C,S]),(0,u.useEffect)(function(){C&&O(T>BigInt(0))},[T,C]),(0,u.useEffect)(function(){G&&eu((0,c._)(G).sort(function(e,n){return e.round<n.round?1:e.round>n.round?-1:0}))},[G]),(0,u.useEffect)(function(){er&&(ea&&eu(function(e){return e.map(function(e){return e.round===ea.round?(0,i._)((0,s._)({},e),{isMinted:!0}):e})}),x.ZP.success("铸造成功"),(null==C?void 0:C.address)&&k&&(0,E.j)(k,C.address,!1))},[er,C,k,ea]);var el=(e=(0,r._)(function(e,n){return(0,d.Jh)(this,function(t){switch(t.label){case 0:if(!((null==C?void 0:C.address)&&k))return[3,2];return ec({actionId:n,round:e}),[4,ee(C.address,e,n)];case 1:t.sent(),t.label=2;case 2:return[2]}})}),function(n,t){return e.apply(this,arguments)}),ef=(0,u.useCallback)(function(){if(C){var e=BigInt(0);D(function(n){return n>e?n-P>=e?n-P:e:n})}},[C]);(0,u.useEffect)(function(){if(V.current){var e=V.current,n=new IntersectionObserver(function(e){e.forEach(function(e){e.isIntersecting&&!Q&&J&&ef()})},{root:null,rootMargin:"200px",threshold:0});return n.observe(e),function(){n.unobserve(e),n.disconnect()}}},[ef,Q,J]);var eh=(0,v.S)().handleContractError;return((0,u.useEffect)(function(){L&&eh(L,"actionInfo"),Z&&eh(Z,"currentRound"),U&&eh(U,"dataViewer"),es&&eh(es,"mint")},[L,Z,U,es,eh]),void 0===t)?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(y.Z,{title:"行动激励",showBackButton:!0}),(0,o.jsx)("main",{className:"flex-grow",children:(0,o.jsx)("div",{className:"flex flex-col space-y-6 p-4",children:(0,o.jsx)("div",{className:"text-center text-red-500 py-4",children:"缺少行动ID参数"})})})]}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(y.Z,{title:"行动激励",showBackButton:!0}),(0,o.jsxs)("main",{className:"flex-grow",children:[!C||K||M?(0,o.jsx)(p.Z,{}):(0,o.jsxs)("div",{className:"flex flex-col space-y-6 p-4",children:[(0,o.jsx)(I.Z,{title:"铸造行动激励："}),z&&(0,o.jsx)("div",{className:"",children:(0,o.jsx)("div",{className:"flex items-center mb-3",children:(0,o.jsxs)("div",{className:"flex items-baseline mr-2",children:[(0,o.jsx)("span",{className:"text-greyscale-500",children:"No."}),(0,o.jsx)("span",{className:"text-secondary text-xl font-bold mr-2",children:String(z.head.id)}),(0,o.jsx)("span",{className:"font-bold text-greyscale-800",children:z.body.title})]})})}),(0,o.jsxs)("table",{className:"table w-full table-auto",children:[(0,o.jsx)("thead",{children:(0,o.jsxs)("tr",{className:"border-b border-gray-100",children:[(0,o.jsx)("th",{children:"轮次"}),(0,o.jsx)("th",{className:"text-center",children:"可铸造激励"}),(0,o.jsx)("th",{className:"text-center",children:"结果"})]})}),(0,o.jsx)("tbody",{children:0!==eo.length||Q?eo.map(function(e,n){return(0,o.jsxs)("tr",{className:n===eo.length-1?"border-none":"border-b border-gray-100",children:[(0,o.jsx)("td",{children:(0,_.cK)(e.round,C).toString()}),(0,o.jsx)("td",{className:"text-center",children:(0,_.LH)(e.reward||BigInt(0))}),(0,o.jsx)("td",{className:"text-center",children:e.reward>BigInt(0)&&!e.isMinted?(0,o.jsx)(B.z,{variant:"outline",size:"sm",className:"text-secondary border-secondary",onClick:function(){return el(e.round,BigInt(t))},disabled:en||et,children:"铸造"}):e.isMinted?(0,o.jsx)("span",{className:"text-greyscale-500",children:"已铸造"}):(0,o.jsx)("span",{className:"text-greyscale-500",children:"-"})})]},"".concat(t,"-").concat(e.round.toString()))}):(0,o.jsx)("tr",{children:(0,o.jsx)("td",{colSpan:3,className:"text-center text-sm text-gray-500 py-4",children:"该行动在指定轮次范围内没有获得激励"})})})]}),(0,o.jsx)("div",{ref:V,className:"h-12 flex justify-center items-center",children:Q?(0,o.jsx)(p.Z,{}):J?(0,o.jsx)("span",{className:"text-sm text-gray-500",children:"上滑加载更多..."}):(0,o.jsx)("span",{className:"text-sm text-gray-500",children:"没有更多激励"})})]}),(0,o.jsx)(w.Z,{isLoading:en||et,text:en?"提交交易...":"确认交易..."})]})]})}},21803:function(e,n,t){"use strict";function r(e,n){let[t,r="0"]=e.split("."),s=t.startsWith("-");if(s&&(t=t.slice(1)),r=r.replace(/(0+)$/,""),0===n)1===Math.round(Number(`.${r}`))&&(t=`${BigInt(t)+1n}`),r="";else if(r.length>n){let[e,s,i]=[r.slice(0,n-1),r.slice(n-1,n),r.slice(n)],a=Math.round(Number(`${s}.${i}`));(r=a>9?`${BigInt(e)+BigInt(1)}0`.padStart(e.length+1,"0"):`${e}${a}`).length>n&&(r=r.slice(1),t=`${BigInt(t)+1n}`),r=r.slice(0,n)}else r=r.padEnd(n,"0");return BigInt(`${s?"-":""}${t}${r}`)}t.d(n,{v:function(){return r}})}},function(e){e.O(0,[7395,6457,8700,1985,4628,4653,2888,9774,179],function(){return e(e.s=34541)}),_N_E=e.O()}]);