(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7757],{1709:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});var s=r(37876);let n=e=>{var t=e.title;return(0,s.jsx)("div",{className:"flex justify-between items-center",children:(0,s.jsx)("h1",{className:"text-lg font-bold",children:t})})}},12293:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var s=r(37876),n=r(7446);let i=()=>(0,s.jsx)(n.A,{className:"mx-auto h-4 w-4 animate-spin text-greyscale-500"})},17739:(e,t,r)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/my/govrewards",function(){return r(26515)}])},18449:(e,t,r)=>{"use strict";r.d(t,{X:()=>i});var s=r(76200);class n extends s.C{constructor({value:e}){super(`Number \`${e}\` is not a valid decimal number.`,{name:"InvalidDecimalNumberError"})}}function i(e,t){if(!/^(-?)([0-9]*)\.?([0-9]*)$/.test(e))throw new n({value:e});let[r,s="0"]=e.split("."),i=r.startsWith("-");if(i&&(r=r.slice(1)),s=s.replace(/(0+)$/,""),0===t)1===Math.round(Number(`.${s}`))&&(r=`${BigInt(r)+1n}`),s="";else if(s.length>t){let[e,n,i]=[s.slice(0,t-1),s.slice(t-1,t),s.slice(t)],a=Math.round(Number(`${n}.${i}`));(s=a>9?`${BigInt(e)+BigInt(1)}0`.padStart(e.length+1,"0"):`${e}${a}`).length>t&&(s=s.slice(1),r=`${BigInt(r)+1n}`),s=s.slice(0,t)}else s=s.padEnd(t,"0");return BigInt(`${i?"-":""}${r}${s}`)}},26515:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>I});var s=r(16927),n=r(3576),i=r(62701),a=r(40854),l=r(4902),c=r(37876),d=r(14232),u=r(8047),o=r(1081),x=r(6960),h=r(97685),m=r(42038),f=r(20442),N=r(83416),g=r(44769),v=r(29898),j=r(62288),b=r(4113),_=r(60154),p=r(1709),w=r(12293),E=r(99574);let I=()=>{var e=((0,d.useContext)(N.N)||{}).token,t=(0,u.F)().address,r=(0,o.i)(),I=(0,v.vC)(),y=I.currentRound,B=I.error,C=I.isPending,$=(0,a._)((0,d.useState)(0n),2),k=$[0],A=$[1],S=(0,a._)((0,d.useState)(0n),2),P=S[0],R=S[1],M=(0,a._)((0,d.useState)(!0),2),X=M[0],L=M[1],T=(0,d.useRef)(null);(0,d.useEffect)(()=>{void 0!==y&&e&&(y<=BigInt(e.initialStakeRound)?R(0n):R(BigInt(y>=1n?y-1n:0n)))},[y,e]),(0,d.useEffect)(()=>{P&&e&&(P-BigInt(e.initialStakeRound)>=20n?A(P-20n):A(BigInt(e.initialStakeRound)))},[P,e]);var F=(0,g.k3)(null==e?void 0:e.address,t,k,P),H=F.rewards,z=F.isPending,O=F.error,U=(0,a._)((0,d.useState)([]),2),D=U[0],J=U[1];(0,d.useEffect)(()=>{H&&J([...H].sort((e,t)=>e.round>t.round?-1:1))},[H]),(0,d.useEffect)(()=>{e&&L(k>BigInt(e.initialStakeRound))},[k,e]);var G=(0,j.Jv)(),V=G.mintGovReward,W=G.isPending,Y=G.isConfirming,q=G.isConfirmed,K=G.writeError,Q=(0,a._)((0,d.useState)(null),2),Z=Q[0],ee=Q[1];(0,d.useEffect)(()=>{q&&(J(e=>e.map(e=>e.round===Z?(0,i._)((0,n._)({},e),{isMinted:!0}):e)),h.Ay.success("铸造成功"))},[q,Z]);var et=(0,b.g)().handleContractError;(0,d.useEffect)(()=>{O&&et(O,"dataViewer"),B&&et(B,"mint"),K&&et(K,"mint")},[O,B,K,et]);var er=(0,d.useCallback)(()=>{if(e){var t=BigInt(e.initialStakeRound);A(e=>e>t?e-20n>=t?e-20n:t:e)}},[e]);return((0,d.useEffect)(()=>{if(T.current){var e=T.current,t=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&!z&&X&&er()})},{root:null,rootMargin:"200px",threshold:0});return t.observe(e),()=>{t.unobserve(e),t.disconnect()}}},[er,z,X]),C)?(0,c.jsx)(w.A,{}):(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(_.A,{title:"治理激励",showBackButton:!0}),(0,c.jsxs)("main",{className:"flex-grow",children:[e?(0,c.jsxs)("div",{className:"flex flex-col space-y-6 p-4",children:[(0,c.jsx)(p.A,{title:"铸造治理奖励"}),0n===P&&void 0!==y?(0,c.jsx)("div",{className:"text-center text-gray-500 py-4",children:"当前还不能铸造奖励，请耐心等待"}):(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("table",{className:"table w-full table-auto",children:[(0,c.jsx)("thead",{children:(0,c.jsxs)("tr",{className:"border-b border-gray-100",children:[(0,c.jsx)("th",{children:"轮次"}),(0,c.jsx)("th",{className:"text-center",children:"可铸造激励"}),(0,c.jsx)("th",{className:"text-center",children:"结果"})]})}),(0,c.jsx)("tbody",{children:0!==D.length||z?D.map(n=>(0,c.jsxs)("tr",{className:"border-b border-gray-100",children:[(0,c.jsx)("td",{children:e?(0,f.LP)(n.round,e).toString():"-"}),(0,c.jsx)("td",{className:"text-center",children:(0,f.NJ)(n.reward||0n)}),(0,c.jsx)("td",{className:"text-center",children:n.reward>0n&&!n.isMinted?(0,c.jsx)(x.$,{variant:"outline",size:"sm",className:"text-secondary border-secondary",onClick:()=>(n=>(0,s._)(function(){return(0,l.YH)(this,function(s){switch(s.label){case 0:if(!(0,m.z)(r))return[2];if(!((null==e?void 0:e.address)&&t))return[3,2];return ee(n),[4,V(e.address,n)];case 1:s.sent(),s.label=2;case 2:return[2]}})})())(n.round),disabled:W||Y,children:"铸造"}):n.isMinted?(0,c.jsx)("span",{className:"text-greyscale-500",children:"已铸造"}):(0,c.jsx)("span",{className:"text-greyscale-500",children:"-"})})]},n.round.toString())):(0,c.jsx)("tr",{children:(0,c.jsx)("td",{colSpan:3,className:"text-center text-sm text-gray-500 py-4",children:"暂无数据"})})})]}),(0,c.jsx)("div",{ref:T,className:"h-12 flex justify-center items-center",children:z?(0,c.jsx)(w.A,{}):X?(0,c.jsx)("span",{className:"text-sm text-gray-500",children:"加载更多..."}):(0,c.jsx)("span",{className:"text-sm text-gray-500",children:"没有更多奖励"})})]})]}):(0,c.jsx)(w.A,{}),(0,c.jsx)(E.A,{isLoading:W||Y,text:W?"提交交易...":"确认交易..."})]})]})}},42038:(e,t,r)=>{"use strict";r.d(t,{z:()=>a});var s=r(97685),n=r(99090),i=r(99742),a=e=>{var t,r=(()=>{var e,t,r=null==(t=n.$.chains)||null==(e=t[0])?void 0:e.id;if("number"==typeof r)return r;var s=Number(i.env.NEXT_PUBLIC_CHAIN_ID);return Number.isFinite(s)?s:void 0})();return!!e&&!!r&&e===r||(s.oR.error("请先将钱包链接 ".concat(null!=(t=i.env.NEXT_PUBLIC_CHAIN_NAME)?t:i.env.NEXT_PUBLIC_CHAIN)),!1)}}},e=>{e.O(0,[3308,4243,154,5498,4769,2288,9898,636,6593,8792],()=>e(e.s=17739)),_N_E=e.O()}]);