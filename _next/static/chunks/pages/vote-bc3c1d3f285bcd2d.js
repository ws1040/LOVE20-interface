try{!function(){var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},s=(new e.Error).stack;s&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[s]="d46f4b3d-982d-4030-80d8-821a933820f9",e._sentryDebugIdIdentifier="sentry-dbid-d46f4b3d-982d-4030-80d8-821a933820f9")}()}catch(e){}(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1786],{75125:function(e,s,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/vote",function(){return n(16197)}])},34680:function(e,s,n){"use strict";n.d(s,{Ol:function(){return o},SZ:function(){return u},Zb:function(){return i},aY:function(){return m},eW:function(){return x},ll:function(){return d}});var t=n(72253),a=n(47702),r=n(85893),c=n(67294),l=n(40108),i=c.forwardRef(function(e,s){var n=e.className,c=(0,a._)(e,["className"]);return(0,r.jsx)("div",(0,t._)({ref:s,className:(0,l.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",n)},c))});i.displayName="Card";var o=c.forwardRef(function(e,s){var n=e.className,c=(0,a._)(e,["className"]);return(0,r.jsx)("div",(0,t._)({ref:s,className:(0,l.cn)("flex flex-col space-y-1.5 p-6",n)},c))});o.displayName="CardHeader";var d=c.forwardRef(function(e,s){var n=e.className,c=(0,a._)(e,["className"]);return(0,r.jsx)("div",(0,t._)({ref:s,className:(0,l.cn)("text-2xl font-semibold leading-none tracking-tight",n)},c))});d.displayName="CardTitle";var u=c.forwardRef(function(e,s){var n=e.className,c=(0,a._)(e,["className"]);return(0,r.jsx)("div",(0,t._)({ref:s,className:(0,l.cn)("text-sm text-muted-foreground",n)},c))});u.displayName="CardDescription";var m=c.forwardRef(function(e,s){var n=e.className,c=(0,a._)(e,["className"]);return(0,r.jsx)("div",(0,t._)({ref:s,className:(0,l.cn)("p-6 pt-0",n)},c))});m.displayName="CardContent";var x=c.forwardRef(function(e,s){var n=e.className,c=(0,a._)(e,["className"]);return(0,r.jsx)("div",(0,t._)({ref:s,className:(0,l.cn)("flex items-center p-6 pt-0",n)},c))});x.displayName="CardFooter"},24920:function(e,s,n){"use strict";n.d(s,{Z:function(){return t}});var t=(0,n(31134).Z)("UserPen",[["path",{d:"M11.5 15H7a4 4 0 0 0-4 4v2",key:"15lzij"}],["path",{d:"M21.378 16.626a1 1 0 0 0-3.004-3.004l-4.01 4.012a2 2 0 0 0-.506.854l-.837 2.87a.5.5 0 0 0 .62.62l2.87-.837a2 2 0 0 0 .854-.506z",key:"1817ys"}],["circle",{cx:"10",cy:"7",r:"4",key:"e45bow"}]])},27460:function(e,s,n){"use strict";var t=n(91309),a=n(85893),r=n(67294),c=n(74855),l=n(78865),i=n(18289),o=n(86501),d=n(91529);s.Z=function(e){var s=e.address,n=e.word,u=e.showCopyButton,m=e.showAddress,x=void 0===m||m,f=e.colorClassName,h=void 0===f?"":f,N=e.colorClassName2,p=void 0===N?"":N,v=(0,t._)((0,r.useState)(!1),2),y=v[0],j=v[1];return(0,a.jsxs)("span",{className:"inline-flex items-center space-x-2",children:[n&&(0,a.jsx)("span",{className:"text-xs",children:n}),x&&!p&&(0,a.jsx)("span",{className:"font-mono text-xs ".concat(null!=h?h:"text-greyscale-500"),children:(0,d.Vu)(s)}),x&&p&&(0,a.jsxs)("span",{className:"text-[0px]",children:[(0,a.jsx)("span",{className:"font-mono text-xs ".concat(null!=h?h:"text-greyscale-500"),children:"".concat(s.substring(0,6),"...")}),(0,a.jsx)("span",{className:"font-mono text-xs ".concat(p),children:"".concat(s.substring(s.length-4))})]}),(void 0===u||u)&&(0,a.jsx)(c.CopyToClipboard,{text:s,onCopy:function(e,s){s?j(!0):o.ZP.error("复制失败")},children:(0,a.jsx)("button",{className:"flex items-center justify-center p-1 rounded focus:outline-none active:bg-gray-200 md:hover:bg-gray-200",onClick:function(e){e.preventDefault(),e.stopPropagation()},"aria-label":"复制地址",style:{WebkitTapHighlightColor:"transparent",WebkitAppearance:"none",appearance:"none",background:"transparent",backgroundColor:"transparent",border:"none",outline:"none"},children:y?(0,a.jsx)(l.Z,{className:"h-4 w-4 ".concat(null!=h?h:"text-greyscale-500")}):(0,a.jsx)(i.Z,{className:"h-4 w-4 ".concat(null!=h?h:"text-greyscale-500")})})})]})}},64777:function(e,s,n){"use strict";var t=n(85893);s.Z=function(e){var s=e.title;return(0,t.jsx)("div",{className:"flex justify-between items-center",children:(0,t.jsx)("h1",{className:"text-lg font-bold",children:s})})}},42083:function(e,s,n){"use strict";var t=n(85893),a=n(23432);s.Z=function(){return(0,t.jsx)(a.Z,{className:"mx-auto h-4 w-4 animate-spin text-greyscale-500"})}},16197:function(e,s,n){"use strict";n.r(s),n.d(s,{default:function(){return _}});var t=n(85893),a=n(67294),r=n(7080),c=n(73591),l=n(83494),i=n(91309),o=n(11163),d=n(86501),u=n(24920),m=n(27245),x=n(34680),f=n(42130),h=n(41664),N=n.n(h),p=n(93950),v=n(91529),y=n(93778),j=n(27460),b=n(64777),g=n(42083),w=function(e){var s=e.currentRound,n=(0,f.m)().address,r=((0,a.useContext)(y.M)||{}).token,l=(0,o.useRouter)(),h=(0,p.YK)((null==r?void 0:r.address)||"",s,n),w=h.votingActions,_=h.isPending,C=h.error,k=(0,i._)((0,a.useState)(new Set),2),Z=k[0],I=k[1],B=function(e){I(function(s){var n=new Set(s);return n.has(e)?n.delete(e):n.add(e),n})},$=w.reduce(function(e,s){return e+s.votesNum},BigInt(0)),E=(0,c.S)().handleContractError;return((0,a.useEffect)(function(){C&&E(C,"vote")},[C,E]),_)?(0,t.jsx)("div",{className:"p-4 flex justify-center items-center",children:(0,t.jsx)(g.Z,{})}):r?(0,t.jsxs)("div",{className:"p-4",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,t.jsx)(b.Z,{title:"投票中的行动"}),r&&(0,t.jsxs)("div",{className:"flex space-x-2",children:[(0,t.jsx)(m.z,{variant:"outline",size:"sm",className:"text-secondary border-secondary",asChild:!0,children:(0,t.jsx)(N(),{href:"/action/new/?symbol=".concat(null==r?void 0:r.symbol),children:"推举新行动"})}),(0,t.jsx)(m.z,{variant:"outline",size:"sm",className:"text-secondary border-secondary",asChild:!0,children:(0,t.jsx)(N(),{href:"/vote/actions4submit?symbol=".concat(null==r?void 0:r.symbol),children:"推举历史行动"})})]})]}),(0,t.jsx)("div",{className:"space-y-4",children:w.length>0?(0,t.jsxs)(t.Fragment,{children:[w.sort(function(e,s){return Number(s.votesNum-e.votesNum)}).map(function(e,s){var n=e.action;return(0,t.jsxs)(x.Zb,{className:"shadow-none flex items-center",children:[(0,t.jsx)("input",{type:"checkbox",className:"checkbox accent-secondary ml-2",checked:Z.has(BigInt(n.head.id)),onChange:function(){return B(BigInt(n.head.id))}}),(0,t.jsxs)(N(),{href:"/action/detail?id=".concat(n.head.id,"&type=vote&symbol=").concat(null==r?void 0:r.symbol),className:"w-full",children:[(0,t.jsxs)(x.Ol,{className:"px-3 pt-2 pb-1 flex-row justify-start items-baseline",children:[(0,t.jsx)("span",{className:"text-greyscale-400 text-sm mr-1",children:"No."}),(0,t.jsx)("span",{className:"text-secondary text-xl font-bold mr-2",children:String(n.head.id)}),(0,t.jsx)("span",{className:"font-bold text-greyscale-800",children:"".concat(n.body.title)})]}),(0,t.jsx)(x.aY,{className:"px-3 pt-1 pb-2",children:(0,t.jsxs)("div",{className:"flex justify-between mt-1 text-sm",children:[(0,t.jsxs)("span",{className:"flex items-center",children:[(0,t.jsx)(u.Z,{className:"text-greyscale-400 mr-1 h-3 w-3"}),(0,t.jsx)("span",{className:"text-greyscale-400",children:(0,t.jsx)(j.Z,{address:n.head.author,showCopyButton:!1})})]}),(0,t.jsxs)("span",{children:[(0,t.jsx)("span",{className:"text-greyscale-400 mr-1",children:"投票数"}),(0,t.jsx)("span",{className:"text-secondary",children:(0,v.LH)(e.votesNum)})]}),(0,t.jsxs)("span",{children:[(0,t.jsx)("span",{className:"text-greyscale-400 mr-1",children:"占比"}),(0,t.jsx)("span",{className:"text-secondary",children:$===BigInt(0)?"-":(0,v.rl)(100*Number(e.votesNum)/Number($))})]})]})})]},n.head.id)]},n.head.id)}),(0,t.jsx)("div",{className:"flex justify-center mt-4",children:(0,t.jsx)(m.z,{variant:"outline",className:"w-1/2 text-secondary border-secondary",onClick:function(){var e=Array.from(Z).join(",");if(0===e.length){d.Am.error("请选择行动");return}l.push("/vote/vote?ids=".concat(e,"&symbol=").concat(null==r?void 0:r.symbol))},children:"给选中的行动投票"})}),(0,t.jsx)("div",{className:"mt-2 text-sm text-greyscale-500 text-center",children:"提示: 每轮最大可投票数，等于您的治理票数"})]}):(0,t.jsxs)("div",{className:"text-center mt-8",children:[(0,t.jsx)("div",{className:"text-base text-greyscale-500 mb-4",children:"还没有推举行动，请先推举！"}),(0,t.jsx)(m.z,{asChild:!0,children:(0,t.jsx)(N(),{href:"/vote/actions4submit?symbol=".concat(null==r?void 0:r.symbol),children:"去推举行动"})})]})})]}):(0,t.jsx)(g.Z,{})},_=function(){var e=(0,r.Bk)(),s=e.currentRound,n=e.isPending,i=e.error,o=(0,c.S)().handleContractError;return(0,a.useEffect)(function(){i&&o(i,"vote")},[i]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(l.Z,{title:"投票首页"}),(0,t.jsx)("main",{className:"flex-grow",children:n?(0,t.jsx)(g.Z,{}):(0,t.jsx)(w,{currentRound:s})})]})}},21803:function(e,s,n){"use strict";function t(e,s){let[n,t="0"]=e.split("."),a=n.startsWith("-");if(a&&(n=n.slice(1)),t=t.replace(/(0+)$/,""),0===s)1===Math.round(Number(`.${t}`))&&(n=`${BigInt(n)+1n}`),t="";else if(t.length>s){let[e,a,r]=[t.slice(0,s-1),t.slice(s-1,s),t.slice(s)],c=Math.round(Number(`${a}.${r}`));(t=c>9?`${BigInt(e)+BigInt(1)}0`.padStart(e.length+1,"0"):`${e}${c}`).length>s&&(t=t.slice(1),n=`${BigInt(n)+1n}`),t=t.slice(0,s)}else t=t.padEnd(s,"0");return BigInt(`${a?"-":""}${n}${t}`)}n.d(s,{v:function(){return t}})}},function(e){e.O(0,[8239,367,3494,2252,3950,2888,9774,179],function(){return e(e.s=75125)}),_N_E=e.O()}]);