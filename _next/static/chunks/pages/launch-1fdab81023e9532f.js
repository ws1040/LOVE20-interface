try{!function(){var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},s=(new e.Error).stack;s&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[s]="d505c106-7c46-4390-8022-649410664047",e._sentryDebugIdIdentifier="sentry-dbid-d505c106-7c46-4390-8022-649410664047")}()}catch(e){}(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[788],{68786:function(e,s,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/launch",function(){return n(10423)}])},10423:function(e,s,n){"use strict";n.r(s),n.d(s,{default:function(){return _}});var t=n(72253),a=n(14932),l=n(85893),r=n(67294),c=n(93778),i=n(70019),d=n(73591),o=n(83494),m=n(42083),u=n(91309),x=n(88504),h=n(37413),f=n(91529),j=n(64777),g=n(74089),v=function(e){var s=e.token,n=e.launchInfo,t=Number(n.totalContributed)/Number(n.parentTokenFundraisingGoal),a=(100*t).toFixed(1),c=(0,x.O)().data,i=(0,u._)((0,r.useState)(0),2),d=i[0],o=i[1],v=(0,u._)((0,r.useState)(0),2),N=v[0],b=v[1],p=Number("2868")||0;if((0,r.useEffect)(function(){if(c&&n&&t>=.5){var e=Number(n.secondHalfStartBlock)+Number(n.secondHalfMinBlocks)-Number(c);b(e>0?e:0)}},[c,n,t]),!n)return(0,l.jsx)("div",{className:"text-red-500",children:"找不到发射信息"});if(!s)return(0,l.jsx)(m.Z,{});var y="TKM20"==s.parentTokenSymbol?"TKM":s.parentTokenSymbol;return(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)("div",{className:"flex-col items-center mb-2 mt-4 px-4",children:[(0,l.jsxs)("div",{className:"flex items-center flex-wrap gap-2",children:[(0,l.jsx)("div",{className:"flex-shrink-0",children:(0,l.jsx)(j.Z,{title:"公平发射"})}),n.hasEnded&&(0,l.jsx)("span",{className:"stat-title text-base text-red-500",children:"（已结束）"}),!n.hasEnded&&t>=.5&&N>0&&(0,l.jsxs)("span",{className:"text-greyscale-500 text-sm",children:["(","距离结束还有"," ",(0,l.jsx)(g.Z,{initialTimeLeft:N>0?Math.ceil(N*p/1e3):0,onTick:o,forceShowSeconds:!0,fontClass:"text-greyscale-600"})," )"]})]}),(0,l.jsx)("div",{className:"stats w-full",children:(0,l.jsxs)("div",{className:"stat place-items-center p-2",children:[(0,l.jsx)("div",{className:"stat-title text-sm mr-6 ",children:"申购累计筹集到"}),(0,l.jsxs)("div",{className:"stat-value",children:[(0,l.jsx)("span",{className:"text-3xl text-secondary",children:(0,f.LH)(n.totalContributed)}),(0,l.jsx)("span",{className:"text-greyscale-500 font-normal text-sm ml-2",children:y})]}),(0,l.jsxs)("div",{className:"stats w-full grid grid-cols-2 divide-x-0",children:[(0,l.jsxs)("div",{className:"stat place-items-center pb-1 pl-0",children:[(0,l.jsxs)("div",{className:"stat-title text-sm",children:[(0,l.jsx)("span",{children:y}),"筹集目标"]}),(0,l.jsx)("div",{className:"stat-value text-xl",children:(0,f.LH)(n.parentTokenFundraisingGoal)})]}),(0,l.jsxs)("div",{className:"stat place-items-center pb-1 pl-0",children:[(0,l.jsxs)("div",{className:"stat-title text-sm",children:[(0,l.jsxs)("span",{children:[s.symbol," "]}),"发射总量"]}),(0,l.jsx)("div",{className:"stat-value text-xl",children:"".concat((0,f.LH)(BigInt(h.v.fairLaunch)))})]})]}),(0,l.jsxs)("div",{className:"text-center text-xs text-greyscale-500",children:["兑换比例：1 ",y," ="," ",(0,f.eb)((0,f.kP)((Number(h.v.fairLaunch)/Number(n.parentTokenFundraisingGoal)).toLocaleString("en-US",{maximumFractionDigits:2,minimumFractionDigits:2})))," ",s.symbol]}),(0,l.jsxs)("div",{className:"mt-2 rounded-lg text-sm",children:[(0,l.jsx)("p",{className:"mt-2 mb-1 font-medium",children:"发射结束条件："}),(0,l.jsxs)("p",{className:"text-greyscale-600",children:["1. 累计申购达到募资目标 100%",!n.hasEnded&&"（当前 ".concat(a,"%）")]}),(0,l.jsxs)("p",{className:"text-greyscale-600",children:["2. 最后一笔申购，距离首笔达成 50%募资目标的所在区块",!n.hasEnded&&t>=.5&&(N<=0?t>=1?"（第 ".concat(n.secondHalfStartBlock.toString(),"区块），至少").concat(n.secondHalfMinBlocks.toString(),"个区块（已满足条件，任意一笔新的申购将触发公平发射结束）"):"（第 ".concat(n.secondHalfStartBlock.toString(),"区块），至少").concat(n.secondHalfMinBlocks.toString(),"个区块（已满足条件）"):(0,l.jsxs)(l.Fragment,{children:["（第 ",n.secondHalfStartBlock.toString(),"区块），至少",n.secondHalfMinBlocks.toString(),"个区块（还需等待 ",Math.ceil(1e3*d/p),"个区块","）"]})),!n.hasEnded&&t<.5&&"，至少".concat(n.secondHalfMinBlocks.toString(),"个区块"),n.hasEnded&&"（第 ".concat(n.secondHalfStartBlock.toString(),"区块），至少").concat(n.secondHalfMinBlocks.toString(),"个区块")]})]})]})}),(0,l.jsxs)("div",{className:"bg-gray-100 text-greyscale-500 rounded-lg p-4 mt-4 text-sm",children:[(0,l.jsx)("p",{className:"mt-1 font-medium",children:"经济模型："}),(0,l.jsxs)("p",{children:["1. 代币总量：",(0,f.LH)(BigInt(h.v.totalSupply))]}),(0,l.jsxs)("p",{children:["2. 发射数量：",(0,f.LH)(BigInt(h.v.fairLaunch))," (10%)"]}),(0,l.jsxs)("p",{children:["3. 治理激励：",(0,f.LH)(BigInt(h.v.govRewards))," (45%)"]}),(0,l.jsxs)("p",{children:["4. 行动激励：",(0,f.LH)(BigInt(h.v.actionRewards))," (45%)"]}),(0,l.jsx)("p",{className:"mt-3 font-medium",children:"发射规则："}),(0,l.jsx)("p",{children:"1. 代币发放：按申购数量占比平均发放"}),(0,l.jsx)("p",{children:"2. 超过募集目标的父币，将按申购比例返还"})]})]})})},N=n(11010),b=n(97582),p=n(27245),y=n(42130),k=n(11163),w=n(41664),S=n.n(w),T=n(86501),B=n(37742),E=n(44576),I=function(e){var s,n=e.token;e.launchInfo;var t=(0,y.m)(),a=t.address,c=t.isConnected,o=(0,x.O)().data,u=(0,k.useRouter)(),h=(0,i.ap)(null==n?void 0:n.address,c?a:"0x0000000000000000000000000000000000000000"),g=h.contributed,v=h.isPending,w=h.error,I=h.refetch,C=(0,i.oz)(null==n?void 0:n.address,c?a:"0x0000000000000000000000000000000000000000"),H=C.lastContributedBlock,_=C.isPending,M=C.error,L=(0,B.Zu)("30126"),Z=H||BigInt(0),F=L-((o?BigInt(o):BigInt(0))-Z),P=(0,i.Qc)(),z=P.withdraw,K=P.isPending,D=P.writeError,O=P.isConfirming,R=P.isConfirmed,G=(s=(0,N._)(function(){return(0,b.Jh)(this,function(e){switch(e.label){case 0:return[4,z(null==n?void 0:n.address)];case 1:return e.sent(),[2]}})}),function(){return s.apply(this,arguments)});(0,r.useEffect)(function(){R&&(T.ZP.success("撤回成功"),I(),setTimeout(function(){u.push("/launch/?symbol=".concat(null==n?void 0:n.symbol))},1e3))},[R]);var J=(0,d.S)().handleContractError;if((0,r.useEffect)(function(){w&&J(w,"launch"),M&&J(M,"launch"),D&&J(D,"launch")},[w,M,D]),!n||v||_)return(0,l.jsx)(m.Z,{});var X="TKM20"==n.parentTokenSymbol?"TKM":n.parentTokenSymbol;return(0,l.jsxs)("div",{className:"px-6",children:[(0,l.jsx)(j.Z,{title:"参与申购"}),(0,l.jsx)("div",{className:"stats w-full",children:(0,l.jsxs)("div",{className:"stat place-items-center",children:[(0,l.jsx)("div",{className:"stat-title text-sm mr-6",children:"我的申购质押"}),(0,l.jsxs)("div",{className:"stat-value text-secondary",children:[(0,f.LH)(g||BigInt(0)),(0,l.jsx)("span",{className:"text-greyscale-500 font-normal text-sm ml-2",children:X})]})]})}),(0,l.jsxs)("div",{className:"flex justify-center -mx-2",children:[g&&g>BigInt(0)&&(0,l.jsx)(p.z,{variant:"outline",size:"sm",className:"w-1/2 text-secondary border-secondary mx-2",onClick:G,disabled:K||O||R,children:K?"提交中...":O?"确认中...":R?"已撤回":"撤回申购"}),(0,l.jsx)(p.z,{variant:"outline",size:"sm",className:"w-1/2 text-secondary border-secondary mx-2",asChild:!0,children:(0,l.jsx)(S(),{href:"/launch/contribute?symbol=".concat(null==n?void 0:n.symbol),children:g&&g>BigInt(0)?"增加申购":"去申购"})})]}),g&&g>BigInt(0)&&F>0&&(0,l.jsx)("div",{className:"mt-4 text-sm text-greyscale-500 text-center",children:(0,l.jsxs)("div",{children:["申购后需等 ","30126"," 个区块才能撤回（还需"," ",F>0?F.toString():"0"," 区块,大约"," ",(0,f.ZC)(Number(F)*Number("2868")/1e3),"）"]})}),(0,l.jsx)("div",{className:"border-t border-gray-200 mt-6 mb-6"}),(0,l.jsx)(E.Z,{isLoading:K||O,text:K?"提交交易...":"确认交易..."})]})},C=function(e){var s,n=e.token;e.launchInfo;var t=(0,y.m)().address,a=((0,r.useContext)(c.M)||{}).clearToken,o=(0,i.ap)(null==n?void 0:n.address,t),u=o.contributed,x=o.isPending,h=o.error,g=(0,i.r0)(null==n?void 0:n.address,t),v=g.receivedTokenAmount,k=g.extraRefund,w=g.isClaimed,B=g.isPending,I=g.error,C=(0,i.z7)(),H=C.claim,_=C.isPending,M=C.writeError,L=C.isConfirming,Z=C.isConfirmed,F=(s=(0,N._)(function(){return(0,b.Jh)(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,H(null==n?void 0:n.address)];case 1:case 2:return e.sent(),[3,3];case 3:return[2]}})}),function(){return s.apply(this,arguments)});(0,r.useEffect)(function(){Z?(T.ZP.success("领取成功"),null==a||a(),setTimeout(function(){window.location.reload()},1e3)):M&&T.ZP.error("领取失败")},[Z,M]);var P=(0,d.S)().handleContractError;if((0,r.useEffect)(function(){M&&P(M,"launch"),I&&P(I,"launch"),h&&P(h,"launch")},[M,I,h]),!t)return"";if(B||x||!n)return(0,l.jsx)(m.Z,{});var z="TKM20"==n.parentTokenSymbol?"TKM":n.parentTokenSymbol;return(0,l.jsxs)("div",{className:"px-4 mt-2",children:[(0,l.jsx)(j.Z,{title:"我的申购"}),(0,l.jsx)("div",{className:"stats w-full",children:(0,l.jsxs)("div",{className:"stat place-items-center",children:[(0,l.jsx)("div",{className:"stat-title text-sm mr-6",children:"共获得"}),(0,l.jsxs)("div",{className:"stat-value text-3xl text-secondary",children:[(0,f.LH)(null!=v?v:BigInt(0)),(0,l.jsx)("span",{className:"text-greyscale-500 font-normal text-sm ml-2",children:n.symbol})]})]})}),(0,l.jsxs)("div",{className:"flex justify-center space-x-4",children:[0>=Number(u)||!u&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(p.z,{className:"w-1/2",disabled:!0,children:"未申购"}),(0,l.jsx)(p.z,{className:"w-1/2",asChild:!0,children:(0,l.jsx)(S(),{href:"/launch/burn?symbol=".concat(null==n?void 0:n.symbol),children:"换回父币"})})]}),Number(u)>0&&!w&&(0,l.jsx)(p.z,{className:"w-1/2",onClick:F,disabled:_||L||Z,children:_?"领取中...":L?"确认中...":Z?"已领取":"领取"}),Number(u)>0&&w&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(p.z,{className:"w-1/2",disabled:!0,children:"已领取"}),(0,l.jsx)(p.z,{className:"w-1/2",asChild:!0,children:(0,l.jsx)(S(),{href:"/launch/burn?symbol=".concat(null==n?void 0:n.symbol),children:"换回父币"})})]})]}),Number(u)>0&&w&&(0,l.jsxs)("div",{className:"text-center text-sm my-2 text-greyscale-400",children:["我共申购了 ",(0,l.jsxs)("span",{className:"text-secondary",children:[(0,f.LH)(null!=u?u:BigInt(0))," "]}),z,"，申购返还了 ",(0,l.jsx)("span",{className:"text-secondary",children:(0,f.LH)(null!=k?k:BigInt(0))})," ",n.parentTokenSymbol,"TKM20"==n.parentTokenSymbol&&(0,l.jsxs)(S(),{href:"/dex/swap?from=".concat(n.parentTokenSymbol,"&to=").concat("TKM"),className:"text-secondary ml-1",children:["（转回 ","TKM","）"]})]}),(0,l.jsx)("div",{className:"border-t border-gray-200 mx-4 mt-4 mb-6"}),(0,l.jsx)(E.Z,{isLoading:_||L,text:_?"提交交易...":"确认交易..."})]})},H=n(66247);function _(){var e=(0,r.useContext)(c.M)||{token:null,setToken:null},s=e.token,n=e.setToken,u=(0,i.kF)(s?s.address:"0x0000000000000000000000000000000000000000"),x=u.launchInfo,h=u.isPending,f=u.error,j=(0,d.S)().handleContractError;return((0,r.useEffect)(function(){f&&j(f,"launch")},[f]),(0,r.useEffect)(function(){x&&s&&x.hasEnded&&!s.hasEnded&&n((0,a._)((0,t._)({},s),{hasEnded:!0}))},[x,s]),h||x)?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(o.Z,{title:"公平发射",showBackButton:(null==x?void 0:x.hasEnded)||!1}),(0,l.jsxs)("main",{className:"flex-grow",children:[(0,l.jsx)(H.Z,{}),h||!x?(0,l.jsx)(m.Z,{}):(0,l.jsxs)(l.Fragment,{children:[s&&(x.hasEnded?(0,l.jsx)(C,{token:s,launchInfo:x}):(0,l.jsx)(I,{token:s,launchInfo:x})),(0,l.jsx)(v,{token:s,launchInfo:x})]})]})]}):(0,l.jsx)("div",{className:"text-red-500",children:"找不到发射信息"})}}},function(e){e.O(0,[8239,367,246,6143,9443,3494,2252,6127,6202,7616,2888,9774,179],function(){return e(e.s=68786)}),_N_E=e.O()}]);