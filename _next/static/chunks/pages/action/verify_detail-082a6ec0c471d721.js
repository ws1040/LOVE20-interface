try{!function(){var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="face39e5-e2d4-4e18-85b2-992982435d78",e._sentryDebugIdIdentifier="sentry-dbid-face39e5-e2d4-4e18-85b2-992982435d78")}()}catch(e){}(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3295],{56223:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/action/verify_detail",function(){return s(78886)}])},78886:function(e,t,s){"use strict";s.r(t);var n=s(72253),i=s(14932),r=s(91309),d=s(85893),a=s(67294),l=s(11163),c=s(42130),o=s(36893),x=s(93950),u=s(73591),m=s(83494),h=s(42083),p=s(11418),f=s(27460),g=s(90963),j=s(64777),b=s(93778),v=s(91529);t.default=function(){var e=(0,l.useRouter)(),t=e.query,s=t.id,N=t.round,y=s?BigInt(s):void 0,w=N?BigInt(N):void 0,I=(0,c.m)().address,k=((0,a.useContext)(b.M)||{}).token,_=(0,r._)((0,a.useState)(BigInt(0)),2),W=_[0],B=_[1],A=(0,o.r)({tokenAddress:null==k?void 0:k.address,actionId:y,account:I}),S=A.actionInfo,z=A.participantCount,T=A.totalAmount,C=A.userJoinedAmount,E=A.isJoined,Z=A.isPending,D=A.error,L=A.currentRound;(0,a.useEffect)(function(){w?B(w):k&&L&&L-BigInt(k.initialStakeRound)>=BigInt(2)&&B(L-BigInt(2))},[w,L,k]);var P=(0,x.Aw)((null==k?void 0:k.address)||"0x",W||BigInt(0),y||BigInt(0)),R=P.verificationMatrix,F=P.isPending,H=P.error,J=function(t){B(BigInt(t)),e.push({pathname:e.pathname,query:(0,i._)((0,n._)({},e.query),{round:t.toString()})},void 0,{shallow:!0})},q=(0,u.S)().handleContractError;return((0,a.useEffect)(function(){D&&q(D,"verify_detail"),H&&q(H,"verify_detail_matrix")},[D,H]),void 0===y)?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(m.Z,{title:"验证详情",showBackButton:!0}),(0,d.jsx)("main",{className:"flex-grow",children:(0,d.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,d.jsx)("div",{className:"text-center text-red-500",children:"参数错误：缺少行动ID参数"})})})]}):(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(m.Z,{title:"验证详情",showBackButton:!0}),(0,d.jsxs)("div",{className:"flex-grow",children:[(0,d.jsx)("div",{className:"px-4 pt-0 pb-3",children:S&&(0,d.jsx)(p.Z,{actionInfo:S,participantCount:z,totalAmount:T,isJoined:E,userJoinedAmount:C,isPending:Z,showActionButtons:!1,linkToActionInfo:!0})}),Z?(0,d.jsx)("div",{className:"px-4",children:(0,d.jsx)("div",{className:"bg-white rounded-lg p-8",children:(0,d.jsxs)("div",{className:"text-center",children:[(0,d.jsx)(h.Z,{}),(0,d.jsx)("p",{className:"mt-4 text-gray-600",children:"加载数据中..."})]})})}):D?(0,d.jsx)("div",{className:"px-4",children:(0,d.jsx)("div",{className:"bg-white rounded-lg p-8",children:(0,d.jsxs)("div",{className:"text-center text-red-500",children:["加载失败：",D.message||"获取行动信息失败，请稍后重试"]})})}):S?function(){if(F)return(0,d.jsx)("div",{className:"bg-white rounded-lg p-8",children:(0,d.jsxs)("div",{className:"text-center",children:[(0,d.jsx)(h.Z,{}),(0,d.jsx)("p",{className:"mt-4 text-gray-600",children:"加载验证矩阵中..."})]})});if(H)return(0,d.jsx)("div",{className:"bg-white rounded-lg p-8",children:(0,d.jsxs)("div",{className:"text-center text-red-500",children:["加载验证矩阵失败：",H.message||"获取验证矩阵失败，请稍后重试"]})});if(!R||0===R.verifiers.length)return(0,d.jsx)("div",{className:"bg-white rounded-lg p-8",children:(0,d.jsx)("div",{className:"text-center text-gray-600",children:"暂无验证数据"})});var e=R.verifiers,t=R.verifiees,s=R.scores,n=e.map(function(e,n){return t.reduce(function(e,t,i){var r,d=null===(r=s[n])||void 0===r?void 0:r[i];return e+(void 0!==d?Number(d):0)},0)}),i=e.map(function(e,t){return t}).sort(function(e,t){return n[t]-n[e]}),r=function(e,t){var i,r=null===(i=s[e])||void 0===i?void 0:i[t],d=n[e];if(void 0===r||0===d)return"0%";var a=Number(r)/d*100;return"".concat((0,v.rl)(a))};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("div",{className:"bg-white rounded-lg mx-4 mb-4",children:(0,d.jsx)("div",{className:"px-4 ",children:(0,d.jsx)("div",{className:"flex items-center justify-between",children:(0,d.jsx)("div",{className:"flex items-center",children:W>0&&(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(j.Z,{title:"第 ".concat(W.toString()," 轮验证明细")}),(0,d.jsx)("span",{className:"text-sm text-greyscale-500 ml-2",children:"("}),(0,d.jsx)(g.Z,{currentRound:k&&L?(0,v.cK)(L-BigInt(2),k):BigInt(0),handleChangedRound:J}),(0,d.jsx)("span",{className:"text-sm text-greyscale-500",children:")"})]})})})})}),(0,d.jsx)("div",{className:"w-full max-w-full overflow-hidden px-4",children:(0,d.jsx)("div",{className:"overflow-x-auto bg-white max-w-full table-container-webview",children:(0,d.jsxs)("table",{className:"w-full min-w-[800px]",style:{tableLayout:"fixed"},children:[(0,d.jsx)("thead",{children:(0,d.jsxs)("tr",{children:[(0,d.jsx)("th",{className:"border border-gray-300 p-2 bg-gray-50 sticky left-0 z-20",style:{WebkitTextSizeAdjust:"100%",width:"102px",minWidth:"102px"},children:(0,d.jsx)("div",{className:"text-gray-600 mb-1 whitespace-nowrap",style:{fontSize:"12px"},children:"验证者\xa0\xa0\\\xa0\xa0行动参与者"})}),t.map(function(e,t){return(0,d.jsx)("th",{className:"border border-gray-300 p-1 bg-gray-50",style:{WebkitTextSizeAdjust:"100%",width:"100px",minWidth:"100px",maxWidth:"100px"},children:(0,d.jsx)("div",{children:"0x0000000000000000000000000000000000000000"===e?(0,d.jsx)("span",{className:"text-sm text-gray-700 font-medium",children:"弃权票"}):(0,d.jsx)(f.Z,{address:e,colorClassName:"text-gray-700"})})},"verifiee-".concat(t))}),(0,d.jsx)("th",{className:"border border-gray-300 p-1 bg-gray-50",style:{WebkitTextSizeAdjust:"100%",width:"102px",minWidth:"102px",maxWidth:"102px"},children:(0,d.jsx)("div",{className:"text-gray-600 text-sm font-medium",children:"总票数"})})]})}),(0,d.jsxs)("tbody",{children:[i.map(function(i,a){var l=e[i];return(0,d.jsxs)("tr",{children:[(0,d.jsx)("td",{className:"border border-gray-300 p-2 bg-gray-50 sticky left-0 z-10",style:{WebkitTextSizeAdjust:"100%",width:"100px",minWidth:"100px"},children:(0,d.jsx)("div",{style:{fontSize:"12px"},children:(0,d.jsx)(f.Z,{address:l,colorClassName:"text-gray-700"})})}),t.map(function(e,t){var n;return(0,d.jsx)("td",{className:"border border-gray-300 p-1 text-center",style:{WebkitTextSizeAdjust:"100%",width:"100px",minWidth:"100px"},children:(null===(n=s[i])||void 0===n?void 0:n[t])!==void 0?(0,d.jsxs)("div",{children:[(0,d.jsx)("span",{className:"text-sm font-mono whitespace-nowrap",children:(0,v.LH)(s[i][t])}),(0,d.jsxs)("span",{className:"text-gray-500",children:["(",r(i,t),")"]})]}):(0,d.jsx)("span",{className:"font-mono whitespace-nowrap",style:{fontSize:"14px"},children:"-"})},"score-".concat(i,"-").concat(t))}),(0,d.jsx)("td",{className:"border border-gray-300 p-1 text-center bg-blue-50",style:{WebkitTextSizeAdjust:"100%",width:"100px",minWidth:"100px",maxWidth:"100px"},children:(0,d.jsx)("span",{className:"text-sm font-mono font-bold text-blue-600",children:(0,v.LH)(BigInt(n[i]))})})]},"verifier-".concat(i))}),(0,d.jsxs)("tr",{className:"",children:[(0,d.jsx)("td",{className:"border border-gray-300 p-2 bg-blue-50 sticky left-0 z-10 font-bold",style:{WebkitTextSizeAdjust:"100%",width:"100px",minWidth:"100px"},children:(0,d.jsxs)("div",{className:"text-center text-sm text-blue-600",children:["汇总 (",e.length," 个验证者)"]})}),t.map(function(t,i){var r=e.reduce(function(e,t,n){var r,d=null===(r=s[n])||void 0===r?void 0:r[i];return e+(void 0!==d?Number(d):0)},0),a=n.reduce(function(e,t){return e+t},0);return(0,d.jsx)("td",{className:"border border-gray-300 p-1 text-center bg-blue-50",style:{WebkitTextSizeAdjust:"100%",width:"100px",minWidth:"100px"},children:(0,d.jsxs)("div",{children:[(0,d.jsx)("span",{className:"text-sm font-mono font-bold text-blue-600 whitespace-nowrap",children:(0,v.LH)(BigInt(r))}),(0,d.jsxs)("span",{className:"text-blue-500",children:["(",(0,v.rl)(a>0?r/a*100:0),")"]})]})},"summary-".concat(i))}),(0,d.jsx)("td",{className:"border border-gray-300 p-1 text-center bg-blue-50",style:{WebkitTextSizeAdjust:"100%",width:"100px",minWidth:"100px",maxWidth:"100px"},children:(0,d.jsx)("span",{className:"text-sm font-mono font-bold text-blue-600",children:(0,v.LH)(BigInt(n.reduce(function(e,t){return e+t},0)))})})]})]})]})})}),(0,d.jsx)("div",{className:"bg-white mx-4 mt-4 rounded-lg",children:(0,d.jsx)("div",{className:"px-4 py-3 text-xs text-gray-500",children:(0,d.jsx)("p",{className:"md:hidden text-blue-600",children:"• 手机端请左右滑动表格查看完整内容"})})})]})}():(0,d.jsx)("div",{className:"px-4",children:(0,d.jsx)("div",{className:"bg-white rounded-lg p-8",children:(0,d.jsx)("div",{className:"text-center text-yellow-600",children:"行动不存在：找不到指定的行动信息"})})})]})]})}}},function(e){e.O(0,[8239,367,6143,3494,2252,3950,7724,4139,2888,9774,179],function(){return e(e.s=56223)}),_N_E=e.O()}]);