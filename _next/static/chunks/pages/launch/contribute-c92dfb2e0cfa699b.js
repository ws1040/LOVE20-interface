(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1109],{18449:(e,n,t)=>{"use strict";t.d(n,{X:()=>a});var s=t(76200);class r extends s.C{constructor({value:e}){super(`Number \`${e}\` is not a valid decimal number.`,{name:"InvalidDecimalNumberError"})}}function a(e,n){if(!/^(-?)([0-9]*)\.?([0-9]*)$/.test(e))throw new r({value:e});let[t,s="0"]=e.split("."),a=t.startsWith("-");if(a&&(t=t.slice(1)),s=s.replace(/(0+)$/,""),0===n)1===Math.round(Number(`.${s}`))&&(t=`${BigInt(t)+1n}`),s="";else if(s.length>n){let[e,r,a]=[s.slice(0,n-1),s.slice(n-1,n),s.slice(n)],i=Math.round(Number(`${r}.${a}`));(s=i>9?`${BigInt(e)+BigInt(1)}0`.padStart(e.length+1,"0"):`${e}${i}`).length>n&&(s=s.slice(1),t=`${BigInt(t)+1n}`),s=s.slice(0,n)}else s=s.padEnd(n,"0");return BigInt(`${a?"-":""}${t}${s}`)}},42038:(e,n,t)=>{"use strict";t.d(n,{z:()=>i});var s=t(97685),r=t(99090),a=t(99742),i=e=>{var n,t=(()=>{var e,n,t=null==(n=r.$.chains)||null==(e=n[0])?void 0:e.id;if("number"==typeof t)return t;var s=Number(a.env.NEXT_PUBLIC_CHAIN_ID);return Number.isFinite(s)?s:void 0})();return!!e&&!!t&&e===t||(s.oR.error("请先将钱包链接 ".concat(null!=(n=a.env.NEXT_PUBLIC_CHAIN_NAME)?n:a.env.NEXT_PUBLIC_CHAIN)),!1)}},63346:(e,n,t)=>{"use strict";t.d(n,{D:()=>u,E:()=>c});var s=t(16927),r=t(4902),a=t(14232),i=t(38967),d=t(92165),o=[{type:"constructor",inputs:[],stateMutability:"nonpayable"},{type:"function",name:"WETHAddress",inputs:[],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"contributeFirstTokenWithETH",inputs:[{name:"tokenAddress",type:"address",internalType:"address"},{name:"to",type:"address",internalType:"address"}],outputs:[],stateMutability:"payable"},{type:"function",name:"init",inputs:[{name:"WETHAddress_",type:"address",internalType:"address"},{name:"launchAddress_",type:"address",internalType:"address"},{name:"stakeAddress_",type:"address",internalType:"address"},{name:"submitAddress_",type:"address",internalType:"address"},{name:"voteAddress_",type:"address",internalType:"address"},{name:"joinAddress_",type:"address",internalType:"address"},{name:"verifyAddress_",type:"address",internalType:"address"},{name:"mintAddress_",type:"address",internalType:"address"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"initialized",inputs:[],outputs:[{name:"",type:"bool",internalType:"bool"}],stateMutability:"view"},{type:"function",name:"joinAddress",inputs:[],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"launchAddress",inputs:[],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"mintAddress",inputs:[],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"stakeAddress",inputs:[],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"stakeLiquidity",inputs:[{name:"tokenAddress",type:"address",internalType:"address"},{name:"tokenAmount",type:"uint256",internalType:"uint256"},{name:"parentTokenAmount",type:"uint256",internalType:"uint256"},{name:"tokenAmountMin",type:"uint256",internalType:"uint256"},{name:"parentTokenAmountMin",type:"uint256",internalType:"uint256"},{name:"promisedWaitingPhases",type:"uint256",internalType:"uint256"},{name:"to",type:"address",internalType:"address"}],outputs:[{name:"govVotesAdded",type:"uint256",internalType:"uint256"},{name:"slAmountAdded",type:"uint256",internalType:"uint256"}],stateMutability:"nonpayable"},{type:"function",name:"submitAddress",inputs:[],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"verifyAddress",inputs:[],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"voteAddress",inputs:[],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"event",name:"ContributeFirstTokenWithETH",inputs:[{name:"tokenAddress",type:"address",indexed:!0,internalType:"address"},{name:"to",type:"address",indexed:!0,internalType:"address"},{name:"amount",type:"uint256",indexed:!1,internalType:"uint256"}],anonymous:!1},{type:"event",name:"StakeLiquidity",inputs:[{name:"tokenAddress",type:"address",indexed:!0,internalType:"address"},{name:"to",type:"address",indexed:!0,internalType:"address"},{name:"tokenAmountDesired",type:"uint256",indexed:!1,internalType:"uint256"},{name:"parentTokenAmountDesired",type:"uint256",indexed:!1,internalType:"uint256"},{name:"tokenAmountReal",type:"uint256",indexed:!1,internalType:"uint256"},{name:"parentTokenAmountReal",type:"uint256",indexed:!1,internalType:"uint256"},{name:"promisedWaitingPhases",type:"uint256",indexed:!1,internalType:"uint256"}],anonymous:!1}],l=t(99742).env.NEXT_PUBLIC_CONTRACT_ADDRESS_PERIPHERAL_HUB;function u(){var e=(0,i.VR)(o,l,"contributeFirstTokenWithETH"),n=e.execute,t=e.isPending,u=e.isConfirming,c=e.isConfirmed,m=e.error,p=e.hash,y=e.isTukeMode;return(0,a.useEffect)(()=>{p&&console.log("contributeFirstTokenWithETH tx hash:",p),m&&(console.log("提交contributeWithETH交易错误:"),(0,d.YN)(m),(0,d.vV)(m))},[p,m]),{contribute:(e,t,a)=>(0,s._)(function(){return(0,r.YH)(this,function(s){switch(s.label){case 0:return console.log("提交contributeWithETH交易:",{tokenAddress:e,to:t,ethAmount:a,isTukeMode:y}),[4,n([e,t],a)];case 1:return[2,s.sent()]}})})(),isPending:t,isConfirming:u,writeError:m,isConfirmed:c,hash:p,isTukeMode:y}}function c(){var e=(0,i.VR)(o,l,"stakeLiquidity"),n=e.execute,t=e.isPending,u=e.isConfirming,c=e.isConfirmed,m=e.error,p=e.hash,y=e.isTukeMode;return(0,a.useEffect)(()=>{p&&console.log("stakeLiquidity tx hash:",p),m&&(console.log("提交stakeLiquidity交易错误:"),(0,d.YN)(m),(0,d.vV)(m))},[p,m]),{stakeLiquidity:(e,t,a,i,d,o,l)=>(0,s._)(function(){return(0,r.YH)(this,function(s){switch(s.label){case 0:return console.log("提交stakeLiquidity交易:",{tokenAddress:e,tokenAmount:t,parentTokenAmount:a,tokenAmountMin:i,parentTokenAmountMin:d,promisedWaitingPhases:o,to:l,isTukeMode:y}),[4,n([e,t,a,i,d,o,l])];case 1:return[2,s.sent()]}})})(),isPending:t,isConfirming:u,isConfirmed:c,writeError:m,hash:p,isTukeMode:y}}},63822:(e,n,t)=>{"use strict";t.r(n),t.d(n,{default:()=>X});var s=t(37876),r=t(14232),a=t(83416),i=t(40752),d=t(4113),o=t(60154),l=t(12293),u=t(16927),c=t(3576),m=t(62701),p=t(40854),y=t(4902),f=t(89099),v=t(22442),x=t(13810),h=t(88992),T=t(48230),b=t.n(T),N=t(8047),_=t(1081),A=t(57238),g=t(97685),E=t(6960),k=t(77932),C=t(92659),j=t(42038),w=t(20442),I=t(63346),S=t(9215),R=t(25239),P=t(1709),M=t(99574),L=t(7446),F=t(99742);let B=e=>{var n=e.token;e.launchInfo;var t=(0,N.F)(),a=t.address,o=t.isConnected,T=(0,_.i)(),B=(0,f.useRouter)(),X=(null==n?void 0:n.parentTokenSymbol)==F.env.NEXT_PUBLIC_FIRST_PARENT_TOKEN_SYMBOL,$=X?F.env.NEXT_PUBLIC_NATIVE_TOKEN_SYMBOL:(null==n?void 0:n.parentTokenSymbol)||"",H=(0,A.A)({address:a,query:{enabled:X}}),D=H.data,O=H.isLoading,U=H.error,W=(0,S.lW)(null==n?void 0:n.parentTokenAddress,a,!X),V=W.balance,Y=W.isPending,q=W.error,z=X?(null==D?void 0:D.value)||0n:V||0n,J=X?O:Y,K=(0,i.$r)(null==n?void 0:n.address,a),G=K.contributed,Q=K.isPending,Z=K.error,ee=!!F.env.NEXT_PUBLIC_TOKEN_PREFIX,en=ee&&X,et=(0,w.XS)("0.001");console.log("hasTestPrefix",ee),console.log("isLimitActive",en),console.log("maxAllowedForFirstParent",et);var es=(0,h.mN)({resolver:(0,x.u)(((e,n,t)=>v.Ik({contributeAmount:v.Yj().nonempty({message:"请输入申购数量"}).refine(e=>Number(e)>0,{message:"申购数量不能为 0"}).refine(n=>{var t;return(null!=(t=(0,w.XS)(n))?t:0n)<=e},{message:"申购数量不能超过余额 (".concat((0,w.Js)(e),")")}).refine(e=>{var t;return!n||(null!=(t=(0,w.XS)(e))?t:0n)<=n},{message:"测试环境限制：首个父币最多可申购 ".concat(null!=t?t:"0.001")})}))(z,en?et:void 0,"0.001")),defaultValues:{contributeAmount:""},mode:"onChange",reValidateMode:"onChange"}),er=(0,S.zH)(null==n?void 0:n.parentTokenAddress),ea=er.approve,ei=er.isPending,ed=er.isConfirming,eo=er.isConfirmed,el=er.writeError,eu=(0,p._)((0,r.useState)(!1),2),ec=eu[0],em=eu[1],ep=(0,S.Gp)(null==n?void 0:n.parentTokenAddress,a,F.env.NEXT_PUBLIC_CONTRACT_ADDRESS_LAUNCH,!X),ey=ep.allowance,ef=ep.isPending,ev=ep.error;(0,r.useEffect)(()=>{eo&&!X&&(em(!0),g.oR.success("授权".concat(null==n?void 0:n.parentTokenSymbol,"成功")))},[eo,null==n?void 0:n.parentTokenSymbol,X]);var ex=es.watch("contributeAmount");(0,r.useEffect)(()=>{if(X)return void em(!0);var e,n=null!=(e=(0,w.XS)(ex))?e:0n;n>0n&&ey&&ey>0n&&ey>=n?em(!0):em(!1)},[ex,ey,X]);var eh=(0,I.D)(),eT=eh.contribute,eb=eh.isPending,eN=eh.isConfirming,e_=eh.isConfirmed,eA=eh.writeError,eg=(0,i.LO)(),eE=eg.contribute,ek=eg.isPending,eC=eg.isConfirming,ej=eg.isConfirmed,ew=eg.writeError,eI=X?eb:ek,eS=X?eN:eC,eR=X?e_:ej,eP=e=>(0,u._)(function(){var t,s;return(0,y.YH)(this,function(r){switch(r.label){case 0:if(!(0,j.z)(T))return[2];if(!X&&!ec)return g.oR.error("请先授权"),[2];r.label=1;case 1:if(r.trys.push([1,6,,7]),s=null!=(t=(0,w.XS)(e.contributeAmount))?t:0n,en&&s>et)return(0,g.oR)("测试环境限制：首个父币最多可申购 0.001"),[2];if(!X)return[3,3];return[4,eT(null==n?void 0:n.address,a,s)];case 2:return r.sent(),[3,5];case 3:return[4,eE(null==n?void 0:n.address,s,a)];case 4:r.sent(),r.label=5;case 5:return[3,7];case 6:return console.error(r.sent()),[3,7];case 7:return[2]}})})();(0,r.useEffect)(()=>{eR&&(g.oR.success("申购成功"),setTimeout(()=>{B.push("/launch?symbol=".concat(null==n?void 0:n.symbol))},2e3))},[eR,B,null==n?void 0:n.symbol]);var eM=(0,R.q)().setError;(0,r.useEffect)(()=>{o&&!J&&void 0!==z&&z<=0n&&eM({name:"余额不足",message:"请先获取 ".concat($,"，再来申购")})},[z,eM,o,J,$]);var eL=(0,d.g)().handleContractError;(0,r.useEffect)(()=>{var e=X?eA:ew,n=X?U:q;e&&eL(e,"launch"),Z&&eL(Z,"launch"),n&&eL(n,X?"balance":"token"),!X&&(el&&eL(el,"token"),ev&&eL(ev,"token"))},[eA,ew,Z,U,q,el,ev,eL,X]);var eF=ei||ed,eB=(0,r.useRef)(null);return((0,r.useEffect)(()=>{!ef&&eB.current&&eB.current.blur()},[ef]),o)?!n||J||Q?(0,s.jsx)(l.A,{}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"px-4 mt-2",children:[(0,s.jsx)(P.A,{title:"参与申购"}),(0,s.jsx)("div",{className:"stats w-full",children:(0,s.jsxs)("div",{className:"stat place-items-center",children:[(0,s.jsx)("div",{className:"stat-title text-sm mr-6",children:"我已申购质押"}),(0,s.jsxs)("div",{className:"stat-value text-secondary",children:[(0,w.NJ)(G||0n),(0,s.jsx)("span",{className:"text-greyscale-500 font-normal text-sm ml-2",children:$})]})]})}),(0,s.jsx)(C.lV,(0,m._)((0,c._)({},es),{children:(0,s.jsxs)("form",{onSubmit:e=>e.preventDefault(),className:"space-y-4",children:[(0,s.jsx)(C.zB,{control:es.control,name:"contributeAmount",render:e=>{var n=e.field;return(0,s.jsxs)(C.eI,{children:[(0,s.jsx)(C.lR,{children:"申购数量："}),(0,s.jsx)(C.MJ,{children:(0,s.jsx)(k.p,(0,c._)({type:"number",max:en?.001:void 0,placeholder:"请填写".concat($,"数量"),disabled:!X&&eF||z<=0n,className:"!ring-secondary-foreground"},n))}),(0,s.jsx)(C.C5,{}),en&&(0,s.jsx)("div",{className:"text-xs text-greyscale-400 mt-1",children:"测试环境限制：首个父币最多可申购 0.001"})]})}}),(0,s.jsxs)("div",{className:"flex items-center text-sm mb-4",children:[(0,s.jsxs)("span",{className:"text-greyscale-400",children:[(0,w.NJ)(z)," ",$]}),(0,s.jsx)(E.$,{variant:"link",size:"sm",onClick:()=>{if(en){var e=z>et?et:z;es.setValue("contributeAmount",(0,w.Js)(e))}else es.setValue("contributeAmount",(0,w.Js)(z))},disabled:!X&&eF||z<=0n,className:"text-secondary",children:"全部"}),!X&&(null==n?void 0:n.parentTokenSymbol)===F.env.NEXT_PUBLIC_FIRST_PARENT_TOKEN_SYMBOL&&(0,s.jsx)(b(),{href:"/dex/deposit?symbol=".concat(n.symbol),children:(0,s.jsxs)(E.$,{variant:"link",size:"sm",className:"text-secondary",children:["获取",n.parentTokenSymbol]})})]}),(0,s.jsx)("div",{className:"flex justify-center",children:X?(0,s.jsx)(E.$,{className:"w-full text-white py-2 rounded-lg",onClick:es.handleSubmit(eP),disabled:eI||eS||eR||z<=0n,children:eI?"申购中...":eS?"确认中...":eR?"申购成功":"申购"}):(0,s.jsxs)("div",{className:"flex space-x-4 w-full",children:[(0,s.jsx)(E.$,{ref:eB,className:"w-1/2",onClick:es.handleSubmit(e=>(0,u._)(function(){var n,t;return(0,y.YH)(this,function(s){switch(s.label){case 0:if(!(0,j.z)(T))return[2];s.label=1;case 1:return s.trys.push([1,3,,4]),t=null!=(n=(0,w.XS)(e.contributeAmount))?n:0n,[4,ea(F.env.NEXT_PUBLIC_CONTRACT_ADDRESS_LAUNCH,t)];case 2:return s.sent(),[3,4];case 3:return console.error(s.sent()),[3,4];case 4:return[2]}})})()),disabled:ef||ei||ed||ec,children:ef?(0,s.jsx)(L.A,{className:"animate-spin"}):ei?"1.提交中...":ed?"1.确认中...":ec?"1.".concat(null==n?void 0:n.parentTokenSymbol,"已授权"):"1.授权".concat(null==n?void 0:n.parentTokenSymbol)}),(0,s.jsx)(E.$,{className:"w-1/2 text-white py-2 rounded-lg",onClick:es.handleSubmit(eP),disabled:!ec||eI||eS||eR,children:eI?"2.申购中...":eS?"2.确认中...":eR?"2.申购成功":"2.申购"})]})})]})}))]}),(0,s.jsx)(M.A,{isLoading:eI||eS||!X&&(ei||ed),text:eI||!X&&ei?"提交交易...":"确认交易..."})]}):(0,s.jsx)("div",{className:"flex flex-col items-center p-4 mt-4",children:(0,s.jsx)("div",{className:"text-center mb-4 text-greyscale-500",children:"没有链接钱包，请先连接钱包"})})};function X(){var e=((0,r.useContext)(a.N)||{}).token,n=(0,i.TU)(e?e.address:"0x0000000000000000000000000000000000000000"),t=n.launchInfo,u=n.isPending,c=n.error,m=(0,d.g)().handleContractError;return(0,r.useEffect)(()=>{c&&m(c,"launch")},[c]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(o.A,{title:"申购"}),(0,s.jsx)("main",{className:"flex-grow",children:u?(0,s.jsx)(l.A,{}):t?(0,s.jsx)(B,{token:e,launchInfo:t}):(0,s.jsx)("div",{className:"text-red-500",children:"找不到发射信息"})})]})}},92659:(e,n,t)=>{"use strict";t.d(n,{lV:()=>v,MJ:()=>A,Rr:()=>g,zB:()=>h,eI:()=>N,lR:()=>_,C5:()=>E});var s=t(81110),r=t(40120),a=t(3576),i=t(62701),d=t(65699),o=t(37876),l=t(14232),u=t(82987),c=t(88992),m=t(30684),p=t(59773),y=(0,t(47137).F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),f=l.forwardRef((e,n)=>{var t=e.className,s=(0,d._)(e,["className"]);return(0,o.jsx)(p.b,(0,a._)({ref:n,className:(0,m.cn)(y(),t)},s))});f.displayName=p.b.displayName;var v=c.Op,x=l.createContext({}),h=e=>{var n=(0,s._)({},(0,r._)(e));return(0,o.jsx)(x.Provider,{value:{name:n.name},children:(0,o.jsx)(c.xI,(0,a._)({},n))})},T=()=>{var e=l.useContext(x),n=l.useContext(b),t=(0,c.xW)(),s=t.getFieldState,r=t.formState,i=s(e.name,r);if(!e)throw Error("useFormField should be used within <FormField>");var d=n.id;return(0,a._)({id:d,name:e.name,formItemId:"".concat(d,"-form-item"),formDescriptionId:"".concat(d,"-form-item-description"),formMessageId:"".concat(d,"-form-item-message")},i)},b=l.createContext({}),N=l.forwardRef((e,n)=>{var t=e.className,s=(0,d._)(e,["className"]),r=l.useId();return(0,o.jsx)(b.Provider,{value:{id:r},children:(0,o.jsx)("div",(0,a._)({ref:n,className:(0,m.cn)("space-y-2",t)},s))})});N.displayName="FormItem";var _=l.forwardRef((e,n)=>{var t=e.className,s=(0,d._)(e,["className"]),r=T(),i=r.error,l=r.formItemId;return(0,o.jsx)(f,(0,a._)({ref:n,className:(0,m.cn)(i&&"text-destructive",t),htmlFor:l},s))});_.displayName="FormLabel";var A=l.forwardRef((e,n)=>{var t=(0,s._)({},(0,r._)(e)),i=T(),d=i.error,l=i.formItemId,c=i.formDescriptionId,m=i.formMessageId;return(0,o.jsx)(u.DX,(0,a._)({ref:n,id:l,"aria-describedby":d?"".concat(c," ").concat(m):"".concat(c),"aria-invalid":!!d},t))});A.displayName="FormControl";var g=l.forwardRef((e,n)=>{var t=e.className,s=(0,d._)(e,["className"]),r=T().formDescriptionId;return(0,o.jsx)("p",(0,a._)({ref:n,id:r,className:(0,m.cn)("text-sm text-muted-foreground",t)},s))});g.displayName="FormDescription";var E=l.forwardRef((e,n)=>{var t=e.className,s=e.children,r=(0,d._)(e,["className","children"]),l=T(),u=l.error,c=l.formMessageId,p=u?String(null==u?void 0:u.message):s;return p?(0,o.jsx)("p",(0,i._)((0,a._)({ref:n,id:c,className:(0,m.cn)("text-sm font-medium text-destructive",t)},r),{children:p})):null});E.displayName="FormMessage"},94004:(e,n,t)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/launch/contribute",function(){return t(63822)}])}},e=>{e.O(0,[3308,7460,8230,9985,154,5498,5139,3356,636,6593,8792],()=>e(e.s=94004)),_N_E=e.O()}]);