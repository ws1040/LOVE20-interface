try{!function(){var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="565858e7-34a4-4f08-a95e-465fae426e4b",e._sentryDebugIdIdentifier="sentry-dbid-565858e7-34a4-4f08-a95e-465fae426e4b")}()}catch(e){}(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8251],{58862:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/launch/contribute",function(){return t(29770)}])},83149:function(e,n,t){"use strict";t.d(n,{l0:function(){return v},NI:function(){return k},pf:function(){return A},Wi:function(){return x},xJ:function(){return T},lX:function(){return N},zG:function(){return j}});var s=t(34788),r=t(12796),i=t(72253),a=t(14932),d=t(47702),o=t(85893),u=t(67294),l=t(88426),c=t(87536),m=t(80513),p=t(49102),f=(0,t(12003).j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),y=u.forwardRef(function(e,n){var t=e.className,s=(0,d._)(e,["className"]);return(0,o.jsx)(p.f,(0,i._)({ref:n,className:(0,m.cn)(f(),t)},s))});y.displayName=p.f.displayName;var v=c.RV,h=u.createContext({}),x=function(e){var n=(0,s._)({},(0,r._)(e));return(0,o.jsx)(h.Provider,{value:{name:n.name},children:(0,o.jsx)(c.Qr,(0,i._)({},n))})},b=function(){var e=u.useContext(h),n=u.useContext(g),t=(0,c.Gc)(),s=t.getFieldState,r=t.formState,a=s(e.name,r);if(!e)throw Error("useFormField should be used within <FormField>");var d=n.id;return(0,i._)({id:d,name:e.name,formItemId:"".concat(d,"-form-item"),formDescriptionId:"".concat(d,"-form-item-description"),formMessageId:"".concat(d,"-form-item-message")},a)},g=u.createContext({}),T=u.forwardRef(function(e,n){var t=e.className,s=(0,d._)(e,["className"]),r=u.useId();return(0,o.jsx)(g.Provider,{value:{id:r},children:(0,o.jsx)("div",(0,i._)({ref:n,className:(0,m.cn)("space-y-2",t)},s))})});T.displayName="FormItem";var N=u.forwardRef(function(e,n){var t=e.className,s=(0,d._)(e,["className"]),r=b(),a=r.error,u=r.formItemId;return(0,o.jsx)(y,(0,i._)({ref:n,className:(0,m.cn)(a&&"text-destructive",t),htmlFor:u},s))});N.displayName="FormLabel";var k=u.forwardRef(function(e,n){var t=(0,s._)({},(0,r._)(e)),a=b(),d=a.error,u=a.formItemId,c=a.formDescriptionId,m=a.formMessageId;return(0,o.jsx)(l.g7,(0,i._)({ref:n,id:u,"aria-describedby":d?"".concat(c," ").concat(m):"".concat(c),"aria-invalid":!!d},t))});k.displayName="FormControl";var A=u.forwardRef(function(e,n){var t=e.className,s=(0,d._)(e,["className"]),r=b().formDescriptionId;return(0,o.jsx)("p",(0,i._)({ref:n,id:r,className:(0,m.cn)("text-sm text-muted-foreground",t)},s))});A.displayName="FormDescription";var j=u.forwardRef(function(e,n){var t=e.className,s=e.children,r=(0,d._)(e,["className","children"]),u=b(),l=u.error,c=u.formMessageId,p=l?String(null==l?void 0:l.message):s;return p?(0,o.jsx)("p",(0,a._)((0,i._)({ref:n,id:c,className:(0,m.cn)("text-sm font-medium text-destructive",t)},r),{children:p})):null});j.displayName="FormMessage"},38318:function(e,n,t){"use strict";t.d(n,{E:function(){return l},X:function(){return c}});var s=t(11010),r=t(97582),i=t(67294),a=t(53260),d=t(42380),o=[{type:"constructor",inputs:[],stateMutability:"nonpayable"},{type:"function",name:"WETHAddress",inputs:[],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"contributeFirstTokenWithETH",inputs:[{name:"tokenAddress",type:"address",internalType:"address"},{name:"to",type:"address",internalType:"address"}],outputs:[],stateMutability:"payable"},{type:"function",name:"init",inputs:[{name:"WETHAddress_",type:"address",internalType:"address"},{name:"launchAddress_",type:"address",internalType:"address"},{name:"stakeAddress_",type:"address",internalType:"address"},{name:"submitAddress_",type:"address",internalType:"address"},{name:"voteAddress_",type:"address",internalType:"address"},{name:"joinAddress_",type:"address",internalType:"address"},{name:"verifyAddress_",type:"address",internalType:"address"},{name:"mintAddress_",type:"address",internalType:"address"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"initialized",inputs:[],outputs:[{name:"",type:"bool",internalType:"bool"}],stateMutability:"view"},{type:"function",name:"joinAddress",inputs:[],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"launchAddress",inputs:[],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"mintAddress",inputs:[],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"stakeAddress",inputs:[],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"stakeLiquidity",inputs:[{name:"tokenAddress",type:"address",internalType:"address"},{name:"tokenAmount",type:"uint256",internalType:"uint256"},{name:"parentTokenAmount",type:"uint256",internalType:"uint256"},{name:"tokenAmountMin",type:"uint256",internalType:"uint256"},{name:"parentTokenAmountMin",type:"uint256",internalType:"uint256"},{name:"promisedWaitingPhases",type:"uint256",internalType:"uint256"},{name:"to",type:"address",internalType:"address"}],outputs:[{name:"govVotesAdded",type:"uint256",internalType:"uint256"},{name:"slAmountAdded",type:"uint256",internalType:"uint256"}],stateMutability:"nonpayable"},{type:"function",name:"submitAddress",inputs:[],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"verifyAddress",inputs:[],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"voteAddress",inputs:[],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"event",name:"ContributeFirstTokenWithETH",inputs:[{name:"tokenAddress",type:"address",indexed:!0,internalType:"address"},{name:"to",type:"address",indexed:!0,internalType:"address"},{name:"amount",type:"uint256",indexed:!1,internalType:"uint256"}],anonymous:!1},{type:"event",name:"StakeLiquidity",inputs:[{name:"tokenAddress",type:"address",indexed:!0,internalType:"address"},{name:"to",type:"address",indexed:!0,internalType:"address"},{name:"tokenAmountDesired",type:"uint256",indexed:!1,internalType:"uint256"},{name:"parentTokenAmountDesired",type:"uint256",indexed:!1,internalType:"uint256"},{name:"tokenAmountReal",type:"uint256",indexed:!1,internalType:"uint256"},{name:"parentTokenAmountReal",type:"uint256",indexed:!1,internalType:"uint256"},{name:"promisedWaitingPhases",type:"uint256",indexed:!1,internalType:"uint256"}],anonymous:!1}],u="0xE91eE14BCFD3863A09792dAe765972A2516B5c83";function l(){var e,n=(0,a.e9)(o,u,"contributeFirstTokenWithETH"),t=n.execute,l=n.isPending,c=n.isConfirming,m=n.isConfirmed,p=n.error,f=n.hash,y=n.isTukeMode,v=(e=(0,s._)(function(e,n,s){return(0,r.Jh)(this,function(r){switch(r.label){case 0:return[4,t([e,n],s)];case 1:return[2,r.sent()]}})}),function(n,t,s){return e.apply(this,arguments)});return(0,i.useEffect)(function(){p&&((0,d.Vh)(p),(0,d.H)(p))},[f,p]),{contribute:v,isPending:l,isConfirming:c,writeError:p,isConfirmed:m,hash:f,isTukeMode:y}}function c(){var e,n=(0,a.e9)(o,u,"stakeLiquidity"),t=n.execute,l=n.isPending,c=n.isConfirming,m=n.isConfirmed,p=n.error,f=n.hash,y=n.isTukeMode,v=(e=(0,s._)(function(e,n,s,i,a,d,o){return(0,r.Jh)(this,function(r){switch(r.label){case 0:return[4,t([e,n,s,i,a,d,o])];case 1:return[2,r.sent()]}})}),function(n,t,s,r,i,a,d){return e.apply(this,arguments)});return(0,i.useEffect)(function(){p&&((0,d.Vh)(p),(0,d.H)(p))},[f,p]),{stakeLiquidity:v,isPending:l,isConfirming:c,isConfirmed:m,writeError:p,hash:f,isTukeMode:y}}},29770:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return z}});var s=t(85893),r=t(67294),i=t(41192),a=t(73008),d=t(99522),o=t(81231),u=t(761),l=t(11010),c=t(72253),m=t(14932),p=t(91309),f=t(97582),y=t(11163),v=t(63448),h=t(56312),x=t(87536),b=t(41664),g=t.n(b),T=t(20975),N=t(47070),k=t(68336),A=t(86501),j=t(1504),_=t(33582),w=t(83149),I=t(99019),E=t(38318),C=t(907),M=t(62710),B=t(41944),F=t(26749),S=t(45197),P=function(e){var n,t,i,o,b=e.token;e.launchInfo;var P=(0,T.m)(),z=P.address,D=P.isConnected;(0,N.x)();var R=(0,y.useRouter)(),$=(null==b?void 0:b.parentTokenSymbol)=="TestTKM20",W=$?"TKM":(null==b?void 0:b.parentTokenSymbol)||"",H=(0,k.K)({address:z,query:{enabled:$}}),L=H.data,V=H.isLoading,Z=H.error,J=(0,C.hS)(null==b?void 0:b.parentTokenAddress,z,!$),q=J.balance,X=J.isPending,G=J.error,K=$?(null==L?void 0:L.value)||BigInt(0):q||BigInt(0),O=$?V:X,Q=(0,a.ap)(null==b?void 0:b.address,z),Y=Q.contributed,U=Q.isPending,ee=Q.error,en=(0,I.vz)("0.001"),et=(0,x.cI)({resolver:(0,h.F)((n=$?en:void 0,t="0.001",v.Ry({contributeAmount:v.Z_().nonempty({message:"请输入申购数量"}).refine(function(e){return Number(e)>0},{message:"申购数量不能为 0"}).refine(function(e){var n;return(null!==(n=(0,I.vz)(e))&&void 0!==n?n:BigInt(0))<=K},{message:"申购数量不能超过余额 (".concat((0,I.bM)(K),")")}).refine(function(e){var t;return!n||(null!==(t=(0,I.vz)(e))&&void 0!==t?t:BigInt(0))<=n},{message:"测试环境限制：首个父币最多可申购 ".concat(t)})}))),defaultValues:{contributeAmount:""},mode:"onChange",reValidateMode:"onChange"}),es=(0,C.yA)(null==b?void 0:b.parentTokenAddress),er=es.approve,ei=es.isPending,ea=es.isConfirming,ed=es.isConfirmed,eo=es.writeError,eu=(0,p._)((0,r.useState)(!1),2),el=eu[0],ec=eu[1],em=(0,C.yG)(null==b?void 0:b.parentTokenAddress,z,"0xEA0627bDfE4F0813B79aA3C7db9F21710a670384",!$),ep=em.allowance,ef=em.isPending,ey=em.error;(0,r.useEffect)(function(){ed&&!$&&(ec(!0),A.Am.success("授权".concat(null==b?void 0:b.parentTokenSymbol,"成功")))},[ed,null==b?void 0:b.parentTokenSymbol,$]);var ev=et.watch("contributeAmount");(0,r.useEffect)(function(){if($){ec(!0);return}var e,n=null!==(e=(0,I.vz)(ev))&&void 0!==e?e:BigInt(0);n>BigInt(0)&&ep&&ep>BigInt(0)&&ep>=n?ec(!0):ec(!1)},[ev,ep,$]);var eh=(i=(0,l._)(function(e){var n;return(0,f.Jh)(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,er("0xEA0627bDfE4F0813B79aA3C7db9F21710a670384",null!==(n=(0,I.vz)(e.contributeAmount))&&void 0!==n?n:BigInt(0))];case 1:case 2:return t.sent(),[3,3];case 3:return[2]}})}),function(e){return i.apply(this,arguments)}),ex=(0,E.E)(),eb=ex.contribute,eg=ex.isPending,eT=ex.isConfirming,eN=ex.isConfirmed,ek=ex.writeError,eA=(0,a.OY)(),ej=eA.contribute,e_=eA.isPending,ew=eA.isConfirming,eI=eA.isConfirmed,eE=eA.writeError,eC=$?eg:e_,eM=$?eT:ew,eB=$?eN:eI,eF=(o=(0,l._)(function(e){var n,t;return(0,f.Jh)(this,function(s){switch(s.label){case 0:if(!$&&!el)return A.Am.error("请先授权"),[2];s.label=1;case 1:if(s.trys.push([1,6,,7]),t=null!==(n=(0,I.vz)(e.contributeAmount))&&void 0!==n?n:BigInt(0),$&&t>en)return(0,A.Am)("测试环境限制：首个父币最多可申购 ".concat(.001)),[2];if(!$)return[3,3];return[4,eb(null==b?void 0:b.address,z,t)];case 2:return s.sent(),[3,5];case 3:return[4,ej(null==b?void 0:b.address,t,z)];case 4:s.sent(),s.label=5;case 5:return[3,7];case 6:return s.sent(),[3,7];case 7:return[2]}})}),function(e){return o.apply(this,arguments)});(0,r.useEffect)(function(){eB&&(A.Am.success("申购成功"),setTimeout(function(){R.push("/launch?symbol=".concat(null==b?void 0:b.symbol))},2e3))},[eB,R,null==b?void 0:b.symbol]);var eS=(0,M.V)().setError;(0,r.useEffect)(function(){D&&!O&&void 0!==K&&K<=BigInt(0)&&eS({name:"余额不足",message:"请先获取 ".concat(W,"，再来申购")})},[K,eS,D,O,W]);var eP=(0,d.S)().handleContractError;(0,r.useEffect)(function(){var e=$?ek:eE,n=$?Z:G;e&&eP(e,"launch"),ee&&eP(ee,"launch"),n&&eP(n,$?"balance":"token"),!$&&(eo&&eP(eo,"token"),ey&&eP(ey,"token"))},[ek,eE,ee,Z,G,eo,ey,eP,$]);var ez=ei||ea,eD=(0,r.useRef)(null);return((0,r.useEffect)(function(){!ef&&eD.current&&eD.current.blur()},[ef]),D)?!b||O||U?(0,s.jsx)(u.Z,{}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"px-4 mt-2",children:[(0,s.jsx)(B.Z,{title:"参与申购"}),(0,s.jsx)("div",{className:"stats w-full",children:(0,s.jsxs)("div",{className:"stat place-items-center",children:[(0,s.jsx)("div",{className:"stat-title text-sm mr-6",children:"我已申购质押"}),(0,s.jsxs)("div",{className:"stat-value text-secondary",children:[(0,I.LH)(Y||BigInt(0)),(0,s.jsx)("span",{className:"text-greyscale-500 font-normal text-sm ml-2",children:W})]})]})}),(0,s.jsx)(w.l0,(0,m._)((0,c._)({},et),{children:(0,s.jsxs)("form",{onSubmit:function(e){return e.preventDefault()},className:"space-y-4",children:[(0,s.jsx)(w.Wi,{control:et.control,name:"contributeAmount",render:function(e){var n=e.field;return(0,s.jsxs)(w.xJ,{children:[(0,s.jsx)(w.lX,{children:"申购数量："}),(0,s.jsx)(w.NI,{children:(0,s.jsx)(_.I,(0,c._)({type:"number",max:$?.001:void 0,placeholder:"请填写".concat(W,"数量"),disabled:!$&&ez||K<=BigInt(0),className:"!ring-secondary-foreground"},n))}),(0,s.jsx)(w.zG,{}),$&&(0,s.jsxs)("div",{className:"text-xs text-greyscale-400 mt-1",children:["测试环境限制：首个父币最多可申购 ",.001]})]})}}),(0,s.jsxs)("div",{className:"flex items-center text-sm mb-4",children:[(0,s.jsxs)("span",{className:"text-greyscale-400",children:[(0,I.LH)(K)," ",W]}),(0,s.jsx)(j.z,{variant:"link",size:"sm",onClick:function(){if($){var e=K>en?en:K;et.setValue("contributeAmount",(0,I.bM)(e))}else et.setValue("contributeAmount",(0,I.bM)(K))},disabled:!$&&ez||K<=BigInt(0),className:"text-secondary",children:"全部"}),!$&&(null==b?void 0:b.parentTokenSymbol)==="TestTKM20"&&(0,s.jsx)(g(),{href:"/dex/deposit?symbol=".concat(b.symbol),children:(0,s.jsxs)(j.z,{variant:"link",size:"sm",className:"text-secondary",children:["获取",b.parentTokenSymbol]})})]}),(0,s.jsx)("div",{className:"flex justify-center",children:$?(0,s.jsx)(j.z,{className:"w-full text-white py-2 rounded-lg",onClick:et.handleSubmit(eF),disabled:eC||eM||eB||K<=BigInt(0),children:eC?"申购中...":eM?"确认中...":eB?"申购成功":"申购"}):(0,s.jsxs)("div",{className:"flex space-x-4 w-full",children:[(0,s.jsx)(j.z,{ref:eD,className:"w-1/2",onClick:et.handleSubmit(eh),disabled:ef||ei||ea||el,children:ef?(0,s.jsx)(S.Z,{className:"animate-spin"}):ei?"1.提交中...":ea?"1.确认中...":el?"1.".concat(null==b?void 0:b.parentTokenSymbol,"已授权"):"1.授权".concat(null==b?void 0:b.parentTokenSymbol)}),(0,s.jsx)(j.z,{className:"w-1/2 text-white py-2 rounded-lg",onClick:et.handleSubmit(eF),disabled:!el||eC||eM||eB,children:eC?"2.申购中...":eM?"2.确认中...":eB?"2.申购成功":"2.申购"})]})})]})}))]}),(0,s.jsx)(F.Z,{isLoading:eC||eM||!$&&(ei||ea),text:eC||!$&&ei?"提交交易...":"确认交易..."})]}):(0,s.jsx)("div",{className:"flex flex-col items-center p-4 mt-4",children:(0,s.jsx)("div",{className:"text-center mb-4 text-greyscale-500",children:"没有链接钱包，请先连接钱包"})})};function z(){var e=((0,r.useContext)(i.M)||{}).token,n=(0,a.kF)(e?e.address:"0x0000000000000000000000000000000000000000"),t=n.launchInfo,l=n.isPending,c=n.error,m=(0,d.S)().handleContractError;return(0,r.useEffect)(function(){c&&m(c,"launch")},[c]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(o.Z,{title:"申购"}),(0,s.jsx)("main",{className:"flex-grow",children:l?(0,s.jsx)(u.Z,{}):t?(0,s.jsx)(P,{token:e,launchInfo:t}):(0,s.jsx)("div",{className:"text-red-500",children:"找不到发射信息"})})]})}},21803:function(e,n,t){"use strict";function s(e,n){let[t,s="0"]=e.split("."),r=t.startsWith("-");if(r&&(t=t.slice(1)),s=s.replace(/(0+)$/,""),0===n)1===Math.round(Number(`.${s}`))&&(t=`${BigInt(t)+1n}`),s="";else if(s.length>n){let[e,r,i]=[s.slice(0,n-1),s.slice(n-1,n),s.slice(n)],a=Math.round(Number(`${r}.${i}`));(s=a>9?`${BigInt(e)+BigInt(1)}0`.padStart(e.length+1,"0"):`${e}${a}`).length>n&&(s=s.slice(1),t=`${BigInt(t)+1n}`),s=s.slice(0,n)}else s=s.padEnd(n,"0");return BigInt(`${r?"-":""}${t}${s}`)}t.d(n,{v:function(){return s}})}},function(e){e.O(0,[7395,6457,1617,8700,1985,8430,7305,2888,9774,179],function(){return e(e.s=58862)}),_N_E=e.O()}]);