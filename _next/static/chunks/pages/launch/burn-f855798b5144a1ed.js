(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5875],{18449:(e,r,s)=>{"use strict";s.d(r,{X:()=>t});var n=s(76200);class a extends n.C{constructor({value:e}){super(`Number \`${e}\` is not a valid decimal number.`,{name:"InvalidDecimalNumberError"})}}function t(e,r){if(!/^(-?)([0-9]*)\.?([0-9]*)$/.test(e))throw new a({value:e});let[s,n="0"]=e.split("."),t=s.startsWith("-");if(t&&(s=s.slice(1)),n=n.replace(/(0+)$/,""),0===r)1===Math.round(Number(`.${n}`))&&(s=`${BigInt(s)+1n}`),n="";else if(n.length>r){let[e,a,t]=[n.slice(0,r-1),n.slice(r-1,r),n.slice(r)],l=Math.round(Number(`${a}.${t}`));(n=l>9?`${BigInt(e)+BigInt(1)}0`.padStart(e.length+1,"0"):`${e}${l}`).length>r&&(n=n.slice(1),s=`${BigInt(s)+1n}`),n=n.slice(0,r)}else n=n.padEnd(r,"0");return BigInt(`${t?"-":""}${s}${n}`)}},29680:(e,r,s)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/launch/burn",function(){return s(96693)}])},42038:(e,r,s)=>{"use strict";s.d(r,{z:()=>l});var n=s(97685),a=s(99090),t=s(99742),l=e=>{var r,s=(()=>{var e,r,s=null==(r=a.$.chains)||null==(e=r[0])?void 0:e.id;if("number"==typeof s)return s;var n=Number(t.env.NEXT_PUBLIC_CHAIN_ID);return Number.isFinite(n)?n:void 0})();return!!e&&!!s&&e===s||(n.oR.error("请先将钱包链接 ".concat(null!=(r=t.env.NEXT_PUBLIC_CHAIN_NAME)?r:t.env.NEXT_PUBLIC_CHAIN)),!1)}},92659:(e,r,s)=>{"use strict";s.d(r,{lV:()=>v,MJ:()=>g,Rr:()=>I,zB:()=>p,eI:()=>y,lR:()=>j,C5:()=>T});var n=s(81110),a=s(40120),t=s(3576),l=s(62701),i=s(65699),o=s(37876),c=s(14232),d=s(82987),m=s(88992),u=s(30684),x=s(59773),N=(0,s(47137).F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),f=c.forwardRef((e,r)=>{var s=e.className,n=(0,i._)(e,["className"]);return(0,o.jsx)(x.b,(0,t._)({ref:r,className:(0,u.cn)(N(),s)},n))});f.displayName=x.b.displayName;var v=m.Op,h=c.createContext({}),p=e=>{var r=(0,n._)({},(0,a._)(e));return(0,o.jsx)(h.Provider,{value:{name:r.name},children:(0,o.jsx)(m.xI,(0,t._)({},r))})},b=()=>{var e=c.useContext(h),r=c.useContext(_),s=(0,m.xW)(),n=s.getFieldState,a=s.formState,l=n(e.name,a);if(!e)throw Error("useFormField should be used within <FormField>");var i=r.id;return(0,t._)({id:i,name:e.name,formItemId:"".concat(i,"-form-item"),formDescriptionId:"".concat(i,"-form-item-description"),formMessageId:"".concat(i,"-form-item-message")},l)},_=c.createContext({}),y=c.forwardRef((e,r)=>{var s=e.className,n=(0,i._)(e,["className"]),a=c.useId();return(0,o.jsx)(_.Provider,{value:{id:a},children:(0,o.jsx)("div",(0,t._)({ref:r,className:(0,u.cn)("space-y-2",s)},n))})});y.displayName="FormItem";var j=c.forwardRef((e,r)=>{var s=e.className,n=(0,i._)(e,["className"]),a=b(),l=a.error,c=a.formItemId;return(0,o.jsx)(f,(0,t._)({ref:r,className:(0,u.cn)(l&&"text-destructive",s),htmlFor:c},n))});j.displayName="FormLabel";var g=c.forwardRef((e,r)=>{var s=(0,n._)({},(0,a._)(e)),l=b(),i=l.error,c=l.formItemId,m=l.formDescriptionId,u=l.formMessageId;return(0,o.jsx)(d.DX,(0,t._)({ref:r,id:c,"aria-describedby":i?"".concat(m," ").concat(u):"".concat(m),"aria-invalid":!!i},s))});g.displayName="FormControl";var I=c.forwardRef((e,r)=>{var s=e.className,n=(0,i._)(e,["className"]),a=b().formDescriptionId;return(0,o.jsx)("p",(0,t._)({ref:r,id:a,className:(0,u.cn)("text-sm text-muted-foreground",s)},n))});I.displayName="FormDescription";var T=c.forwardRef((e,r)=>{var s=e.className,n=e.children,a=(0,i._)(e,["className","children"]),c=b(),d=c.error,m=c.formMessageId,x=d?String(null==d?void 0:d.message):n;return x?(0,o.jsx)("p",(0,l._)((0,t._)({ref:r,id:m,className:(0,u.cn)("text-sm font-medium text-destructive",s)},a),{children:x})):null});T.displayName="FormMessage"},96693:(e,r,s)=>{"use strict";s.r(r),s.d(r,{default:()=>F});var n=s(37876),a=s(14232),t=s(83416),l=s(40752),i=s(4113),o=s(16927),c=s(3576),d=s(62701),m=s(40854),u=s(4902),x=s(22442),N=s(13810),f=s(88992),v=s(8047),h=s(1081),p=s(97685),b=s(89099),_=s(6960),y=s(77932),j=s(92659),g=s(20442),I=s(42038),T=s(9215),k=s(1709),C=s(12293),E=s(99574),S=s(99742);let w=e=>{var r=e.token;e.launchInfo;var s=(0,v.F)().address,t=(0,h.i)(),l=(0,b.useRouter)(),w=(0,T.lW)(null==r?void 0:r.address,s),A=w.balance,F=w.isPending,P=w.error,$=(0,T.lW)(null==r?void 0:r.parentTokenAddress,s),B=$.balance,R=($.isPending,$.error),X=(0,T.lW)(null==r?void 0:r.parentTokenAddress,null==r?void 0:r.address),M=X.balance,L=(X.isPending,X.error),O=(0,T.PT)(null==r?void 0:r.address),D=O.totalSupply,J=(O.isPending,O.error),U=(0,a.useMemo)(()=>x.Ik({burnAmount:x.Yj().nonempty({message:"请输入销毁数量"}).refine(e=>Number(e)>0,{message:"销毁数量不能为0"})}).refine(e=>{if(!A)return!0;try{return!!(0,g.XS)(e.burnAmount)&&(0,g.XS)(e.burnAmount)<=A}catch(e){return!1}},{message:"销毁数量不能超过您的余额",path:["burnAmount"]}),[A]),z=(0,f.mN)({resolver:(0,N.u)(U),defaultValues:{burnAmount:""},mode:"onChange"}),V=z.watch("burnAmount");(0,a.useMemo)(()=>{try{return V?(0,g.XS)(V):0n}catch(e){return 0n}},[V]);var H=(0,m._)((0,a.useState)(0n),2),W=H[0],Y=H[1];(0,a.useEffect)(()=>{var e=z.getValues("burnAmount");D&&M&&e&&Y((0,g.XS)(e)*M/D)},[z.watch("burnAmount"),D,M]);var K=(0,T.HF)(null==r?void 0:r.address),q=K.burnForParentToken,G=K.isPending,Q=K.isConfirming,Z=K.isConfirmed,ee=K.writeError;(0,a.useEffect)(()=>{Z&&(p.oR.success("销毁成功"),setTimeout(()=>{l.push("/my?symbol=".concat(null==r?void 0:r.symbol))},1e3))},[Z,l,null==r?void 0:r.symbol]);var er=(0,i.g)().handleContractError;return((0,a.useEffect)(()=>{P&&er(P,"token"),L&&er(L,"token"),J&&er(J,"token"),R&&er(R,"token"),ee&&er(ee,"token")},[P,L,J,R,ee,er]),!r||F)?(0,n.jsx)(C.A,{}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"p-6",children:[(0,n.jsx)(k.A,{title:"换回父币"}),(0,n.jsx)("div",{className:"stats w-full",children:(0,n.jsxs)("div",{className:"stat place-items-center",children:[(0,n.jsx)("div",{className:"stat-title text-sm mr-6",children:"父币托底池总量"}),(0,n.jsxs)("div",{className:"stat-value text-secondary mt-2",children:[(0,g.NJ)(M||0n),(0,n.jsx)("span",{className:"text-greyscale-500 font-normal text-sm ml-2",children:r.parentTokenSymbol})]}),(0,n.jsxs)("div",{className:"stat-desc text-sm mt-2",children:["销毁 ",r.symbol,"，可从父币托底池取回 ",r.parentTokenSymbol]})]})}),(0,n.jsxs)("div",{className:"mt-6",children:[(0,n.jsx)(j.lV,(0,d._)((0,c._)({},z),{children:(0,n.jsxs)("form",{onSubmit:e=>e.preventDefault(),children:[(0,n.jsxs)("div",{className:"flex items-center text-sm my-0",children:[(0,n.jsxs)("span",{className:"text-greyscale-400",children:["我的 ",r.symbol,": ",(0,n.jsx)("span",{className:"text-secondary",children:(0,g.NJ)(A||0n)})]}),(0,n.jsx)(_.$,{variant:"link",size:"sm",onClick:()=>{z.setValue("burnAmount",(0,g.Js)(A||0n))},disabled:0n>=(A||0n)||G||Q,className:"text-secondary",children:"最高"})]}),(0,n.jsx)(j.zB,{control:z.control,name:"burnAmount",render:e=>{var s=e.field;return(0,n.jsxs)(j.eI,{children:[(0,n.jsx)(j.MJ,{children:(0,n.jsx)(y.p,(0,c._)({type:"number",placeholder:"请输入要销毁的 ".concat(r.symbol," 数量"),disabled:0n>=(A||0n)||G||Q,className:"!ring-secondary-foreground"},s))}),(0,n.jsx)(j.C5,{})]})}}),(0,n.jsx)("div",{className:"flex items-center text-sm mt-1 mb-2",children:(0,n.jsxs)("span",{className:"text-greyscale-400",children:["预计可取回 ",(0,n.jsx)("span",{className:"text-secondary",children:(0,g.NJ)(W)})," ",r.parentTokenSymbol]})}),(0,n.jsx)("div",{className:"flex justify-center",children:(0,n.jsx)(_.$,{className:"text-white py-2 rounded-lg",onClick:z.handleSubmit(e=>(0,o._)(function(){return(0,u.YH)(this,function(r){switch(r.label){case 0:if(!(0,I.z)(t))return[2];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,q((0,g.XS)(e.burnAmount))];case 2:return r.sent(),[3,4];case 3:return console.error(r.sent()),[3,4];case 4:return[2]}})})()),disabled:G||Q||Z,children:G?"提交中...":Q?"确认中...":Z?"交易成功":"销毁 ".concat(r.symbol,"，换回父币")})}),(0,n.jsxs)("div",{className:"flex items-center justify-center text-sm my-2",children:[(0,n.jsxs)("span",{className:"text-greyscale-400",children:["我的 ",r.parentTokenSymbol,":"," ",(0,n.jsx)("span",{className:"text-secondary",children:(0,g.NJ)(B||0n)})," ",r.parentTokenSymbol]}),(0,n.jsx)(_.$,{variant:"link",size:"sm",onClick:()=>l.push("/dex/swap?from=".concat(r.parentTokenSymbol,"&to=").concat(r.parentTokenSymbol==S.env.NEXT_PUBLIC_FIRST_PARENT_TOKEN_SYMBOL?S.env.NEXT_PUBLIC_NATIVE_TOKEN_SYMBOL:S.env.NEXT_PUBLIC_FIRST_PARENT_TOKEN_SYMBOL)),className:"text-secondary ml-2",children:"去兑换"})]})]})})),(0,n.jsxs)("div",{className:"bg-gray-100 text-greyscale-500 rounded-lg p-4 text-sm mt-4",children:[(0,n.jsx)("p",{className:"mb-1",children:"计算公式："}),(0,n.jsxs)("p",{children:["所得 ",r.parentTokenSymbol," 数量 = 底池 ",r.parentTokenSymbol," 总量 * (销毁 ",r.symbol," 数量 /"," ",r.symbol," 总发行量)"]})]})]})]}),(0,n.jsx)(E.A,{isLoading:G||Q,text:G?"提交交易...":"确认交易..."})]})};var A=s(60154);function F(){var e=((0,a.useContext)(t.N)||{}).token,r=(0,l.TU)(e?e.address:"0x0000000000000000000000000000000000000000"),s=r.launchInfo,o=r.isPending,c=r.error,d=(0,i.g)().handleContractError;return(0,a.useEffect)(()=>{c&&d(c,"launch")},[c]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(A.A,{title:"换回父币"}),(0,n.jsx)("main",{className:"flex-grow",children:o?(0,n.jsx)(C.A,{}):s?(0,n.jsx)(w,{token:e,launchInfo:s}):(0,n.jsx)("div",{className:"text-red-500",children:"找不到发射信息"})})]})}}},e=>{e.O(0,[3308,4243,9985,154,5498,5139,3356,636,6593,8792],()=>e(e.s=29680)),_N_E=e.O()}]);