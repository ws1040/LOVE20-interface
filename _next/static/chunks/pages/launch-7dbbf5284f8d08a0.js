(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6185],{8917:(e,s,t)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/launch",function(){return t(67574)}])},67574:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>_});var n=t(3576),a=t(62701),r=t(37876),l=t(14232),c=t(83416),i=t(40752),o=t(20451),d=t(60154),m=t(12293),x=t(63934),u=t(57607),h=t(20442),j=t(1709);let N=e=>{var s=e.token,t=e.launchInfo,n=Number(t.totalContributed)/Number(t.parentTokenFundraisingGoal),a=(100*n).toFixed(1),l=(0,x.y)().data;if(!t)return(0,r.jsx)("div",{className:"text-red-500",children:"找不到发射信息"});if(!s)return(0,r.jsx)(m.A,{});var c="TestTKM20"==s.parentTokenSymbol?"TKM":s.parentTokenSymbol;return(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("div",{className:"flex-col items-center mb-2 mt-4 px-4",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(j.A,{title:"公平发射"}),t.hasEnded&&(0,r.jsx)("span",{className:"stat-title text-base text-red-500",children:"（已结束）"})]}),(0,r.jsx)("div",{className:"stats w-full",children:(0,r.jsxs)("div",{className:"stat place-items-center",children:[(0,r.jsx)("div",{className:"stat-title text-sm mr-6 ",children:"申购累计筹集到"}),(0,r.jsxs)("div",{className:"stat-value",children:[(0,r.jsx)("span",{className:"text-3xl text-secondary",children:(0,h.NJ)(t.totalContributed)}),(0,r.jsx)("span",{className:"text-greyscale-500 font-normal text-sm ml-2",children:c})]}),(0,r.jsxs)("div",{className:"stats w-full grid grid-cols-2 divide-x-0",children:[(0,r.jsxs)("div",{className:"stat place-items-center pb-1 pl-0",children:[(0,r.jsxs)("div",{className:"stat-title text-sm",children:[(0,r.jsx)("span",{children:c}),"筹集目标"]}),(0,r.jsx)("div",{className:"stat-value text-xl",children:(0,h.NJ)(t.parentTokenFundraisingGoal)})]}),(0,r.jsxs)("div",{className:"stat place-items-center pb-1 pl-0",children:[(0,r.jsxs)("div",{className:"stat-title text-sm",children:[(0,r.jsxs)("span",{children:[s.symbol," "]}),"发射总量"]}),(0,r.jsx)("div",{className:"stat-value text-xl",children:"".concat((0,h.NJ)(BigInt(u.F.fairLaunch)))})]})]}),(0,r.jsxs)("div",{className:"text-center text-xs text-greyscale-500",children:["兑换比例：1 ",c," ="," ",(0,h.lM)((0,h.mW)((Number(u.F.fairLaunch)/Number(t.parentTokenFundraisingGoal)).toLocaleString("en-US",{maximumFractionDigits:2,minimumFractionDigits:2})))," ",s.symbol]}),(0,r.jsxs)("div",{className:"mt-2 rounded-lg text-sm",children:[(0,r.jsx)("p",{className:"mt-2 mb-1 font-medium",children:"发射结束条件："}),(0,r.jsxs)("p",{className:"text-greyscale-600",children:["1. 累计申购达到募资目标 100%",!t.hasEnded&&"（当前 ".concat(a,"%）")]}),(0,r.jsxs)("p",{className:"text-greyscale-600",children:["2. 最后一笔申购，距离首笔达成 50%募资目标的所在区块",!t.hasEnded&&n>=.5&&(()=>{var e=Number(t.secondHalfStartBlock)+Number(t.secondHalfMinBlocks),s=Number(l||0),a=e-s;return a<=0?n>=1?"（第 ".concat(t.secondHalfStartBlock.toString(),"区块），至少").concat(t.secondHalfMinBlocks.toString(),"个区块（已满足条件，任意一笔新的申购将触发公平发射结束）"):"（第 ".concat(t.secondHalfStartBlock.toString(),"区块），至少").concat(t.secondHalfMinBlocks.toString(),"个区块（已满足条件）"):"（第 ".concat(t.secondHalfStartBlock.toString(),"区块），至少").concat(t.secondHalfMinBlocks.toString(),"个区块（当前区块：第").concat(s,"区块，还需等待").concat(a,"个区块）")})(),!t.hasEnded&&n<.5&&"，至少".concat(t.secondHalfMinBlocks.toString(),"个区块"),t.hasEnded&&"（第 ".concat(t.secondHalfStartBlock.toString(),"区块），至少").concat(t.secondHalfMinBlocks.toString(),"个区块")]})]})]})}),(0,r.jsxs)("div",{className:"bg-gray-100 text-greyscale-500 rounded-lg p-4 mt-4 text-sm",children:[(0,r.jsx)("p",{className:"mt-1 font-medium",children:"经济模型："}),(0,r.jsxs)("p",{children:["1. 代币总量：",(0,h.NJ)(BigInt(u.F.totalSupply))]}),(0,r.jsxs)("p",{children:["2. 发射数量：",(0,h.NJ)(BigInt(u.F.fairLaunch))," (10%)"]}),(0,r.jsxs)("p",{children:["3. 治理激励：",(0,h.NJ)(BigInt(u.F.govRewards))," (45%)"]}),(0,r.jsxs)("p",{children:["4. 行动激励：",(0,h.NJ)(BigInt(u.F.actionRewards))," (45%)"]}),(0,r.jsx)("p",{className:"mt-3 font-medium",children:"发射规则："}),(0,r.jsx)("p",{children:"1. 代币发放：按申购数量占比平均发放"}),(0,r.jsx)("p",{children:"2. 超过募集目标的父币，将按申购比例返还"})]})]})})};var f=t(16927),v=t(4902),g=t(6960),p=t(8047),b=t(89099),y=t(48230),k=t.n(y),w=t(97685),T=t(65575),C=t(99574);let S=e=>{var s=e.token;e.launchInfo;var t=(0,p.F)(),n=t.address,a=t.isConnected,c=(0,x.y)().data,d=(0,b.useRouter)(),u=(0,i.$r)(null==s?void 0:s.address,a?n:"0x0000000000000000000000000000000000000000"),N=u.contributed,y=u.isPending,S=u.error,A=u.refetch,E=(0,i.MU)(null==s?void 0:s.address,a?n:"0x0000000000000000000000000000000000000000"),_=E.lastContributedBlock,F=E.isPending,B=E.error,M=(0,T.oQ)("48")-((c?BigInt(c):0n)-(_||0n)),H=(0,i.S1)(),I=H.withdraw,J=H.isPending,P=H.writeError,K=H.isConfirming,$=H.isConfirmed;(0,l.useEffect)(()=>{$&&(w.Ay.success("撤回成功"),A(),setTimeout(()=>{d.push("/launch/?symbol=".concat(null==s?void 0:s.symbol))},1e3))},[$]);var L=(0,o.g)().handleContractError;if((0,l.useEffect)(()=>{S&&L(S,"launch"),B&&L(B,"launch"),P&&L(P,"launch")},[S,B,P]),!s||y||F)return(0,r.jsx)(m.A,{});var G="TestTKM20"==s.parentTokenSymbol?"TKM":s.parentTokenSymbol;return(0,r.jsxs)("div",{className:"px-6",children:[(0,r.jsx)(j.A,{title:"参与申购"}),(0,r.jsx)("div",{className:"stats w-full",children:(0,r.jsxs)("div",{className:"stat place-items-center",children:[(0,r.jsx)("div",{className:"stat-title text-sm mr-6",children:"我的申购质押"}),(0,r.jsxs)("div",{className:"stat-value text-secondary",children:[(0,h.NJ)(N||0n),(0,r.jsx)("span",{className:"text-greyscale-500 font-normal text-sm ml-2",children:G})]})]})}),(0,r.jsxs)("div",{className:"flex justify-center gap-4",children:[N&&N>0n&&(0,r.jsx)(g.$,{variant:"outline",size:"sm",className:"w-1/2 text-secondary border-secondary",onClick:()=>(0,f._)(function(){return(0,v.YH)(this,function(e){switch(e.label){case 0:if(M>0n)return w.Ay.error("还需要等待 ".concat(M," 个区块才能撤回")),[2];return[4,I(null==s?void 0:s.address)];case 1:return e.sent(),[2]}})})(),disabled:J||K||$,children:J?"提交中...":K?"确认中...":$?"已撤回":"撤回申购"}),(0,r.jsx)(g.$,{variant:"outline",size:"sm",className:"w-1/2 text-secondary border-secondary",asChild:!0,children:(0,r.jsx)(k(),{href:"/launch/contribute?symbol=".concat(null==s?void 0:s.symbol),children:N&&N>0n?"增加申购":"去申购"})})]}),N&&N>0n&&(0,r.jsxs)("div",{className:"mt-4 text-sm text-greyscale-500 text-center",children:["申购后需等 ","48"," 个区块才能撤回（当前还需等"," ",M>0?M.toString():"0"," 个区块）"]}),(0,r.jsx)("div",{className:"border-t border-gray-200 mt-4 mb-6"}),(0,r.jsx)(C.A,{isLoading:J||K,text:J?"提交交易...":"确认交易..."})]})},A=e=>{var s=e.token;e.launchInfo;var t=(0,p.F)().address,n=((0,l.useContext)(c.N)||{}).clearToken,a=(0,i.$r)(null==s?void 0:s.address,t),d=a.contributed,x=(a.isPending,a.error),u=(0,i.Wc)(null==s?void 0:s.address,t),N=u.receivedTokenAmount,b=u.extraRefund,y=u.isClaimed,T=u.isPending,S=u.error;console.log("receivedTokenAmount",N);var A=(0,i.G0)(),E=A.claim,_=A.isPending,F=A.writeError,B=A.isConfirming,M=A.isConfirmed;(0,l.useEffect)(()=>{M?(w.Ay.success("领取成功"),null==n||n(),setTimeout(()=>{window.location.reload()},1e3)):F&&w.Ay.error("领取失败")},[M,F]);var H=(0,o.g)().handleContractError;if((0,l.useEffect)(()=>{F&&H(F,"launch"),S&&H(S,"launch"),x&&H(x,"launch")},[F,S,x]),!t)return"";if(T||!s)return(0,r.jsx)(m.A,{});var I="TestTKM20"==s.parentTokenSymbol?"TKM":s.parentTokenSymbol;return(0,r.jsxs)("div",{className:"px-4 mt-2",children:[(0,r.jsx)(j.A,{title:"我的申购"}),(0,r.jsx)("div",{className:"stats w-full",children:(0,r.jsxs)("div",{className:"stat place-items-center",children:[(0,r.jsx)("div",{className:"stat-title text-sm mr-6",children:"共获得"}),(0,r.jsxs)("div",{className:"stat-value text-3xl text-secondary",children:[(0,h.NJ)(null!=N?N:0n),(0,r.jsx)("span",{className:"text-greyscale-500 font-normal text-sm ml-2",children:s.symbol})]})]})}),(0,r.jsxs)("div",{className:"flex justify-center space-x-4",children:[0>=Number(d)&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(g.$,{className:"w-1/2",disabled:!0,children:"未申购"}),(0,r.jsx)(g.$,{className:"w-1/2",asChild:!0,children:(0,r.jsx)(k(),{href:"/launch/burn?symbol=".concat(null==s?void 0:s.symbol),children:"换回父币"})})]}),Number(d)>0&&!y&&(0,r.jsx)(g.$,{className:"w-1/2",onClick:()=>(0,f._)(function(){return(0,v.YH)(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,E(null==s?void 0:s.address)];case 1:return e.sent(),[3,3];case 2:return console.error("领取失败:",e.sent()),[3,3];case 3:return[2]}})})(),disabled:_||B||M,children:_?"领取中...":B?"确认中...":M?"已领取":"领取"}),Number(d)>0&&y&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(g.$,{className:"w-1/2",disabled:!0,children:"已领取"}),(0,r.jsx)(g.$,{className:"w-1/2",asChild:!0,children:(0,r.jsx)(k(),{href:"/launch/burn?symbol=".concat(null==s?void 0:s.symbol),children:"换回父币"})})]})]}),Number(d)>0&&y&&(0,r.jsxs)("div",{className:"text-center text-sm my-2 text-greyscale-400",children:["我共申购了 ",(0,r.jsxs)("span",{className:"text-secondary",children:[(0,h.NJ)(null!=d?d:0n)," "]}),I,"，申购返还了 ",(0,r.jsx)("span",{className:"text-secondary",children:(0,h.NJ)(null!=b?b:0n)})," ",s.parentTokenSymbol,"TestTKM20"==s.parentTokenSymbol&&(0,r.jsxs)(k(),{href:"/dex/swap?from=".concat(s.parentTokenSymbol,"&to=").concat("TKM"),className:"text-secondary ml-1",children:["（转回 ","TKM","）"]})]}),(0,r.jsx)("div",{className:"border-t border-gray-200 mx-4 mt-4 mb-6"}),(0,r.jsx)(C.A,{isLoading:_||B,text:_?"提交交易...":"确认交易..."})]})};var E=t(62537);function _(){var e=(0,l.useContext)(c.N)||{token:null,setToken:null},s=e.token,t=e.setToken,x=(0,i.TU)(s?s.address:"0x0000000000000000000000000000000000000000"),u=x.launchInfo,h=x.isPending,j=x.error,f=(0,o.g)().handleContractError;return((0,l.useEffect)(()=>{j&&f(j,"launch")},[j]),(0,l.useEffect)(()=>{u&&s&&u.hasEnded&&!s.hasEnded&&t((0,a._)((0,n._)({},s),{hasEnded:!0}))},[u,s]),h||u)?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(d.A,{title:"公平发射"}),(0,r.jsxs)("main",{className:"flex-grow",children:[(0,r.jsx)(E.A,{}),h||!u?(0,r.jsx)(m.A,{}):(0,r.jsxs)(r.Fragment,{children:[s&&(u.hasEnded?(0,r.jsx)(A,{token:s,launchInfo:u}):(0,r.jsx)(S,{token:s,launchInfo:u})),(0,r.jsx)(N,{token:s,launchInfo:u})]})]})]}):(0,r.jsx)("div",{className:"text-red-500",children:"找不到发射信息"})}},75695:(e,s,t)=>{"use strict";t.d(s,{A:()=>u});var n=t(16927),a=t(40854),r=t(4902),l=t(37876),c=t(14232),i=t(7446),o=t(95167),d=t(8047),m=t(44571),x=t(97685);function u(e){var s=e.tokenAddress,t=e.tokenSymbol,u=e.tokenDecimals,h=e.tokenImage,j=(0,a._)((0,c.useState)(!1),2),N=j[0],f=j[1],v=(0,d.F)().isConnected,g=(0,m.G)().data;return t.length>11?null:(0,l.jsx)("button",{onClick:()=>(0,n._)(function(){return(0,r.YH)(this,function(e){switch(e.label){case 0:if(!v)return alert("请先连接你的钱包"),[2];f(!0),e.label=1;case 1:if(e.trys.push([1,3,4,5]),!g)return alert("无法获取钱包客户端"),[2];return[4,g.request({method:"wallet_watchAsset",params:{type:"ERC20",options:{address:s,symbol:t,decimals:u,image:h}}})];case 2:return e.sent()?x.Ay.success("代币已成功添加到 MetaMask 钱包"):x.Ay.error("用户拒绝添加代币"),[3,5];case 3:return console.error("添加代币失败:",e.sent()),x.Ay.error("添加代币失败，请检查控制台以获取更多信息"),[3,5];case 4:return f(!1),[7];case 5:return[2]}})})(),disabled:N,className:"flex items-center justify-center p-1 rounded hover:bg-gray-200 focus:outline-none",children:N?(0,l.jsx)(i.A,{className:"h-4 w-4 animate-spin"}):(0,l.jsx)(o.A,{className:"h-4 w-4 text-greyscale-500"})})}},87577:(e,s,t)=>{"use strict";t.d(s,{A:()=>m});var n=t(40854),a=t(37876),r=t(14232),l=t(48447),c=t(33276),i=t(70801),o=t(97685),d=t(20442);let m=e=>{var s=e.address,t=e.word,m=e.showCopyButton,x=e.showAddress,u=void 0===x||x,h=e.colorClassName,j=void 0===h?"":h,N=e.colorClassName2,f=void 0===N?"":N,v=(0,n._)((0,r.useState)(!1),2),g=v[0],p=v[1];return(0,a.jsxs)("span",{className:"inline-flex items-center space-x-2",children:[t&&(0,a.jsx)("span",{className:"text-xs",children:t}),u&&!f&&(0,a.jsx)("span",{className:"font-mono text-xs ".concat(null!=j?j:"text-greyscale-500"),children:(0,d.W_)(s)}),u&&f&&(0,a.jsxs)("span",{className:"text-[0px]",children:[(0,a.jsx)("span",{className:"font-mono text-xs ".concat(null!=j?j:"text-greyscale-500"),children:"".concat(s.substring(0,6),"...")}),(0,a.jsx)("span",{className:"font-mono text-xs ".concat(f),children:"".concat(s.substring(s.length-4))})]}),(void 0===m||m)&&(0,a.jsx)(l.CopyToClipboard,{text:s,onCopy:(e,s)=>{s?p(!0):o.Ay.error("复制失败")},children:(0,a.jsx)("button",{className:"flex items-center justify-center p-1 rounded hover:bg-gray-200 focus:outline-none",onClick:e=>{e.preventDefault(),e.stopPropagation()},"aria-label":"复制地址",children:g?(0,a.jsx)(c.A,{className:"h-4 w-4 ".concat(null!=j?j:"text-greyscale-500")}):(0,a.jsx)(i.A,{className:"h-4 w-4 ".concat(null!=j?j:"text-greyscale-500")})})})]})}}},e=>{e.O(0,[3308,7460,8230,4571,5701,5060,154,3096,5139,3356,2537,636,6593,8792],()=>e(e.s=8917)),_N_E=e.O()}]);