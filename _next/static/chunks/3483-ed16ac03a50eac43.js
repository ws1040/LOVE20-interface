try{!function(){var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="e6639f60-0cd3-4b5c-a661-b97ede3aabba",e._sentryDebugIdIdentifier="sentry-dbid-e6639f60-0cd3-4b5c-a661-b97ede3aabba")}()}catch(e){}"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3483],{31729:function(e,n,t){var i=t(11010),r=t(97582),s=t(85893),a=t(67294),d=t(42130),o=t(39360),c=t(86501),u=t(27245),l=t(41664),f=t.n(l),m=t(11163),h=t(20442),x=t(93950),b=t(93566),g=t(73591),v=t(93778),y=t(91529),j=t(42083),N=t(44576),p=t(72107);n.Z=function(e){var n,t=e.actionId,l=e.actionInfo,w=e.onStakedAmountChange,I=e.showJoinButton,C=(0,d.m)().address;(0,o.x)();var B=((0,a.useContext)(v.M)||{}).token,k=(0,m.useRouter)(),P=(0,h.Bk)(),E=P.currentRound,A=P.error,$=(0,b.$A)((null==B?void 0:B.address)||"",E,t),_=$.isSubmitted,M=$.error,D=$.isPending,F=(0,h.X9)((null==B?void 0:B.address)||"",t,C||""),L=F.joinedAmountByActionIdByAccount,S=F.isPending,T=F.error,Z=(0,h.PL)((null==B?void 0:B.address)||"",t),z=Z.joinedAmountByActionId,R=Z.isPending,J=Z.error,q=L&&L>0&&z&&z>0,H=q?Number(L)/Number(z)*100:0,K=(0,y.rl)(H),V=q?(0,y.rl)(Math.min(H*Number(null==l?void 0:l.body.maxRandomAccounts),100)):"0%",X=(0,x.Cv)((null==B?void 0:B.address)||"",t,C||""),Q=X.verificationKeys,W=X.verificationInfos,G=X.isPending,O=X.error,U=(0,h.Qc)(),Y=U.withdraw,ee=U.isPending,en=U.isConfirming,et=U.isConfirmed,ei=U.writeError,er=(n=(0,i._)(function(){return(0,r.Jh)(this,function(e){switch(e.label){case 0:if(void 0!=L&&L<=BigInt(2))return c.Am.error("你还没有参与，无需取回"),[2];return[4,Y((null==B?void 0:B.address)||"",t)];case 1:return e.sent(),[2]}})}),function(){return n.apply(this,arguments)});(0,a.useEffect)(function(){et&&(c.Am.success("取回成功"),k.push("/my"))},[et,k]),(0,a.useEffect)(function(){S||null==w||w(L||BigInt(0))},[L,S]);var es=(0,g.S)().handleContractError;return((0,a.useEffect)(function(){T&&es(T,"join"),J&&es(J,"join"),O&&es(O,"join"),A&&es(A,"join"),ei&&es(ei,"join"),M&&es(M,"submit")},[T,J,O,A,ei,M]),S||R||D)?"":(0,s.jsxs)("div",{className:"flex flex-col items-center px-4 pt-1",children:[q&&(0,s.jsxs)("div",{className:"stats w-full grid grid-cols-2 divide-x-0",children:[(0,s.jsxs)("div",{className:"stat place-items-center",children:[(0,s.jsx)("div",{className:"stat-title",children:"我的参与"}),(0,s.jsx)("div",{className:"stat-value text-2xl text-secondary",children:R?(0,s.jsx)(j.Z,{}):(0,y.LH)(L||BigInt(0),0)}),(0,s.jsx)("div",{className:"stat-desc text-sm mt-2",children:"参与本行动的代币"})]}),(0,s.jsxs)("div",{className:"stat place-items-center",children:[(0,s.jsx)("div",{className:"stat-title",children:"我的占比"}),(0,s.jsx)("div",{className:"stat-value text-2xl text-secondary",children:K}),(0,s.jsxs)("div",{className:"stat-desc text-sm mt-2",children:["被抽中验证概率 ",V]})]})]}),(void 0===I||I)&&(0,s.jsx)(s.Fragment,{children:q?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"flex justify-center space-x-2 mt-2 w-full",children:[void 0!=L&&L<=BigInt(2)?(0,s.jsx)(u.z,{variant:"outline",className:"w-1/3 text-secondary border-secondary",disabled:!0,children:"取回"}):(0,s.jsx)(u.z,{variant:"outline",className:"w-1/3 text-secondary border-secondary",onClick:er,disabled:ee||en||et,children:ee?"提交中":en?"确认中":et?"已取回":"取回代币"}),(0,s.jsx)(u.z,{variant:"outline",className:"w-1/3 text-secondary border-secondary",asChild:!0,children:(0,s.jsx)(f(),{href:"/my/rewardsofaction?id=".concat(t,"&symbol=").concat(null==B?void 0:B.symbol),children:"查看激励"})}),(0,s.jsx)(u.z,{variant:"outline",className:"w-1/3 text-secondary border-secondary",asChild:!0,children:(0,s.jsx)(f(),{href:"/acting/join?id=".concat(t,"&symbol=").concat(null==B?void 0:B.symbol),children:"增加参与代币"})})]}),(0,s.jsx)("div",{className:"flex flex-col items-center my-4",children:(0,s.jsxs)("div",{className:"text-sm text-greyscale-600",children:[G&&"加载中...",void 0!=L&&L>BigInt(2)&&Q&&Q.length>0&&(0,s.jsx)("div",{children:Q.map(function(e,n){return(0,s.jsxs)("div",{children:[e,": ",(0,s.jsx)(p.L,{text:W[n]})]},n)})})]})})]}):_&&(0,s.jsx)(u.z,{variant:"outline",className:"w-1/2 text-secondary border-secondary",asChild:!0,children:(0,s.jsx)(f(),{href:"/acting/join?id=".concat(t,"&symbol=").concat(null==B?void 0:B.symbol),children:"参与行动"})})}),(0,s.jsx)(N.Z,{isLoading:ee||en,text:ee?"提交交易...":"确认交易..."})]})}},42083:function(e,n,t){var i=t(85893),r=t(23432);n.Z=function(){return(0,i.jsx)(r.Z,{className:"mx-auto h-4 w-4 animate-spin text-greyscale-500"})}},93566:function(e,n,t){t.d(n,{$A:function(){return h},Bk:function(){return m},Xo:function(){return g},dI:function(){return f},qd:function(){return b},sK:function(){return x}});var i=t(11010),r=t(97582),s=t(67294),a=t(71104),d=t(7724),o=t(37742),c=t(84689),u=t(435),l="0xeBB295af1D4ee9ed92e55EFF4ca5Eb8D4AB81aCE",f=function(e,n){var t=(0,a.u)({address:l,abi:d.d,functionName:"actionInfo",args:[e,n||BigInt(0)],query:{enabled:!!e&&void 0!==n}});return{actionInfo:t.data,isPending:t.isPending,error:t.error}},m=function(){var e=(0,a.u)({address:l,abi:d.d,functionName:"currentRound",args:[]}),n=e.data,t=e.isPending,i=e.error;return{currentRound:(0,o.Zu)(n),isPending:t,error:i}},h=function(e,n,t){var i=(0,a.u)({address:l,abi:d.d,functionName:"isSubmitted",args:[e,n,t]});return{isSubmitted:i.data,isPending:i.isPending,error:i.error}},x=function(e,n,t){var i=(0,a.u)({address:l,abi:d.d,functionName:"submitInfo",args:[e,n,t],query:{enabled:!!e&&!!n}});return{submitInfo:i.data,isPending:i.isPending,error:i.error}};function b(){var e,n=(0,u.e9)(d.d,l,"submit"),t=n.execute,a=n.isPending,o=n.isConfirming,f=n.isConfirmed,m=n.error,h=n.hash,x=n.isTukeMode,b=(e=(0,i._)(function(e,n){return(0,r.Jh)(this,function(i){switch(i.label){case 0:return[4,t([e,n])];case 1:return[2,i.sent()]}})}),function(n,t){return e.apply(this,arguments)});return(0,s.useEffect)(function(){m&&((0,c.Vh)(m),(0,c.H)(m))},[h,m,f]),{submit:b,isPending:a,isConfirming:o,writeError:m,isConfirmed:f,hash:h,isTukeMode:x}}function g(){var e,n=(0,u.e9)(d.d,l,"submitNewAction"),t=n.execute,a=n.isPending,o=n.isConfirming,f=n.isConfirmed,m=n.error,h=n.hash,x=n.isTukeMode,b=(e=(0,i._)(function(e,n){return(0,r.Jh)(this,function(i){switch(i.label){case 0:return[4,t([e,n])];case 1:return[2,i.sent()]}})}),function(n,t){return e.apply(this,arguments)});return(0,s.useEffect)(function(){m&&((0,c.Vh)(m),(0,c.H)(m))},[h,m,f]),{submitNewAction:b,isPending:a,isConfirming:o,writeError:m,isConfirmed:f,hash:h,isTukeMode:x}}},72107:function(e,n,t){t.d(n,{L:function(){return a}});var i=t(85893);t(67294);var r=t(40330),s=function(e){if(!e)return e;var n=/(https?:\/\/[^\s]+)/g;if(!n.test(e))return e;var t=e.split(n),s=e.match(n)||[];return(0,i.jsx)(i.Fragment,{children:t.map(function(e,n){if(n%2==0)return e;var t=s[(n-1)/2];return(0,i.jsx)("a",{href:t,onClick:function(e){e.preventDefault(),r.N.handleExternalLink(t)},className:"text-blue-500 underline hover:text-blue-700 break-words break-all whitespace-normal",target:"_blank",children:t},n)})})},a=function(e){var n=e.text;return(0,i.jsx)(i.Fragment,{children:s(n)})}},21803:function(e,n,t){t.d(n,{v:function(){return i}});function i(e,n){let[t,i="0"]=e.split("."),r=t.startsWith("-");if(r&&(t=t.slice(1)),i=i.replace(/(0+)$/,""),0===n)1===Math.round(Number(`.${i}`))&&(t=`${BigInt(t)+1n}`),i="";else if(i.length>n){let[e,r,s]=[i.slice(0,n-1),i.slice(n-1,n),i.slice(n)],a=Math.round(Number(`${r}.${s}`));(i=a>9?`${BigInt(e)+BigInt(1)}0`.padStart(e.length+1,"0"):`${e}${a}`).length>n&&(i=i.slice(1),t=`${BigInt(t)+1n}`),i=i.slice(0,n)}else i=i.padEnd(n,"0");return BigInt(`${r?"-":""}${t}${i}`)}}}]);