(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7757],{1709:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});var s=r(37876);let n=e=>{var t=e.title;return(0,s.jsx)("div",{className:"flex justify-between items-center",children:(0,s.jsx)("h1",{className:"text-lg font-bold",children:t})})}},12293:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var s=r(37876),n=r(7446);let i=()=>(0,s.jsx)(n.A,{className:"mx-auto h-4 w-4 animate-spin text-greyscale-500"})},17739:(e,t,r)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/my/govrewards",function(){return r(26515)}])},18449:(e,t,r)=>{"use strict";r.d(t,{X:()=>i});var s=r(76200);class n extends s.C{constructor({value:e}){super(`Number \`${e}\` is not a valid decimal number.`,{name:"InvalidDecimalNumberError"})}}function i(e,t){if(!/^(-?)([0-9]*)\.?([0-9]*)$/.test(e))throw new n({value:e});let[r,s="0"]=e.split("."),i=r.startsWith("-");if(i&&(r=r.slice(1)),s=s.replace(/(0+)$/,""),0===t)1===Math.round(Number(`.${s}`))&&(r=`${BigInt(r)+1n}`),s="";else if(s.length>t){let[e,n,i]=[s.slice(0,t-1),s.slice(t-1,t),s.slice(t)],a=Math.round(Number(`${n}.${i}`));(s=a>9?`${BigInt(e)+BigInt(1)}0`.padStart(e.length+1,"0"):`${e}${a}`).length>t&&(s=s.slice(1),r=`${BigInt(r)+1n}`),s=s.slice(0,t)}else s=s.padEnd(t,"0");return BigInt(`${i?"-":""}${r}${s}`)}},26515:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>E});var s=r(16927),n=r(3576),i=r(62701),a=r(40854),l=r(4902),c=r(37876),d=r(14232),u=r(8047),o=r(1081),x=r(6960),h=r(97685),m=r(42038),f=r(20442),g=r(83416),v=r(44769),j=r(29898),N=r(62288),b=r(4113),p=r(60154),w=r(1709),y=r(12293),_=r(99574);let E=()=>{var e=((0,d.useContext)(g.N)||{}).token,t=(0,u.F)().address,r=(0,o.i)(),E=(0,j.vC)(),$=E.currentRound,k=E.error,I=E.isPending,S=(0,a._)((0,d.useState)(0n),2),B=S[0],C=S[1],A=(0,a._)((0,d.useState)(0n),2),R=A[0],M=A[1],P=(0,a._)((0,d.useState)(!0),2),F=P[0],z=P[1],O=(0,d.useRef)(null);(0,d.useEffect)(()=>{void 0!==$&&e&&($<=BigInt(e.initialStakeRound)?M(0n):M(BigInt($>=1n?$-1n:0n)))},[$,e]),(0,d.useEffect)(()=>{R&&e&&(R-BigInt(e.initialStakeRound)>=20n?C(R-20n):C(BigInt(e.initialStakeRound)))},[R,e]);var T=(0,v.k3)(null==e?void 0:e.address,t,B,R),X=T.rewards,J=T.isPending,L=T.error,D=(0,a._)((0,d.useState)([]),2),G=D[0],H=D[1];(0,d.useEffect)(()=>{X&&H([...X].sort((e,t)=>e.round>t.round?-1:1))},[X]),(0,d.useEffect)(()=>{e&&z(B>BigInt(e.initialStakeRound))},[B,e]);var V=(0,N.Jv)(),W=V.mintGovReward,Y=V.isPending,q=V.isConfirming,K=V.isConfirmed,Q=V.writeError,U=(0,a._)((0,d.useState)(null),2),Z=U[0],ee=U[1];(0,d.useEffect)(()=>{K&&(H(e=>e.map(e=>e.round===Z?(0,i._)((0,n._)({},e),{isMinted:!0}):e)),h.Ay.success("铸造成功"))},[K,Z]);var et=(0,b.g)().handleContractError;(0,d.useEffect)(()=>{L&&et(L,"dataViewer"),k&&et(k,"mint"),Q&&et(Q,"mint")},[L,k,Q,et]);var er=(0,d.useCallback)(()=>{if(e){var t=BigInt(e.initialStakeRound);C(e=>e>t?e-20n>=t?e-20n:t:e)}},[e]);return((0,d.useEffect)(()=>{if(O.current){var e=O.current,t=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&!J&&F&&er()})},{root:null,rootMargin:"200px",threshold:0});return t.observe(e),()=>{t.unobserve(e),t.disconnect()}}},[er,J,F]),I)?(0,c.jsx)(y.A,{}):(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(p.A,{title:"治理激励",showBackButton:!0}),(0,c.jsxs)("main",{className:"flex-grow",children:[e?(0,c.jsxs)("div",{className:"flex flex-col space-y-6 p-4",children:[(0,c.jsx)(w.A,{title:"铸造治理奖励"}),0n===R&&void 0!==$?(0,c.jsx)("div",{className:"text-center text-gray-500 py-4",children:"当前还不能铸造奖励，请耐心等待"}):(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("table",{className:"table w-full table-auto",children:[(0,c.jsx)("thead",{children:(0,c.jsxs)("tr",{className:"border-b border-gray-100",children:[(0,c.jsx)("th",{children:"轮次"}),(0,c.jsx)("th",{className:"text-center",children:"可铸造激励"}),(0,c.jsx)("th",{className:"text-center",children:"结果"})]})}),(0,c.jsx)("tbody",{children:0!==G.length||J?G.map(n=>(0,c.jsxs)("tr",{className:"border-b border-gray-100",children:[(0,c.jsx)("td",{children:e?(0,f.LP)(n.round,e).toString():"-"}),(0,c.jsx)("td",{className:"text-center",children:(0,f.NJ)(n.reward||0n)}),(0,c.jsx)("td",{className:"text-center",children:n.reward>0n&&!n.isMinted?(0,c.jsx)(x.$,{variant:"outline",size:"sm",className:"text-secondary border-secondary",onClick:()=>(n=>(0,s._)(function(){return(0,l.YH)(this,function(s){switch(s.label){case 0:if(!(0,m.z)(r))return[2];if(!((null==e?void 0:e.address)&&t))return[3,2];return ee(n),[4,W(e.address,n)];case 1:s.sent(),s.label=2;case 2:return[2]}})})())(n.round),disabled:Y||q,children:"铸造"}):n.isMinted?(0,c.jsx)("span",{className:"text-greyscale-500",children:"已铸造"}):(0,c.jsx)("span",{className:"text-greyscale-500",children:"-"})})]},n.round.toString())):(0,c.jsx)("tr",{children:(0,c.jsx)("td",{colSpan:3,className:"text-center text-sm text-gray-500 py-4",children:"暂无数据"})})})]}),(0,c.jsx)("div",{ref:O,className:"h-12 flex justify-center items-center",children:J?(0,c.jsx)(y.A,{}):F?(0,c.jsx)("span",{className:"text-sm text-gray-500",children:"加载更多..."}):(0,c.jsx)("span",{className:"text-sm text-gray-500",children:"没有更多奖励"})})]})]}):(0,c.jsx)(y.A,{}),(0,c.jsx)(_.A,{isLoading:Y||q,text:Y?"提交交易...":"确认交易..."})]})]})}},42038:(e,t,r)=>{"use strict";r.d(t,{z:()=>i});var s=r(97685),n=r(99090),i=e=>{var t=(()=>{var e,t,r=null==(t=n.$.chains)||null==(e=t[0])?void 0:e.id;if("number"==typeof r)return r;var s=Number("70001");return Number.isFinite(s)?s:void 0})();return!!e&&!!t&&e===t||(s.oR.error("请先将钱包链接 ".concat("Thinkium Mainnet Chain 1")),!1)}}},e=>{e.O(0,[3308,7460,154,5498,4769,2288,9898,636,6593,8792],()=>e(e.s=17739)),_N_E=e.O()}]);