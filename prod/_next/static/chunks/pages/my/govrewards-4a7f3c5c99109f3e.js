(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7757],{1709:(e,t,s)=>{"use strict";s.d(t,{A:()=>n});var r=s(37876);let n=e=>{var t=e.title;return(0,r.jsx)("div",{className:"flex justify-between items-center",children:(0,r.jsx)("h1",{className:"text-lg font-bold",children:t})})}},12293:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});var r=s(37876),n=s(7446);let a=()=>(0,r.jsx)(n.A,{className:"mx-auto h-4 w-4 animate-spin text-greyscale-500"})},17739:(e,t,s)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/my/govrewards",function(){return s(26515)}])},18449:(e,t,s)=>{"use strict";s.d(t,{X:()=>a});var r=s(76200);class n extends r.C{constructor({value:e}){super(`Number \`${e}\` is not a valid decimal number.`,{name:"InvalidDecimalNumberError"})}}function a(e,t){if(!/^(-?)([0-9]*)\.?([0-9]*)$/.test(e))throw new n({value:e});let[s,r="0"]=e.split("."),a=s.startsWith("-");if(a&&(s=s.slice(1)),r=r.replace(/(0+)$/,""),0===t)1===Math.round(Number(`.${r}`))&&(s=`${BigInt(s)+1n}`),r="";else if(r.length>t){let[e,n,a]=[r.slice(0,t-1),r.slice(t-1,t),r.slice(t)],i=Math.round(Number(`${n}.${a}`));(r=i>9?`${BigInt(e)+BigInt(1)}0`.padStart(e.length+1,"0"):`${e}${i}`).length>t&&(r=r.slice(1),s=`${BigInt(s)+1n}`),r=r.slice(0,t)}else r=r.padEnd(t,"0");return BigInt(`${a?"-":""}${s}${r}`)}},26515:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>y});var r=s(16927),n=s(3576),a=s(62701),i=s(40854),l=s(4902),c=s(37876),d=s(14232),u=s(8047),o=s(6960),x=s(97685),h=s(42038),m=s(20442),f=s(83416),g=s(44769),j=s(29898),v=s(62288),N=s(20451),b=s(60154),p=s(1709),w=s(12293),_=s(99574);let y=()=>{var e=((0,d.useContext)(f.N)||{}).token,t=(0,u.F)(),s=t.address,y=t.chain,E=(0,j.vC)(),k=E.currentRound,$=E.error,I=E.isPending,S=(0,i._)((0,d.useState)(0n),2),B=S[0],C=S[1],A=(0,i._)((0,d.useState)(0n),2),R=A[0],M=A[1],P=(0,i._)((0,d.useState)(!0),2),F=P[0],O=P[1],T=(0,d.useRef)(null);(0,d.useEffect)(()=>{void 0!==k&&e&&(k<=BigInt(e.initialStakeRound)?M(0n):M(BigInt(k>=1n?k-1n:0n)))},[k,e]),(0,d.useEffect)(()=>{R&&e&&(R-BigInt(e.initialStakeRound)>=20n?C(R-20n):C(BigInt(e.initialStakeRound)))},[R,e]);var X=(0,g.k3)(null==e?void 0:e.address,s,B,R),J=X.rewards,L=X.isPending,z=X.error,D=(0,i._)((0,d.useState)([]),2),G=D[0],H=D[1];(0,d.useEffect)(()=>{J&&H([...J].sort((e,t)=>e.round>t.round?-1:1))},[J]),(0,d.useEffect)(()=>{e&&O(B>BigInt(e.initialStakeRound))},[B,e]);var V=(0,v.Jv)(),W=V.mintGovReward,Y=V.isPending,q=V.isConfirming,K=V.isConfirmed,Q=V.writeError,U=(0,i._)((0,d.useState)(null),2),Z=U[0],ee=U[1];(0,d.useEffect)(()=>{K&&(H(e=>e.map(e=>e.round===Z?(0,a._)((0,n._)({},e),{isMinted:!0}):e)),x.Ay.success("铸造成功"))},[K,Z]);var et=(0,N.g)().handleContractError;(0,d.useEffect)(()=>{z&&et(z,"dataViewer"),$&&et($,"mint"),Q&&et(Q,"mint")},[z,$,Q,et]);var es=(0,d.useCallback)(()=>{if(e){var t=BigInt(e.initialStakeRound);C(e=>e>t?e-20n>=t?e-20n:t:e)}},[e]);return((0,d.useEffect)(()=>{if(T.current){var e=T.current,t=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&!L&&F&&es()})},{root:null,rootMargin:"200px",threshold:0});return t.observe(e),()=>{t.unobserve(e),t.disconnect()}}},[es,L,F]),I)?(0,c.jsx)(w.A,{}):(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(b.A,{title:"治理激励",showBackButton:!0}),(0,c.jsxs)("main",{className:"flex-grow",children:[e?(0,c.jsxs)("div",{className:"flex flex-col space-y-6 p-4",children:[(0,c.jsx)(p.A,{title:"铸造治理奖励"}),0n===R&&void 0!==k?(0,c.jsx)("div",{className:"text-center text-gray-500 py-4",children:"当前还不能铸造奖励，请耐心等待"}):(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("table",{className:"table w-full table-auto",children:[(0,c.jsx)("thead",{children:(0,c.jsxs)("tr",{className:"border-b border-gray-100",children:[(0,c.jsx)("th",{children:"轮次"}),(0,c.jsx)("th",{className:"text-center",children:"可铸造激励"}),(0,c.jsx)("th",{className:"text-center",children:"结果"})]})}),(0,c.jsx)("tbody",{children:0!==G.length||L?G.map(t=>(0,c.jsxs)("tr",{className:"border-b border-gray-100",children:[(0,c.jsx)("td",{children:e?(0,m.LP)(t.round,e).toString():"-"}),(0,c.jsx)("td",{className:"text-center",children:(0,m.NJ)(t.reward||0n)}),(0,c.jsx)("td",{className:"text-center",children:t.reward>0n&&!t.isMinted?(0,c.jsx)(o.$,{variant:"outline",size:"sm",className:"text-secondary border-secondary",onClick:()=>(t=>(0,r._)(function(){return(0,l.YH)(this,function(r){switch(r.label){case 0:if(!(0,h.C)(y))return[2];if(!((null==e?void 0:e.address)&&s))return[3,2];return ee(t),[4,W(e.address,t)];case 1:r.sent(),r.label=2;case 2:return[2]}})})())(t.round),disabled:Y||q,children:"铸造"}):t.isMinted?(0,c.jsx)("span",{className:"text-greyscale-500",children:"已铸造"}):(0,c.jsx)("span",{className:"text-greyscale-500",children:"-"})})]},t.round.toString())):(0,c.jsx)("tr",{children:(0,c.jsx)("td",{colSpan:3,className:"text-center text-sm text-gray-500 py-4",children:"暂无数据"})})})]}),(0,c.jsx)("div",{ref:T,className:"h-12 flex justify-center items-center",children:L?(0,c.jsx)(w.A,{}):F?(0,c.jsx)("span",{className:"text-sm text-gray-500",children:"加载更多..."}):(0,c.jsx)("span",{className:"text-sm text-gray-500",children:"没有更多奖励"})})]})]}):(0,c.jsx)(w.A,{}),(0,c.jsx)(_.A,{isLoading:Y||q,text:Y?"提交交易...":"确认交易..."})]})]})}},42038:(e,t,s)=>{"use strict";s.d(t,{C:()=>n});var r=s(97685),n=e=>{if(!e)return r.oR.error("请先将钱包链接 ".concat("Thinkium Mainnet Chain 1")),!1;return!0}}},e=>{e.O(0,[3308,7460,154,3096,4769,2288,9898,636,6593,8792],()=>e(e.s=17739)),_N_E=e.O()}]);